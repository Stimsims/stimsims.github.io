{"version":3,"sources":["webpack:///./src/mycomponents/game/tree/ViewFactory.js","webpack:///./src/mycomponents/views/Box/AbsoluteCentered/index.js","webpack:///./src/mycomponents/views/FlexContainer/v1/FlexContainer.js","webpack:///./src/mycomponents/game/Views/Image/poses.js","webpack:///./src/mycomponents/game/Views/Image/simple.js","webpack:///./src/mycomponents/views/ToastTool/v1/ToastTool.js","webpack:///./src/mycomponents/game/LoadGame/local/Storage.js","webpack:///./src/mycomponents/views/SEO/StructuredData/game.js","webpack:///./src/mycomponents/views/Credits/index.js","webpack:///./src/mycomponents/game/LoadGame/local/index.js","webpack:///./src/mycomponents/views/Carousel/index.js","webpack:///./src/mycomponents/game/LoadGame/exam/index.js","webpack:///./src/mycomponents/views/Captcha/captcha.js","webpack:///./src/mycomponents/views/Captcha/challenge.js","webpack:///./src/mycomponents/views/Captcha/index.js","webpack:///./src/mycomponents/game/LoadGame/index.js","webpack:///./src/mycomponents/views/SEO/Social/Social.js","webpack:///./src/mycomponents/game/Intro/Scene.js","webpack:///./src/mycomponents/game/Intro/index.js","webpack:///./src/mycomponents/game/tree/Gate.js","webpack:///./src/mycomponents/game/Audio/index.js","webpack:///./src/mycomponents/game/tree/Tree.js","webpack:///./src/mycomponents/views/Feedback/v1/Feedback.js","webpack:///./src/mycomponents/game/tree/SettingsConfig.js","webpack:///./src/mycomponents/views/Radio/v1/radio.css.js","webpack:///./src/mycomponents/views/Radio/v1/Radio.js","webpack:///./src/mycomponents/game/tree/Settings.js","webpack:///./src/mycomponents/game/tree/Layout.js","webpack:///./src/mycomponents/game/Main.js","webpack:///./src/mycomponents/game/Views/Staged/index.js"],"names":["buildView","view","contents","animation","classes","props","className","div","id","key","wrapViews","ANIMATIONS","ANIMATION","getView","views","result","Array","isArray","filter","f","map","e","styles","position","left","top","transform","AbsoluteBoxView","style","children","Wrapper","Container","color","minHeight","ANIM_LAYOUT_OVERLAP","fullscreen","fontsize","layoutRelative","scrollable","padding","styled","motion","joshua","neutral","x","y","width","height","annoyed","hurt","helpful","tease","judgy","flirty","listening","angry","shrug","wary","nasty","phone","thinking","neku","sullen","defensive","sad","happy","waking","cry","pain","shock","talk","confused","getCharacterSrc","images","Promise","res","rej","src","all","img","getImage","then","i","default","catch","log","error","goddess","shy","shocked","doubt","kara","sweet","ari","triangles","SpriteView","getPose","poses","imageId","pose","bottom","initial","animate","exit","Sprite","noScale","scaleDown","isDevelopment","theme","mediaS","mediaM","VISIBLE","opacity","HIDDEN","ToastTool","useState","active","setActive","useEffect","timeout","timer1","setTimeout","clearTimeout","handleClose","backgroundColor","Fragment","title","Text","tag","text","IconButton","icon","onInput","size","primaryD","zUi","getGameKey","deleteSave","window","localStorage","getSaveKey","game","removeItem","getSaveFiles","slots","slot","gameKey","gameState","getItem","decrypted","decryptString","getEncKey","JSON","parse","StructuredData","missing","date","name","headline","description","keywords","url","logo","logoWidth","logoHeight","Error","stringify","codeCredits","href","Credits","renderCredits","heading","cred","push","c","leave","target","Box","margin","credits","items","SaveFilesView","setDeleteSlot","setItems","isSaveActive","setIsSaveActive","getSaves","a","files","onDelete","deleteSlot","vp","oi","showModal","sendEvent","Event","gameKeys","acMenu","onToast","onPlay","metaState","metaKey","startDate","Date","now","duration","sessionStart","setItem","startSession","console","SaveFile","hover","ButtonWrapper","out","iconSize","glowBtn","hoverScale","disabled","bgColor","modalDeleteView","DeleteView","Button","glow","section","secondary","Carousel","onMove","index","total","rotate","markers","itemIds","renderMarkers","primary","ExamView","user","setUser","setIndex","exams","setExams","isLoadingExam","setLoadingExam","setError","isSignedIn","doSubscribe","getPlayer","uid","gameName","meta","import","exam","firestoreCatch","onLoadError","onLoadExam","examId","loadExam","data","report","cloudCatch","onDeleteExam","nExams","nUser","deleteExam","firestoreThen","onCarouselMove","renderReport","Report","Object","keys","resumable","hasOwnProperty","ids","length","wrapExams","toLocaleString","fontSize","finalScore","renderExam","Loading","compact","getDeleteModal","renderExams","RenderPlayButton","ExamToggle","doSignIn","CAPTCHA_KEY","Subscribable","loadCaptcha","script","document","createElement","type","onload","grecaptcha","ready","verify","onerror","acceptOffline","onVerify","sendError","body","appendChild","execute","action","token","validateCaptcha","success","score","minScore","checkRepcaptchaWithServer","myCallback","a1","onloadCallback","recaptchaCallback","handleSuccess","recaptchaErrorCallback","recaptchaExpiredCallback","Helmet","async","defer","method","wrapperStyles","textAlign","class","data-sitekey","data-callback","data-error-callback","data-expired-callback","display","VerifyTraffic","verified","setVerified","doTest","setTest","delay","Message","p","LoadGame","getUrlHash","examMode","setExamMode","component","Switch","v","Social","encodeString","str","encodeURIComponent","message","classShare","ClassShare","renderClass","IntroScene","scene","s","t","toLatex","latex","getIndex","IntroSceneWrapper","transition","DUR","ease","renderImage","Staged","renderText","FOLD_OUT_ANIMATIONS","variants","invisible","hidden","visible","PLAY_BUTTON_ANIMATIONS","GameIndex","menuOpen","setMenuOpen","IndexWrapper","intro","NestedSignIn","recieveSignInProps","onSignIn","Reveal","SocialWrapper","getFullUrl","snippet","tweet","to","getUrl","onGameOver","showReport","audio","FoldOut","Description","borderImg","texts","descriptions","childImageSharp","zMid","killTime","changes","updateGame","sendToSim","state","simNode","settings","nGame","mergePaths","inputs","answers","mcq","createAll","randomize","formatAll","math","ScoreAll","iterators","initialize","gameCode","createExam","r","playTime","sim","simInit","measurements","event","simulate","nodeId","gameId","sendState","getLocalChanges","updateExam","onEndGame","filledChanges","values","endGame","gradeAnswers","measureScores","flags","importFile","unplayedRequests","AudioView","View","setAudio","toPlay","setToPlay","assets","players","Audio","kPlaying","stopAudio","track","pause","remove","kAudio","volume","sound","playAudio","unplayedKeys","k","audioFile","stop","loop","autoplay","play","doPlay","stylesLoaderWrapper","stylesLoading","right","withTheme","mystate","setMyState","node","setNode","setInputs","setViews","isInitializing","setIsInitializing","mergeInputs","setMergeInputs","sentHash","recievedHash","changeNodes","update","Worker","time","onTreeError","viewProps","setMenuItem","showSettings","quest","save","getSaveCallback","autoSave","preventDefault","returnValue","gameover","hash","generator","getHash","onSave","showUI","callback","addEventListener","removeEventListener","location","move","trees","getNode","start","startNewNode","stack","makeChange","acLoc","label","nInputs","temp","renderViews","onError","tree","mergedState","skipChange","mergeStates","Math","random","addFlag","clone","sState","elapsedTime","sendTime","simFields","value","Factory","ANIM_PAGE","autoActive","spinner","Flex","exitBeforeEnter","getScoreFuck","sc","isNaN","roundTo","setScore","timer","getOpacity","howWrong","Overlay","enter","FeedbackScore","textBg","settingsViews","setDiff","labels","setSound","inPlay","setFont","Radio","handleChange","ev","item","options","nState","multi","convertToOutput","selected","ray","isChecked","getRadioKey","includes","checked","onChange","Set","bind","handleSelect","onClose","componentDidUpdate","prevProps","this","setState","renderSettings","setting","hasDifficultySetting","isPlaying","Setting","label1","label2","Slider","min","max","step","render","Modal","React","PureComponent","App","question","answer","correct","feedback","setFeedback","toasttool","setToastTool","loading","setLoading","treeError","setTreeError","gameSettings","getRandomIndex","makeSettings","setSettings","openSettings","setOpenSettings","modalOpenedCounter","setModalOpenCounter","dimensionsRef","useRef","isGameInit","ref","Content","params","caller","Feedback","LoadingBlock","Settings","nSettings","kSett","measureSettings","GAME_LAYOUT_ANIM","MainPage","form","signInProps","onBack","renderScene","getLogo","showCredits","saveGame","closeModal","componentDidMount","setupProperty","analytics","loadPersistent","referrer","measurments","d","trackPersistent","addMenuItem","BUILD_GAME","componentWillUnmount","clearPersistantValues","menuItems","GameComponent","getPersistentValues","attempts","saveExam","end","minutes","getMinutes","seconds","getSeconds","stringifiedGame","encrypted","encryptString","modSettings","newGameSettings","navigate","getParentUrl","storeItem","getReportKey","modalConents","speed","Layout","Intro","renderContent","renderLinks","fixed","rel","getStructuredData","topics","join","Component","animations","bounce","translateY","yoyo","repeatDelay","shake","translateX","tremble","iBg","aBg","eBg","aC","iCC","scaleX","iCL","iCR","tC","prevC","eC","mirror","reverseMirror","iM","scale","aM","eM","cM","iL","eL","aL","pL","iR","eR","aR","pR","initialLeft","exitTransition","getAnimations","sty","states","reduce","override","StagedView","StagedWrapper"],"mappings":"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","file":"views~component---src-templates-game-post-js-a4ec380bfda113b6e23e.js","sourcesContent":["import React from 'react';\r\nimport {motion} from 'framer-motion';\r\nimport {animations as ANIMATIONS} from './Animations';\r\nimport {log} from 'utilities/Measure.js';\r\n\r\nconst wrapViews = (view, animation) => {\r\n     let classes = ``;\r\n     if(view.props && view.props.className){\r\n         classes += \" \" + view.props.className;\r\n     }\r\n    return <motion.div id={view.props.id} key={view.props.id} {...animation} className={classes} > {view} </motion.div>\r\n    \r\n}\r\n\r\n\r\nconst buildView = (view) => {\r\n    let contents = view.view || view;\r\n    if(view.animation){\r\n        return wrapViews(contents, view.animation?ANIMATIONS[view.animation]:ANIMATION);\r\n    }\r\n    return view;\r\n}\r\nconst getView = (views) => {\r\n    let result = views;\r\n    if(Array.isArray(result)){\r\n        result = result.filter(f => f).map(e => buildView(e)); //filter out null views\r\n    }else if(result){\r\n        result = buildView(result);\r\n    }\r\n    return result;\r\n}\r\nexport default getView;\r\n\r\n","import React from 'react';\r\nimport {log} from 'utilities/Measure';\r\n\r\nconst styles = {position: 'absolute', left:'50%', top:'200px', transform: 'translate(-50%, -50%)'}\r\nconst AbsoluteBoxView = (props) => {\r\n    return <div  id={props.id} key={props.id} {...props} style={styles}>\r\n        {props.children}\r\n    </div>\r\n}\r\n\r\nexport default AbsoluteBoxView;\r\n","import React from 'react';\r\nimport styled from 'styled-components';\r\nimport { motion, AnimatePresence} from 'framer-motion';\r\nimport {animations, keys as animKeys, ANIM_LAYOUT_OVERLAP} from 'animations';\r\nimport {log} from 'utilities/Measure';\r\n\r\nconst Wrapper = (props) => {\r\n    return <Container key={props.id} id={props.id}// key={props.id?`${props.id}-layout`:null} id={props.id?`${props.id}-layout`:null}\r\n            color={props.color} minHeight={props.minHeight} \r\n            {...ANIM_LAYOUT_OVERLAP}\r\n            className={`${props.className?props.className:''} ${props.fullscreen?'fullscreen':''}`}\r\n            fontsize={props.fontsize} layoutRelative={props.layoutRelative} scrollable={props.scrollable} //noScroll={props.noScroll}\r\n            fullscreen={props.fullscreen} padding={props.padding}> \r\n            <AnimatePresence>\r\n            {props.children}\r\n            </AnimatePresence>\r\n        </Container>\r\n}\r\n\r\nexport default Wrapper;\r\n\r\nconst Container = styled(motion.div)`\r\n\r\n    width: 100%; \r\n    height:100%;\r\n\r\n    ${props => {\r\n        if(props.scrollable){\r\n            return `\r\n                overflow-x:hidden;\r\n                overflow-y:auto;\r\n            `\r\n        }\r\n    }}\r\n\r\n    ${props => props.fontsize?'font-size: ' + props.fontsize + 'px':''}; \r\n    ${props => {\r\n        if(props.minHeight){\r\n            return `min-height: ${props.minHeight};`\r\n        }\r\n    }}\r\n\r\n   \r\n    @supports (display: flex) {\r\n        display: flex;\r\n        flex-wrap:wrap;\r\n        justify-content: space-evenly;\r\n        align-items: center;\r\n        align-content: stretch;\r\n  \r\n    }\r\n\r\n`\r\n/**  overflow-x:hidden;  ${props => props.noScroll?'':'overflow-y:auto;'} setting the overflow-y property breaks the select box\r\n *     ${props => props.layoutRelative?'position: relative;':''}\r\n *  ${props => props.padding?'padding: 0px 10px 20px 10px;':''}\r\n *     box-sizing: border-box;\r\n    @supports (display: flex) {\r\n        display: flex;\r\n        flex-wrap:wrap;\r\n        justify-content: space-evenly;\r\n        align-items: stretch;\r\n        align-content: stretch;\r\n  \r\n    }\r\n */","import {log} from 'utilities/Measure';\r\n\r\nconst joshua = {\r\n    neutral: {x: `-1170px`, y:`-388px`, width:`164px`, height:`378px`},\r\n    annoyed: {x: `-1344px`, y:`-388px`, width:`152px`, height:`378px`}, \r\n    hurt: {x: `0px`, y:`0px`, width:`255px`, height:`378px`},\r\n    helpful: {x: `-335px`, y:`-30px`, width:`215px`, height:`378px`},\r\n    tease: {x: `-605px`, y:`0px`, width:`196px`, height:`380px`},\r\n    judgy: {x: `-815px`, y:`0px`, width:`175px`, height:`378px`},\r\n    flirty: {x: `-990px`, y:`0px`, width:`175px`, height:`378px`},\r\n    listening: {x: `-1170px`, y:`0px`, width:`162px`, height:`385px`},\r\n    angry: {x: `-1340px`, y:`0px`, width:`145px`, height:`378px`},\r\n    shrug: {x: `0px`, y:`-385px`, width:`345px`, height:`378px`},\r\n    wary: {x: `-360px`, y:`-418px`, width:`245px`, height:`340px`},\r\n    nasty: {x: `-605px`, y:`-390px`, width:`210px`, height:`380px`},\r\n    phone: {x: `-815px`, y:`-388px`, width:`190px`, height:`380px`},\r\n    thinking: {x: `-1000px`, y:`-388px`, width:`170px`, height:`380px`},\r\n    annoyed: {x: `-1335px`, y:`-388px`, width:`150px`, height:`380px`},\r\n};\r\n\r\nconst neku = {\r\n    neutral: {x: `-330px`, y:`-50px`, width:`190px`, height:`388px`},\r\n    sullen: {x: `-325px`, y:`-445px`, width:`204px`, height:`378px`},\r\n    defensive: {x: `-535px`, y:`-450px`, width:`175px`, height:`378px`},\r\n    hurt: {x: `-740px`, y:`-385px`, width:`235px`, height:`398px`},\r\n    sad: {x: `-985px`, y:`-430px`, width:`185px`, height:`388px`},\r\n    angry: {x: `-1205px`, y:`-430px`, width:`290px`, height:`398px`},\r\n    happy: {x: `-1557px`, y:`-420px`, width:`170px`, height:`398px`},\r\n    wary: {x: `0px`, y:`-475px`, width:`320px`, height:`348px`},\r\n    waking: {x: `0px`, y:`0px`, width:`255px`, height:`438px`},\r\n    shrug: {x: `0px`, y:`-853px`, width:`335px`, height:`378px`},\r\n    cry: {x: `-335px`, y:`-845px`, width:`235px`, height:`385px`},\r\n    pain: {x: `-585px`, y:`-840px`, width:`250px`, height:`385px`},\r\n    shock: {x: `-835px`, y:`-840px`, width:`250px`, height:`385px`},\r\n    talk: {x: `-1080px`, y:`-840px`, width:`240px`, height:`385px`},\r\n    thinking: {x: `-1320px`, y:`-840px`, width:`235px`, height:`385px`},\r\n    confused: {x: `-1555px`, y:`-840px`, width:`215px`, height:`385px`},\r\n    happy: {x: `-1770px`, y:`-840px`, width:`190px`, height:`385px`},\r\n}\r\n\r\n\r\nconst goddess = {\r\n    shy: {x: `-26px`, y:`0px`, width:`220px`, height:`485px`},\r\n    neutral: {x: `-713px`, y:`0px`, width:`220px`, height:`485px`},\r\n    shocked: {x: `-484px`, y:`0px`, width:`220px`, height:`485px`},\r\n    doubt: {x: `-255px`, y:`0px`, width:`220px`, height:`485px`},\r\n}\r\nconst kara = {\r\n    neutral: {x: `0px`, y:`0px`, width:`335px`, height:`485px`},\r\n    annoyed: {x: `-335px`, y:`0px`, width:`335px`, height:`485px`},\r\n    angry: {x: `-675px`, y:`0px`, width:`330px`, height:`485px`},\r\n    shocked: {x: `-1010px`, y:`0px`, width:`330px`, height:`485px`},\r\n}\r\nconst sweet = {\r\n  sad: {x: `3px`, y:`0px`, width:`175px`, height:`430px`},\r\n  happy: {x: `-170px`, y:`0px`, width:`175px`, height:`430px`},\r\n  neutral: {x: `-345px`, y:`0px`, width:`175px`, height:`430px`},\r\n}\r\nconst ari = {\r\n  sad: {x: `-305px`, y:`0px`, width:`308px`, height:`470px`},\r\n  shocked: {x: `-606px`, y:`0px`, width:`308px`, height:`470px`},\r\n  neutral: {x: `-0px`, y:`0px`, width:`308px`, height:`470px`},\r\n}\r\nconst triangles = {\r\n    '0': {x: '0px', y:'0px', width:'280px', height: '445px'},\r\n    '1': {x: '280px', y:'0px', width:'280px', height: '445px'},\r\n}\r\nexport const getImage = (src) => {\r\n    switch(src){\r\n      case 'joshua': return import('./images/joshua.png');\r\n      case 'neku': return import('./images/neku.png');\r\n      case 'goddess': \r\n      case 'rainbow': return import('./images/goddess.png');\r\n      case 'sweet': return import('./images/sweet.png');\r\n      case 'ari': return import('./images/ari.png');\r\n      case 'kara': \r\n      default:\r\n        return import('./images/kara.png');\r\n    }\r\n}\r\n\r\nexport const getCharacterSrc = (images) => {\r\n    return new Promise((res, rej) => {\r\n        let src = {};\r\n        Promise.all(images.map(img => {\r\n          return getImage(img);\r\n        })).then((e) => {\r\n          e.map((img, i) => {\r\n            src[images[i]] = img.default;\r\n          });\r\n          res(src);\r\n        }).catch(e => {\r\n            log(`game-post remapImages error`, e);\r\n          rej({error: e});\r\n        });\r\n        \r\n    })\r\n\r\n  }\r\nexport default {\r\n    joshua,\r\n    neku,\r\n    goddess,\r\n    kara,\r\n    sweet,\r\n    ari,\r\n    triangles\r\n}","import React, {useEffect, useState} from 'react';\r\nimport {motion} from 'framer-motion';\r\nimport styled from 'styled-components';\r\nimport poses from './poses';\r\nimport Staged from 'game/Views/Staged';\r\nimport {log} from 'utilities/Measure';\r\nimport {isDevelopment} from 'utilities/Validation';\r\n\r\n\r\n//recieves the src of an image, and its co-ordinates displays it as background\r\nconst SpriteView = (props) => {\r\n   log(`SpriteView props`, props);\r\n    const getPose = () => {\r\n        if(poses[props.imageId] && poses[props.imageId][props.pose]){\r\n            return poses[props.imageId][props.pose];\r\n        }else{\r\n            //width: '100vw', height: '100vh', \r\n            //return {width: '100%', height: '100%', x: `0px`, y: `0px`}\r\n            return {\r\n                width: props.width || `${props.src[props.imageId].width}px`, \r\n                height: props.height || `${props.src[props.imageId].height}px`, \r\n                x: `50%`, y: `50%`}\r\n        }\r\n    }\r\n    log(`SpriteView pose ${props.pose} imageId ${props.imageId} pose`, props);\r\n     return <Staged key={`${props.id}-staged`} id={`${props.id}-staged`} \r\n                width={getPose().width} height={getPose().height} bottom={props.bottom}\r\n                initial={props.initial || 'initial'} animate={props.animate || 'animate'} exit={props.exit || 'exit'}\r\n           \r\n                //orientation={getBubbleOrientation(node.animate || node.initial)}\r\n                >\r\n         <Sprite key={`img-${props.id}`} id={`img-${props.id}`} src={props.src[props.imageId]} {...getPose()} \r\n                    noScale={props.noScale} \r\n                    scaleDown={isDevelopment()}\r\n                    />\r\n     </Staged>;\r\n}\r\n\r\nexport default SpriteView;\r\n\r\n\r\nconst Sprite = styled.div`\r\nmargin: auto;\r\n    ${props => {\r\n        if(props.width){\r\n            return `width: ${props.width}`\r\n        }\r\n    }};\r\n    ${props => {\r\n        if(props.height){\r\n            return `height: ${props.height}`\r\n        }\r\n    }};\r\n    ${props => {\r\n        if(!props.noScale){\r\n            return `transform-origin: 150% 100%;\r\n            transform: scale(0.6);`\r\n        }\r\n    }}\r\n    @media(min-width: ${props => props.theme.mediaS}){\r\n        ${props => {\r\n            if(!props.noScale){\r\n                return `transform-origin: 250% 100%;\r\n                transform: scale(0.8);`\r\n            }\r\n        }}\r\n    }\r\n    @media(min-width: ${props => props.theme.mediaM}){\r\n        transform-origin: 100% 100%;\r\n        transform: scale(1);\r\n    }\r\n    ${props => {\r\n        if(props.scaleDown){\r\n            return `\r\n            transform-origin: 100% 100%;\r\n            transform: scale(0.65) !important;\r\n            `\r\n        }\r\n    }}\r\n    background: url(${props => props.src})  no-repeat ${props => props.x} ${props => props.y};\r\n`\r\n/*\r\n    background-size: contain;\r\n    background-repeat: no-repeat;\r\n    background-postion: center;\r\n    background-attachment: fixed;\r\n*/","import React, {useState, useEffect} from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport styled, {withStyle} from 'styled-components';\r\nimport Text from 'views/Text/Text/v1/Text';\r\nimport IconButton from 'views/IconButton/v1/IconButton.js';\r\nimport { motion } from \"framer-motion\";\r\nimport {log} from 'utilities/Measure.js';\r\n\r\nconst ToastTool = (props) => {\r\n    const [active, setActive] = useState(false);\r\n    useEffect(()=>{\r\n        if(props.id){\r\n            setActive(true);\r\n            if(props.timeout){\r\n                let timer1 = setTimeout(() => {\r\n                    setActive(false);\r\n                }, 3000)\r\n                return () => {\r\n                    clearTimeout(timer1)\r\n                }\r\n            }\r\n\r\n        }\r\n    }, [props.id]);\r\n    const handleClose = () => {\r\n        setActive(false);\r\n    }\r\n    //title: 'a title', text: 'blue moon'\r\n    const renderTooltip = () => {\r\n        return <React.Fragment>\r\n            <IconButton className=\"close \" icon=\"icon-checkmark\" color=\"text\" onInput={handleClose} size=\"s\" />\r\n            {props.title && <Text tag=\"h4\" className=\"text-center\" >{props.title}</Text>}\r\n            <Text tag=\"h5\" className=\"text-center\" >{props.text}</Text>\r\n            \r\n        </React.Fragment>\r\n    }\r\n    const renderToast = () => {\r\n        return <React.Fragment>\r\n            {props.title && <Text tag=\"h4\" className=\"text-center\" >{props.title}</Text>}\r\n            <Text className=\"text-center\" >{props.text}</Text>\r\n            </React.Fragment>\r\n    }\r\n\r\n    return <Container key={\"toasttool\"} className=\"z-ui\" initial={HIDDEN} animate={active?VISIBLE:HIDDEN} \r\n            backgroundColor={props.backgroundColor}>\r\n           {props.timeout && renderToast()}\r\n            {!props.timeout && renderTooltip()}\r\n    </Container>\r\n}\r\n\r\n\r\nconst VISIBLE = {\r\n    opacity: 1,\r\n    y: '0%'\r\n}\r\nconst HIDDEN = {\r\n    opacity: 0,\r\n    y: '200%'\r\n}\r\n\r\nToastTool.propTypes = {\r\n    id: PropTypes.string, //makes view appear\r\n    text: PropTypes.string,\r\n    title: PropTypes.string,\r\n    timeout: PropTypes.number,\r\n    backgroundColor: PropTypes.string\r\n}\r\n\r\n\r\nexport default ToastTool;\r\n\r\nconst Container = styled(motion.div)`\r\n    position: fixed;\r\n    bottom: 20px;\r\n    left: 20px;\r\n    right: 20px;\r\n    max-width: 600px;\r\n    margin: auto;\r\n    background-color: black;\r\n    border-bottom: 2px solid ${props => props.theme.primaryD};\r\n    padding: 10px;\r\n    .close{\r\n        float: right;\r\n    }\r\n    z-index: ${props => props.theme.zUi}\r\n`\r\n\r\n/**\r\n * background-color:  ${props => props.theme.getColor(props.theme, props.backgroundColor, props.theme.primaryD)};\r\n *   .close{\r\n        position: absolute;\r\n        top: ${props => props.lowerClose?'21px':'17px'};\r\n        right: 8px;\r\n    }\r\n */","import {log} from 'utilities/Measure';\r\nimport {decryptString, encryptString, getEncKey, getSaveKey} from 'utilities/Storage';\r\n\r\nconst getGameKey = (title) => `game-${title}`;\r\nexport const startSession = (title) => {\r\n    //returns gamestart\r\n    if(!title) throw Error(`tried to start game session with no title ${title}`);\r\n    let gameState = null, metaState, gameKey, metaKey;\r\n    if(window && window.localStorage){\r\n        gameKey = getGameKey(title);\r\n        metaKey = getSaveKey(title,true);\r\n     \r\n        gameState = window.localStorage.getItem(gameKey);\r\n      \r\n        if(gameState) {\r\n            metaState = window.localStorage.getItem(metaKey);\r\n            metaState = JSON.parse(metaState);\r\n            gameState = decryptString(getEncKey(title), gameState);\r\n            gameState = JSON.parse(gameState);\r\n        }else{\r\n            //if ther game is new, aka no game state found, create a new meta file\r\n            metaState = {title: metaKey, startDate: Date.now(), duration: 0};\r\n            gameState = null;\r\n        }\r\n        metaState.sessionStart = Date.now();\r\n        //save the new metaState\r\n        window.localStorage.setItem(metaKey, JSON.stringify(metaState));\r\n    }\r\n    return gameState;\r\n}\r\n\r\n\r\nexport const saveProgress = (state, title) => {\r\n    //if the tab is closed directly, the game doesnt get the opportunity to clean up and save\r\n    return new Promise((res, rej) => {\r\n        let meta = {};\r\n        if(window && window.localStorage){\r\n            let metaKey = getSaveKey(title, true);\r\n            meta = JSON.parse(window.localStorage.getItem(metaKey));\r\n            let start = meta.sessionStart;\r\n            let end = Date.now();\r\n            let duration = meta.duration + (end - start);\r\n            meta.sessionStart = end; //this method is called multiple times, always update sessionStart to current time\r\n            meta.duration = duration;\r\n            let date = new Date(duration);\r\n            let minutes = date.getMinutes();\r\n            if(minutes < 10) minutes = `0${minutes}`;\r\n            let seconds = date.getSeconds();\r\n            if(seconds < 10) seconds = `0${seconds}`;\r\n            meta.time = `${minutes}:${seconds}`;\r\n        //   meta.description = game.saveMeta(state.game, methods);\r\n            meta.gameover = state.game.gameover;\r\n            window.localStorage.setItem(metaKey, JSON.stringify(meta));\r\n\r\n            let gameKey = getGameKey(title);\r\n            let stringifiedGame = JSON.stringify(state);\r\n            let encrypted = encryptString(getEncKey(title), stringifiedGame);\r\n            window.localStorage.setItem(gameKey, encrypted);\r\n        }\r\n    \r\n        res(meta);\r\n    })\r\n}\r\n\r\nexport const deleteSave = (title) => {\r\n    if(window && window.localStorage){\r\n        let meta = getSaveKey(title,true);\r\n        let game = getGameKey(title);\r\n        window.localStorage.removeItem(game);\r\n       // window.localStorage.removeItem(meta);\r\n    }\r\n}\r\n\r\n\r\n\r\nexport function getSaveFiles(slots, title){\r\n    if(!window || !window.localStorage) return null;\r\n    return slots.map(slot => {\r\n        let gameKey = getGameKey(title);\r\n        let gameState = window.localStorage.getItem(gameKey);\r\n        if(!gameState) return null;\r\n        let decrypted = decryptString(getEncKey(title), gameState);\r\n\r\n        let hydrated = JSON.parse(decrypted);\r\n        return hydrated;\r\n    });\r\n}\r\n\r\n","\r\nconst StructuredData = ({date, name, headline, description,  keywords, url, logo, logoWidth, logoHeight}) => {\r\n    let missing;\r\n    if(!date) missing = 'date';\r\n    if(!headline) missing = 'headline';\r\n    if(!keywords) missing = 'keywords';\r\n    if(!url) missing = 'url';\r\n    if(!name) missing = 'name';\r\n    if(!description) missing = 'description';\r\n    if(!logo) missing = 'logo';\r\n    if(!logoWidth) missing = 'logoWidth';\r\n    if(!logoHeight) missing = 'logoHeight';\r\n    if(missing){\r\n      throw Error(`structured data blog-post missing ${missing}`)\r\n    }\r\nreturn JSON.stringify({\r\n        \"@context\": \"http://schema.org/\",\r\n        \"@type\": \"VideoGame\",\r\n        \"gamePlatform\": \"web browser\", \r\n        \"operatingSystem\": \"web browser\", \r\n        \"playMode\": \"single-player\",\r\n        \"dateCreated\": date,\r\n        \"genre\": 'puzzle',\r\n        \"headline\": headline,\r\n        \"keywords\": keywords,\r\n        \"url\": url, \r\n        \"name\": name,\r\n        \"description\": description,\r\n        \"applicationCategory\": \"game\",\r\n        //\"trailer\":\"\",\r\n        \"director\": {\r\n            \"@type\": \"Person\",\r\n            \"brand\": {\r\n                \"@type\": \"Organization\",\r\n                \"email\": \"stims.ms@gmail.com\",\r\n                \"description\": \"Makes experimental text-based math games. They are open ended and data rich puzzle problems.\",\r\n                \"image\": {\r\n                    \"@type\": \"ImageObject\",\r\n                    \"url\": logo,\r\n                    \"width\": logoWidth,\r\n                    \"height\": logoHeight\r\n                }\r\n            }\r\n        }\r\n    });\r\n}\r\n\r\nexport default StructuredData;","import React, {useState, useEffect} from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport Text from 'views/Text/Text/v1/Text';\r\nimport Box from 'views/Box/v1/Box';\r\n\r\nconst codeCredits = {\r\n    heading: 'Code Libraries', \r\n    items: [\r\n        {text: \"Nerdamer, which handles math operations\", href: \"https://github.com/jiggzson/nerdamer\"},\r\n        {text: \"Katex, which handles displaying math equations\", href: \"https://github.com/KaTeX/KaTeX\"},\r\n        {text: \"ReCharts, which graphs game simulation data\", href: \"https://github.com/jiggzson/nerdamer\"},\r\n        {text: \"Firebase, which handles exam related features\", href: \"https://github.com/jiggzson/nerdamer\"},\r\n        {text: \"Gatsby, which builds the website efficiently\", href: \"https://github.com/jiggzson/nerdamer\"},\r\n        {text: \"React, which makes designing the website a pleasure\", href: \"https://github.com/jiggzson/nerdamer\"}\r\n    ]\r\n}\r\nconst Credits = (props) => {\r\n\r\n    const renderCredits = (heading, cred) => {\r\n        if(heading && cred){\r\n            let views = [<Text key={`${heading}-heading`} tag=\"h4\" className=\"block\" color=\"secondary\">{heading}</Text>];\r\n            views.push(<ul key={`${heading}-list`} style={{color: 'pink'}}>\r\n                {\r\n                    cred.map((c, i) => {\r\n                        if(c.href && c.text){\r\n                            return <li key={i}><Text tag=\"a\" href={c.href} leave={true} color=\"text\" \r\n                                className=\"block text-left\" target=\"_blank\" >{c.text}</Text></li>\r\n                        }else if(c.text){\r\n                            return <li key={i}><Text tag=\"p\" color=\"text\" className=\"block text-left\">{c.text}</Text></li>\r\n                        }\r\n                    })\r\n                }\r\n            </ul>)\r\n            return views;\r\n        }\r\n\r\n    }\r\n\r\n    return <Box className=\"text-center\">\r\n            <Text tag=\"h2\" className=\"text-underline\" margin=\"0px 0px 20px 0px\">Credits</Text>\r\n            {renderCredits(codeCredits.heading, codeCredits.items)}\r\n            {props.credits && props.credits.map(c => {\r\n                return  renderCredits(c.heading, c.items)\r\n            })}\r\n        </Box>\r\n}\r\n\r\nCredits.propTypes = {\r\n    credits: PropTypes.arrayOf(\r\n        PropTypes.shape({\r\n            heading: PropTypes.string.isRequired,\r\n            items: PropTypes.arrayOf(\r\n                PropTypes.shape({\r\n                    text: PropTypes.string.isRequired,\r\n                })\r\n            ).isRequired\r\n        })\r\n    )\r\n}\r\n\r\nexport default Credits;\r\n","import React, {useState, useEffect, useCallback, useMemo} from 'react';\r\nimport styled from 'styled-components';\r\nimport Modal from \"views/Modal/v1/Modal.js\";\r\nimport Text from 'views/Text/Text/v1/Text.js';\r\nimport TextMan from 'game/Views/TextManager/TextManager';\r\nimport Button from 'views/Button/v1/Button.js';\r\nimport IconButton from 'views/IconButton/v1/IconButton.js';\r\nimport {deleteSave, getSaveFiles, saveProgress, startSession} from './Storage';\r\nimport gameKeys from 'games/keys.js';\r\nimport {sendError, sendEvent, log} from 'utilities/Measure.js';\r\nimport {Event} from 'utilities/Create';\r\n\r\nconst slots = ['A'];\r\nconst SaveFilesView = (props) => {\r\n    const [deleteSlot, setDeleteSlot] = useState(null);\r\n    //const [items, setItems] = useState([...props.items]);\r\n    const [items, setItems] = useState(slots);\r\n    const [isSaveActive, setIsSaveActive] = useState(false);\r\n\r\n    useEffect(()=>{\r\n       getSaves(); //update save files to reflect current state\r\n    }, [props.gameState]);\r\n    \r\n    const getSaves = async () => {\r\n        if(!isSaveActive){\r\n            setIsSaveActive(true);\r\n            let files = getSaveFiles(slots, props.title);\r\n            setItems(files);\r\n            setIsSaveActive(false);\r\n        }\r\n    }\r\n    // const saveGame = async (gameState) => {\r\n    //     getSaves();\r\n    // }\r\n    const onDelete = async (deleteSlot, vp, oi) => {\r\n        //slot sets value for deleteSlot, only deletes if deleteSlot is set and called a second time\r\n           props.showModal(false);\r\n           sendEvent(new Event(gameKeys.acMenu, 'delete', deleteSlot + \"\", null));\r\n          \r\n           await deleteSave(props.title, deleteSlot);\r\n           await setDeleteSlot(null);\r\n           getSaves();\r\n           props.onToast('Save file deleted');\r\n\r\n    }\r\n    const onPlay = (id,vp, oi) => {\r\n        props.onPlay(startSession(props.title));\r\n    }\r\n    const renderPlayButton = (i) => {\r\n        return <IconButton key=\"play\"  className={`new play`} \r\n            icon=\"icon-play3\"  color=\"text\" out={i} //text={text} \r\n            padding=\"20px\" iconSize=\"remL\"\r\n            glowBtn bgColor=\"primaryD\" hover onInput={onPlay} />\r\n    }\r\n    return <div>\r\n        {/* {renderModDelete()} */}\r\n    {items.map((e, i) => { // .delay-0\r\n        console.log(`rendering save file ${i}`, e);\r\n\r\n        return <SaveFile key={i} hover>\r\n            <ButtonWrapper>\r\n                <IconButton key=\"play\"  className={`new play`} \r\n                icon=\"icon-play3\"  color=\"primary\" out={i} //text={text} \r\n                iconSize=\"3.5\"\r\n                glowBtn hover hoverScale onInput={onPlay} />\r\n                <IconButton key=\"delete\"  className={`new play`} \r\n                icon=\"icon-cross\"  color=\"red\" out={i} //text={text} \r\n                iconSize=\"remM\" disabled={e?false:true}\r\n                glowBtn bgColor=\"transparent\" hover hoverScale onInput={(slot)=>{\r\n                    props.showModal(modalDeleteView(slot, onDelete))\r\n                }} />\r\n            </ButtonWrapper>\r\n        </SaveFile>\r\n        \r\n    })}\r\n</div>\r\n}\r\n\r\nconst ICON_SIZE = 3;\r\n\r\nexport default SaveFilesView;\r\n\r\nconst modalDeleteView = (deleteSlot, onDelete) => {\r\n    return  <DeleteView>\r\n        <Text tag=\"p\" color=\"secondary\">Are you sure you want to delete save file {deleteSlot}?</Text>\r\n        <div>\r\n        <Button id={deleteSlot} width=\"40%\" margin=\"3%\" glow onInput={()=>{onDelete(deleteSlot)}}>yes</Button>\r\n        {/* <Button width=\"40%\" margin=\"3%\" glow onInput={dontDelete}>yes</Button> */}\r\n        </div>\r\n    </DeleteView>\r\n}\r\n\r\nconst DeleteView = styled.section`\r\n    .text{\r\n        text-align: center;\r\n    }\r\n\r\n`\r\n\r\nconst ButtonWrapper = styled.div`\r\n    width:180px;\r\n    border-radius: 5px;\r\n    border: 5px dashed ${props => props.theme.secondary};\r\n    padding:10px;\r\n    display: inline-block;\r\n    display: flex;\r\n    justify-content: center;\r\n    align-items: center;\r\n    margin: auto;\r\n    background-color: rgba(0,0,0,0.9);\r\n`\r\n\r\nconst SaveFile = styled.div`\r\n    position:relative;\r\n    max-width: ${props => props.theme.mediaM};\r\n    margin: auto;\r\n    display: block;\r\n    padding: 5px 0px;\r\n\r\n\r\n    .save-title{\r\n        margin-left: 50px;\r\n        line-height:50px;\r\n    }\r\n\r\n    @media (min-width: ${props => props.theme.mediaS}){\r\n        padding: 20px 0px;\r\n        .save-title{\r\n            font-size: 1.5em;\r\n        }\r\n    }\r\n    .toRight{\r\n        right:10px;\r\n    }\r\n    .center-save{\r\n       position:absolute;\r\n       top:43%;\r\n       transform: translateY(-50%);\r\n    }\r\n    .play-button-wrapper{\r\n        margin: 10px;\r\n    }\r\n    .delete{\r\n        float:right;\r\n    }\r\n`\r\n/*\r\nanimateInAbsolute\r\n\r\nbackground-image: linear-gradient(rgba(255,255,255,0) 50%, rgba(255,255,255,0.5));\r\n*/\r\n","import React, {useEffect} from 'react';\r\nimport styled from 'styled-components';\r\nimport PropTypes from 'prop-types';\r\nimport IconBtn from 'views/IconButton/v1/IconButton.js';\r\nimport {log} from 'utilities/Measure';\r\n//recieves an array, and bool to randomize order, returns selection\r\nconst CAR_N = 'carn';\r\nconst CAR_P = 'carp';\r\nconst Carousel = (props) => {\r\n    const renderMarkers = () => {\r\n        //total, position, props.onMove pass back new index to parent\r\n        let markers = [];\r\n        for(let i = 0;i<props.total; i++){\r\n            markers.push(<div key={props.itemIds[i]} className={`marker ${i === props.index?'active':''}`}  />)\r\n        }\r\n        return markers;\r\n    }\r\n    const onMove = (id) => {\r\n        if(id === CAR_N){\r\n            props.onMove(props.index + 1 >= props.total?0:(props.index + 1));\r\n        }else{\r\n            props.onMove(props.index <= 0?(props.total-1):(props.index - 1));\r\n        }\r\n    }\r\n    return (\r\n        <Container>\r\n            <div className=\"markers\">\r\n                <IconBtn id={CAR_P} icon=\"icon-circle-down\" rotate=\"90\" className=\"carousel-prev\" onInput={onMove} />\r\n                {renderMarkers()}\r\n                <IconBtn id={CAR_N} icon=\"icon-circle-down\" rotate=\"270\" className=\"carousel-next\" onInput={onMove}/>\r\n            </div>\r\n            {props.children}\r\n        </Container>\r\n    )\r\n}\r\n\r\nexport default Carousel;\r\n\r\nCarousel.propTypes = {\r\n    total: PropTypes.number,\r\n    index: PropTypes.number,\r\n    onMove: PropTypes.func,\r\n    itemIds: PropTypes.array.isRequired\r\n}\r\n\r\nconst Container = styled.div`\r\n    position: relative;\r\n    .carousel-prev{\r\n        position: absolute;\r\n        left: -50px; top:0px;\r\n    }\r\n    .carousel-next{\r\n        position: absolute;\r\n        right: -50px; top:0px; \r\n    }\r\n    .markers{\r\n        text-align: center;\r\n        min-height: 50px;\r\n        display: inline-block;\r\n        position: relative;\r\n    }\r\n    .marker{\r\n        margin:15px 10px;\r\n        width: 20px;\r\n        height: 20px;\r\n        display: inline-block;\r\n        background-color: ${props => props.theme.primary};\r\n        opacity: 0.5;\r\n        transition: opacity 0.3s ease;\r\n        &.active{\r\n            opacity: 1;\r\n        }\r\n    }\r\n`\r\n","import React, {useState, useEffect} from 'react';\r\nimport styled from 'styled-components';\r\nimport Loading from 'views/Loading/v1/Loading';\r\nimport Button from 'views/Button/v1/Button';\r\nimport IconButton from 'views/IconButton/v1/IconButton.js';\r\nimport Text from 'views/Text/Text/v1/Text';\r\nimport Carousel from 'views/Carousel/index';\r\nimport Report from './../../report/Report';\r\nimport {log} from 'utilities/Measure';\r\nimport {getPlayer,  firestoreCatch, firestoreThen, deleteExam, getExam} from 'apis/firebase/firestoreFunctions';\r\nimport {cloudCatch, loadExam} from 'apis/firebase/cloudFunctions';\r\nimport {getUrl, getHost, getFullUrl} from 'utilities/Format.js';\r\nimport SignIn from 'apis/SignIn/SignIn';\r\n\r\n//only shown if signed in\r\n//encountered flakey bug: cannot read 0 of undefined when starting exam\r\nconst ExamView = (props) => {\r\n    const [user, setUser] = useState(null);\r\n    const [index, setIndex] = useState(0);\r\n    const [exams, setExams] = useState({});\r\n    const [isLoadingExam, setLoadingExam] = useState(false);\r\n    const [error, setError] = useState(null);\r\n\r\n    useEffect(()=>{\r\n        if(props.isSignedIn && props.user){\r\n            props.doSubscribe('examGetPlayer', ()=>{return getPlayer(props.user.uid)},\r\n                e => {\r\n                    let gameName = props.meta.import;\r\n                    let exams = {};\r\n                    for(let exam in e.exams){\r\n                        if(e.exams[exam].game === gameName){\r\n                            exams[exam] = e.exams[exam];\r\n                        }\r\n                    }\r\n                    setUser({...e, exams});\r\n                },\r\n                firestoreCatch, setError)\r\n        }\r\n    }, [props.user, props.isSignedIn])\r\n\r\n    const onLoadError = () => {\r\n        setLoadingExam(false);\r\n        setError(`failed to load exam`);\r\n    }\r\n    const onLoadExam = (examId) => {\r\n        //use examId to get the save from the db, call onPlay with it\r\n        setLoadingExam(true);\r\n        props.doSubscribe('examLoadExam', ()=>{return loadExam(examId)},\r\n        e => {\r\n                setLoadingExam(false);\r\n                if(e && e.data){\r\n                    props.onPlay(e.data, examId);\r\n                }else if(e && e.report){\r\n                    setExams({...exams, [examId]: e.report});\r\n                }else{\r\n                    setError(`failed to load exam`);\r\n                }\r\n        }, \r\n        cloudCatch, \r\n        onLoadError)\r\n    }   \r\n\r\n    const wrapExams = (views) => {\r\n        if(user && user.exams){\r\n            let ids = Object.keys(user.exams);\r\n            if(ids.length > 0){\r\n                return <Carousel index={index} total={ids.length} onMove={onCarouselMove} itemIds={ids}>\r\n                    {views}\r\n                </Carousel>\r\n            }\r\n        }\r\n        return views;\r\n    }\r\n    const renderExam = (examId, exam) => <div>\r\n        <Text color=\"secondary\" text={`Started on: ${new Date(exam.date).toLocaleString()}`} />\r\n        <Text color=\"secondary\" fontSize=\"remM\" className=\"text-center\" \r\n            text={exam.finalScore?`Score: ${exam.finalScore}`:'in progress' } />\r\n    </div>\r\n    const onDeleteExam = (examId) => {\r\n        if(examId && props.user.uid){\r\n            props.showModal(false);\r\n            let nExams = {...user.exams};\r\n            delete nExams[examId];\r\n            let nUser = {...user, exams: nExams};\r\n            setUser(nUser);\r\n            if(exams[examId]){\r\n                    nExams = {...exams};\r\n                    nExams = delete nExams[examId];\r\n                    setExams(nExams);\r\n            }\r\n            props.doSubscribe('examDeleteExam', ()=>{return deleteExam(props.user.uid, examId)},\r\n            firestoreThen(e => {\r\n                props.onToast(`Exam ${examId} deleted`)\r\n            }),\r\n            firestoreCatch, setError)\r\n        }else{\r\n            setError(`cannot delete exam without the user id and the exam id`);\r\n        }\r\n    }\r\n    const renderExams = () => {\r\n        if(user){\r\n            if(user.exams){\r\n                let examId = Object.keys(user.exams)[index];\r\n                let exam = user.exams[examId];\r\n                let report = exams[examId];\r\n                if(exam){\r\n                    let resumable = !exam.hasOwnProperty('finalScore');\r\n                    return wrapExams(<div style={{position: 'relative'}}>\r\n                        {renderExam(examId, exam)}\r\n                        {isLoadingExam && <Loading text=\"retrieving full report\" />}\r\n                        {!isLoadingExam && report && renderReport(report)}\r\n                        {!isLoadingExam && !report && <Button id={examId} onInput={onLoadExam} \r\n                            compact glow>\r\n                            {resumable?'resume exam':'view report'}\r\n                            </Button>}\r\n                        {!isLoadingExam && !report && <Button id={examId} onInput={() => {\r\n                                props.showModal(\r\n                                    getDeleteModal(examId, onDeleteExam)\r\n                                )\r\n                            }} \r\n                            compact>\r\n                            delete exam\r\n                            </Button>}\r\n                    </div>)\r\n                }\r\n            }\r\n            return <div><p style={{color: 'cyan'}}>No exams found</p></div>\r\n        }else if(error){\r\n            return <Text text={error} color=\"error\" />\r\n        }else{\r\n            return <Loading text=\"retrieving user\"/>\r\n        }\r\n    }\r\n    const onCarouselMove = (i) => {\r\n        setIndex(i);\r\n    }\r\n    const renderPlay = () => {\r\n      //  return <RenderPlayButton text={'Start New Exam'} doSignIn={props.doSignIn} /> props.onPlay(e.data, examId);\r\n        return <RenderPlayButton text={'Start New Exam'} onInput={()=>{props.onPlay(null, true);}} />\r\n    }\r\n    const renderReport = (exam) => {\r\n        return <div>\r\n            <Report game={props.meta} data={exam} />\r\n        </div>\r\n    }\r\n\r\n    return <Container>\r\n        <div className=\"newExam\">{renderPlay()}</div>\r\n        {/* {error && <Text text={error} color=\"error\" />} */}\r\n        <div className=\"exams\">  {renderExams()} </div>\r\n    </Container>\r\n}\r\n\r\nconst getDeleteModal = (examId, onDeleteExam) => {\r\n    return   <div>\r\n            <Text text=\"Delete Exam?\" />\r\n            <div>\r\n            <Button id={examId} compact onInput={onDeleteExam}>okay</Button>\r\n            </div>\r\n        </div>\r\n}\r\nconst RenderPlayButton = (props) => {\r\n    return <IconButton key=\"play\"  className={`new play`} \r\n        icon=\"icon-play3\"  color=\"text\" text={props.text} \r\n        padding=\"20px\" iconSize=\"remL\"\r\n        glowBtn bgColor=\"primaryD\" hover onInput={props.onInput} />\r\n}\r\nconst ExamToggle = (props) => {\r\n    useEffect(()=>{\r\n        if(!props.isSignedIn && props.doSignIn){\r\n            props.doSignIn();\r\n        }\r\n    }, [props.doSignIn])\r\n    console.log(`SignIn exam toggle props`, props);\r\n    return <Wrapper>\r\n        {props.isSignedIn && <ExamView {...props} onPlay={props.onPlay} meta={props.meta} />}\r\n        {/* {!props.isSignedIn && <Button onInput={()=>{props.doSignIn()}} compact>Play in Exam Mode</Button>} */}\r\n        {!props.isSignedIn && <RenderPlayButton text={'Play in Exam Mode'} onInput={props.doSignIn} />}\r\n\r\n    </Wrapper>\r\n}\r\n\r\n\r\n/*\r\nif(!props.isSignedIn){\r\n                props.doSignIn(teacherCreatePermissions)\r\n            }\r\n*/\r\n\r\n// const AuthenticatedExamView = Subscribable(SignIn(ExamToggle, getUrl(), false));\r\n\r\n// export default AuthenticatedExamView;\r\nexport default ExamToggle;\r\n\r\n//animation: fadeIn ${props => props.theme.animS} ease 0s forwards;\r\n//opacity: 0;\r\nconst Wrapper = styled.div`\r\n\r\n\r\n`\r\nconst Container = styled.div`\r\n\r\n    position: relative;\r\n    text-align: center;\r\n    margin: auto;\r\n    padding-top: 20px;\r\n    .exams{\r\n        min-height: 100px;\r\n        max-height: 400px;\r\n    }\r\n    .newExam{\r\n        min-height: 100px;\r\n    }\r\n`","import React, {useState, useEffect} from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport {validateCaptcha, cloudCatch} from 'apis/firebase/cloudFunctions';\r\nimport Subscribable from 'views/hoc/Subscribable/index.js';\r\nimport {log, WARN, sendEvent, sendError} from 'utilities/Measure.js';\r\nimport {Event} from 'utilities/Create';\r\n\r\nconst CAPTCHA_KEY = '6LeWWOQUAAAAANyPlsEzIwbJnqqXc70y6GKGSHJa';\r\nconst Captcha = (props) => {\r\n    const [error, setError] = useState(null);\r\n    useEffect(()=>{\r\n        loadCaptcha();\r\n    }, [])\r\n\r\n    const loadCaptcha = () => {\r\n        var script = document.createElement('script');\r\n        script.type = 'text/javascript';\r\n        script.src = `https://www.google.com/recaptcha/api.js?render=${CAPTCHA_KEY}`;\r\n        script.onload = (e) => {\r\n            grecaptcha.ready(() => {\r\n                verify();\r\n            });\r\n            \r\n        };\r\n        script.onerror = (e) => {\r\n            if(props.acceptOffline){\r\n                sendEvent(Event('captcha', 'validateSuccess', 'offline', null, true));\r\n                props.onVerify(true);\r\n            }else{\r\n                sendError('captcha error loading script', false);\r\n            }\r\n        }\r\n        document.body.appendChild(script);\r\n    }\r\n    const checkRepcaptchaWithServer = (token) => {\r\n        props.doSubscribe('checkRepcaptchaWithServer', \r\n            ()=>{return validateCaptcha(token)},\r\n            (result) => {\r\n                if(result.success){\r\n                    sendEvent(new Event('captcha', 'validateSuccess', result.score, null, true));\r\n                    props.onVerify(result.score >= props.minScore);\r\n                }else{\r\n                    sendEvent(Event('captcha', 'validateFail'));\r\n                    props.onVerify(false);\r\n                }\r\n            \r\n            },\r\n            cloudCatch, \r\n            setError\r\n        )\r\n    }\r\n    const verify = () => {\r\n        if(grecaptcha){\r\n            props.doSubscribe('recaptcha', \r\n                ()=>{return grecaptcha.execute(CAPTCHA_KEY, \r\n                    {action: props.id?props.id:'verify'}\r\n                )},\r\n                (token) => {\r\n                    checkRepcaptchaWithServer(token);\r\n                },\r\n                cloudCatch, \r\n                setError\r\n            )\r\n        }\r\n    }\r\n    if(error){\r\n        return <div><p style={{color: 'red'}}>reCaptcha error: {error}</p></div>\r\n    }\r\n    return null;\r\n}\r\nCaptcha.propTypes = {\r\n    onVerify: PropTypes.func,\r\n    minScore: PropTypes.number\r\n}\r\n\r\nexport default Subscribable(Captcha);\r\n\r\n","import React, {useEffect, useState} from 'react';\r\nimport ReactDom from 'react-dom';\r\nimport styled from 'styled-components';\r\nimport {Helmet} from 'react-helmet';\r\nimport {log, WARN, sendEvent, sendError} from 'utilities/Measure.js';\r\nimport {Event} from 'utilities/Create';\r\nimport Button from 'views/Button/v1/Button';\r\nimport Text from 'views/Text/Text/v1/Text';\r\nimport {validateCaptcha, cloudCatch} from 'apis/firebase/cloudFunctions';\r\nimport Subscribable from 'views/hoc/Subscribable/index.js';\r\n\r\nconst myCallback = (a1) => {\r\n    debugger;\r\n}\r\n\r\n\r\n\r\nconst CaptchaChallenge = (props) => {\r\n    const [error, setError] = useState(false);\r\n    useEffect(()=>{\r\n        window.onloadCallback = myCallback;\r\n        window.recaptchaCallback = handleSuccess;\r\n        window.recaptchaErrorCallback = myCallback;\r\n        window.recaptchaExpiredCallback = myCallback;\r\n    })\r\n\r\n    const handleSuccess = (token) => {\r\n        props.doSubscribe('checkRepcaptchaWithServer', \r\n            ()=>{return validateCaptcha(token, true)}, //true is v2\r\n            (result) => {\r\n                if(result.success){\r\n                    sendEvent(Event('captcha', 'validateSuccess', 'challenge', null, true));\r\n                    props.onVerify(result.success);\r\n                }else{\r\n                    sendEvent(Event('captcha', 'validateFail', 'challenge', null));\r\n                    props.onVerify(false);\r\n                }\r\n            },\r\n            cloudCatch, \r\n            setError\r\n        )\r\n    }\r\n    \r\n    return <div>\r\n        <Helmet>\r\n            {/* <script src=\"https://www.google.com/recaptcha/api.js?onload=onloadCallback\" async defer /> */}\r\n            <script src=\"https://www.google.com/recaptcha/api.js?\" async defer \r\n                \r\n                 />\r\n        </Helmet>\r\n        {error && <Text className=\"text-center\">{error}</Text>}\r\n        <form \r\n            //action=\"?\"\r\n            method=\"POST\"\r\n            style={wrapperStyles}\r\n         >\r\n            <div style={{margin: 'auto', textAlign: 'center'}} class=\"g-recaptcha\" \r\n                data-sitekey=\"6LeKbeQUAAAAAKcAIRSglAlCF8rzRcSesfO_1lR7\" \r\n                data-callback={'recaptchaCallback'} \r\n                data-error-callback={'recaptchaErrorCallback'} \r\n                data-expired-callback={'recaptchaExpiredCallback'} \r\n            />\r\n            {/* <br/>\r\n            <input type=\"submit\" value=\"Submit\" /> */}\r\n            {/* <Button glow onInput={handleSubmit}>\r\n                <Text>Send</Text>\r\n            </Button> */}\r\n        </form>\r\n    </div>\r\n}\r\n\r\nexport default Subscribable(CaptchaChallenge);\r\n\r\nconst wrapperStyles = {margin: 'auto', textAlign: 'center', display: 'inline-block'}","import React, {useEffect, useState} from 'react';\r\nimport ReactDom from 'react-dom';\r\nimport styled from 'styled-components';\r\nimport Captcha from './captcha';\r\nimport Loading from 'views/Loading/v1/Loading';\r\nimport {log, sendEvent} from 'utilities/Measure.js';\r\nimport {Event} from 'utilities/Create';\r\nimport Challenge from './challenge';\r\n\r\n\r\nconst VerifyTraffic = (props) => {\r\n    const [verified, setVerified] = useState(null);\r\n    const [doTest, setTest] = useState(false);\r\n    const onVerify = (result) => {\r\n        if(result){\r\n            setVerified(result);\r\n        }else{\r\n            setTest(true);\r\n        }\r\n    }\r\n    const onChallenge = (result) => {\r\n        setVerified(result);\r\n        setTest(false);\r\n    }\r\n    return <Container>\r\n        <Captcha id={props.id} \r\n        minScore={props.hasOwnProperty('minScore')?props.minScore:0.5} \r\n        acceptOffline={props.acceptOffline}\r\n        onVerify={onVerify} />\r\n        {doTest && <Challenge onVerify={onChallenge} acceptOffline={props.acceptOffline} />}\r\n        {verified === null && <Loading delay={0} text=\"Verifying your request\"/>}\r\n        {verified === true && props.children}\r\n    \r\n        {verified === false &&  \r\n            <Message>Unusual behaviour has been detected from your browser, try playing again later.</Message>}\r\n    </Container>\r\n}\r\n\r\nexport default VerifyTraffic;\r\n\r\nconst Container = styled.div`\r\n    position: relative;\r\n    height: 100%; width: 100%;\r\n    \r\n`\r\nconst Message = styled.p`\r\n    text-align: center;\r\n    color: ${props => props.theme.primary};\r\n`","import React, {useState, useEffect} from 'react';\r\nimport LocalGame from './local/index';\r\nimport Exam from './exam/index';\r\nimport Text from 'views/Text/Text/v1/Text.js';\r\nimport {isDevelopment} from 'utilities/Validation.js';\r\nimport Switch from 'views/Switch/v1/Switch';\r\nimport {getUrlHash} from 'utilities/Format';\r\nimport {AnimatePresence, motion} from 'framer-motion';\r\nimport {ANIM_LAYOUT_OVERLAP} from 'game/tree/Animations';\r\nimport Captcha from 'views/Captcha/index';\r\n\r\nconst LoadGame = (props) => {\r\n    const [examMode, setExamMode] = useState((getUrlHash() || props.isSignedIn)?true:false);\r\n\r\n    const onPlay = (gameState, examMode) => {\r\n        //if examId is defined, is an exam\r\n        //state could be from local, or from server, or undefined\r\n        props.onPlay(props.component, gameState, examMode);\r\n    }\r\n    const handleExamMode = (id, v) => {\r\n        setExamMode(v);\r\n    }\r\n\r\n    return <React.Fragment>\r\n            <AnimatePresence>\r\n                {!examMode && <motion.div key=\"local\" {...ANIM_LAYOUT_OVERLAP}>\r\n                    {isDevelopment() && <LocalGame {...props} onPlay={onPlay} />}\r\n                    {!isDevelopment() && <Captcha id=\"local\" minScore={0} acceptOffline>\r\n                        <LocalGame {...props} onPlay={onPlay} />\r\n                    </Captcha>}\r\n                </motion.div>}\r\n                {examMode && <motion.div key=\"exam\" {...ANIM_LAYOUT_OVERLAP}>\r\n                    {isDevelopment() && <Exam {...props} onPlay={onPlay} meta={props.meta} />}\r\n                    {!isDevelopment() && <Captcha id=\"exam\" minScore={0.5}>\r\n                        <Exam {...props} onPlay={onPlay} meta={props.meta} />\r\n                    </Captcha>}\r\n                </motion.div>}\r\n            </AnimatePresence>\r\n            {isDevelopment() && <div className=\"text-center\">\r\n                <div className=\"text-center\">\r\n                <Text tag=\"p\" color=\"secondary\" className=\"inline-block bg-text\">{examMode?\r\n                            'Play in Exam Mode (requires internet access)'\r\n                            :'Play Game'}\r\n                </Text>\r\n                </div>\r\n                <Switch id=\"exam-mode-switch\" active={examMode} onInput={handleExamMode} />\r\n            </div>}\r\n    </React.Fragment>\r\n}\r\n\r\nexport default LoadGame;\r\n","import React from 'react';\r\nimport IconButton from 'views/IconButton/v1/IconButton.js';\r\nimport styled from 'styled-components';\r\nimport PropTypes from 'prop-types';\r\nimport {log} from 'utilities/Measure.js';\r\nimport ClassShare from './ClassShare';\r\nimport Text from 'views/Text/Text/v1/Text';\r\n//let location = (globalHistory.location.origin + globalHistory.location.pathname);\r\n//'https://www.reddit.com/submit?url=' + location.href\r\nconst Social = (props) => {\r\n    const renderTwitter = () => {\r\n        // if(props.retweet){\r\n        //     return (<a href={`https://twitter.com/intent/retweet?tweet_id=${props.retweet}&text=${encodeString(props.message)}`} target=\"_blank\">\r\n        //     <IconButton icon=\"icon-twitter\" color=\"#00aced\" hover={\"white\"} /></a>)\r\n        // }else{\r\n        //     return <a href={`https://twitter.com/intent/tweet?url=${encodeString(props.url)}&text=${encodeString(props.message)}`} target=\"_blank\">\r\n        //     <IconButton icon=\"icon-twitter\" color=\"#00aced\" hover={\"white\"} /></a>\r\n\r\n        // }\r\n        return <a href={`https://twitter.com/intent/tweet?url=${encodeString(props.url)}&text=${encodeString(props.message)}`} target=\"_blank\">\r\n            <IconButton icon=\"icon-twitter\" color=\"#00aced\" hover={\"white\"} /></a>\r\n    }\r\n    const renderReddit = () => {\r\n        return <a href={`https://www.reddit.com/submit?url=${encodeString(props.url)}\r\n        &title=${encodeString(props.message)}`} target=\"_blank\">\r\n        <IconButton icon=\"icon-reddit\" color=\"#C6C6C6\" hover={\"white\"}/></a>\r\n    }\r\n    const renderFacebook = () => {\r\n        return <a href={`https://www.facebook.com/sharer/sharer.php?u=${encodeString(props.url)}`} target=\"_blank\">\r\n        <IconButton icon=\"icon-facebook2\" color=\"#3b5998\" hover={\"white\"}/></a>\r\n    }\r\n    const renderClass = () => {\r\n        if(props.classShare){\r\n            return <ClassShare title={props.classShare.title || props.title}  \r\n            description={props.classShare.description || props.message}\r\n            />\r\n        }\r\n    }\r\n    const encodeString = (str) => {\r\n        //Supernova+differences+could+change+our+understanding+of+dark+energy\r\n        let encoded = encodeURIComponent(str);\r\n        return encoded;\r\n    }\r\n    return (\r\n        <Container className={props.className?props.className:''}>\r\n                {/* <Text className=\"text-center\" fontSize=\"remXS\" padding=\"0 !important\" margin=\"0\">Share</Text> */}\r\n                <div>\r\n                {renderReddit()}\r\n                {renderTwitter()}\r\n                {renderFacebook()}\r\n                {renderClass()}\r\n                </div>\r\n              \r\n        </Container>\r\n    )\r\n}\r\n\r\nexport default Social;\r\n\r\nSocial.propTypes = {\r\n    url: PropTypes.string\r\n}\r\n\r\nconst Container = styled.div`\r\n    text-align: center;\r\n    #class-share{\r\n        padding-left: 50px !important;\r\n        position:relative !important;\r\n        iframe{\r\n            width:34px !important;\r\n            height:35px !important;\r\n            position:relative !important;\r\n            left: -37px !important;\r\n            top: 5px !important;\r\n        }\r\n    }\r\n`","import React, {useEffect, useState} from 'react';\r\nimport SimpleImage from 'game/Views/Image/simple';\r\nimport styled from 'styled-components';\r\nimport Text from 'game/Views/TextManager/TextManager';\r\nimport {AnimatePresence, motion} from 'framer-motion';\r\nimport Staged from 'game/Views/Staged';\r\nimport {toLatex} from 'utilities/Game/MathFun';\r\n\r\nconst DUR = 1;\r\nconst DEL = 0.3;\r\nconst IntroScene = (props) => {\r\n    const [index, setIndex] = useState(null);\r\n    const [text] = useState(props.scene.map(s =>{\r\n        if(s.text){\r\n            s.text = s.text.map(t => {\r\n                if(t.toLatex){\r\n                    return {latex: toLatex(t.toLatex), fontSize: '2', color: 'primary',...t};\r\n                }else{\r\n                    return {fontSize: t.fontSize || '1.5', tag:  t.tag ||'h2', color: t.color || 'text', text: t.text}\r\n                }\r\n            })\r\n        }\r\n        return s;\r\n    }))\r\n    console.log(`IntroScene props`, props);\r\n    console.log(`IntroScene text`, text);\r\n    useEffect(()=>{\r\n        let t = setTimeout(()=>{\r\n            setIndex((index + 1)%props.scene.length);\r\n        }, index === null?8000:5000)\r\n        return () =>{\r\n            if(t){\r\n                clearTimeout(t);\r\n            }\r\n        }\r\n    }, [index])\r\n    const getIndex = () => {\r\n        let i = 0;\r\n        if(index){\r\n            i = index;\r\n        }\r\n        return i;\r\n    }\r\n    const renderImage = () => {\r\n        let i = getIndex();\r\n        let img = props.scene[i].img;\r\n        let animate = {\r\n            opacity: 1,\r\n            left: '50%',\r\n            x: '-50%',\r\n            transition:{duration: DUR, delay:DUR*1,  ease: \"easeOut\"}\r\n        };\r\n        let id = `${img.key}-${img.pose}`\r\n        return <SimpleImage \r\n            key={img}\r\n            id={img} \r\n            noScale\r\n            imageId={img.key}\r\n            pose={img.pose}\r\n            src={props.images}\r\n            initial={index === null?{\r\n                opacity: 0,\r\n                left: '50%',\r\n                x: '-250%'\r\n            }:{...animate, opacity: 0}}\r\n            animate={animate}\r\n            exit={{...animate, opacity: 0}}\r\n        />\r\n    }\r\n    const renderText = () => {\r\n        let i = getIndex();\r\n        let text = props.scene[i].text;\r\n        let animate = {\r\n            opacity: 1,\r\n            left: '50%',\r\n            x: '-50%',\r\n            y:'-50%',\r\n            top: '70%',\r\n            width: '300px',\r\n            transition:{duration: DUR, delay:DUR*2,  ease: \"easeOut\"}\r\n        }\r\n        let id = `text-${i}`;\r\n        return <Staged\r\n            top='50%'\r\n            key={id}\r\n            initial={index === null?{\r\n                opacity: 0,\r\n                left: '50%',\r\n                x: '50%',\r\n                y:'-50%',\r\n                top: '70%',\r\n                width: '300px',\r\n            }:{...animate, opacity: 0}}\r\n            animate={animate}\r\n            exit={{...animate, opacity:0}}\r\n        >\r\n           <Text\r\n            id=\"intro-scene-text\" \r\n            className=\"bg-text\"\r\n            text={text}\r\n           />\r\n        </Staged>\r\n    }\r\n    return <IntroSceneWrapper>\r\n        <AnimatePresence>\r\n            {renderImage()}\r\n            {renderText()}\r\n        </AnimatePresence>\r\n    </IntroSceneWrapper>;\r\n}\r\n\r\nexport default IntroScene;\r\n\r\nconst IntroSceneWrapper = styled.div`\r\n    width:100%;\r\n    height:100%;\r\n    position: absolute;\r\n    top:0px;\r\n    left: 0px;\r\n    right:0px;\r\n`","import React, {useState} from 'react';\r\nimport styled from 'styled-components';\r\nimport {motion} from 'framer-motion';\r\nimport { Link } from \"gatsby\";\r\nimport Text from 'game/Views/TextManager/TextManager';\r\nimport Description from 'game/Views/Description/index.js';\r\nimport IconButton from 'views/IconButton/v1/IconButton.js';\r\nimport LoadGame from './../LoadGame/index';\r\nimport {getUrl, getHost, getFullUrl} from 'utilities/Format.js';\r\nimport Social from 'views/SEO/Social/Social.js';\r\nimport NestedSignIn from 'apis/SignIn/NestedSignIn';\r\nimport Reveal from 'views/Reveal/index';\r\nimport IntroScene from './Scene';\r\n\r\nconst FOLD_OUT_HEIGHT = '300px';\r\nconst DUR = 1;\r\nconst FOLD_OUT_ANIMATIONS = {\r\n    transition: { ease: \"easeOut\", duration: DUR },\r\n    initial: \"invisible\",\r\n    variants: {\r\n        invisible: {\r\n            opacity: 0\r\n        },\r\n        hidden: {\r\n            y: '-50px',\r\n            opacity: 1\r\n        },\r\n        visible: {\r\n            y: '-' + FOLD_OUT_HEIGHT,\r\n            opacity: 1\r\n        }\r\n    }\r\n}\r\nconst PLAY_BUTTON_ANIMATIONS = {\r\n    transition: { ease: \"easeOut\", duration: DUR, delay: DUR*3 },\r\n    initial: \"invisible\",\r\n    variants: {\r\n        invisible: {\r\n            opacity: 0,\r\n            y: '-50px',\r\n            x: '-50%'\r\n        },\r\n        visible: {\r\n            y: '0px',\r\n            opacity: 1,\r\n            x: '-50%'\r\n        }\r\n    }\r\n}\r\nconst GameIndex = (props) => {\r\n    const [menuOpen, setMenuOpen] = useState(false);\r\n    console.log(`GameIndex props meta`, props.meta);\r\n    return <React.Fragment>\r\n                    <IndexWrapper>\r\n                        {props.meta.intro && <IntroScene images={props.images} scene={props.meta.intro} />}\r\n                        <NestedSignIn recieveSignInProps={props.onSignIn} />\r\n                        <Reveal minHeight=\"70px\" timeout={3000}>\r\n                            <SocialWrapper>\r\n                                <Social url={getFullUrl()}\r\n                                    classShare={{title: props.meta.title, description: props.meta.snippet}}\r\n                                    message={props.meta.tweet || \"Try this math game out, they're very experimental\"} />\r\n                                <Link to={`${getUrl()}/teachers`}>\r\n                                    <Text text=\"Teacher's Section\" color=\"secondary\" className=\"text-underline text-right\" />\r\n                                </Link>\r\n                            </SocialWrapper>\r\n                       </Reveal>\r\n                         <Reveal timeout={2000}>\r\n                            <motion.div key=\"play-btns\" animate=\"visible\" \r\n                                    {...PLAY_BUTTON_ANIMATIONS}\r\n                                    className={`${menuOpen?'menu-open':''}\r\n                                        play-buttons text-center padding-vertical-auto\r\n                                    `}>\r\n\r\n                                       <LoadGame\r\n                                        {...props}\r\n                                        title={props.meta.import} \r\n                                        onPlay={props.onPlay}\r\n                                        onGameOver={props.showReport} //skip the form\r\n                                        gameState={props.gameState}\r\n                                        game={props.game}\r\n                                        meta={props.meta} \r\n                                        audio={props.meta.audio}\r\n                                        onToast={props.onToast}\r\n                                        showModal={props.showModal}\r\n                                        />\r\n                            </motion.div>\r\n                        </Reveal>\r\n                    </IndexWrapper>\r\n                    <Reveal timeout={2500}>\r\n                        <FoldOut {...FOLD_OUT_ANIMATIONS} animate={menuOpen?'visible':'hidden'}>\r\n                        <IconButton \r\n                                className=\"fold-out-trigger\"\r\n                                    icon=\"icon-circle-down\"\r\n                                    rotate={menuOpen?'0':'180'}\r\n                                    onInput={()=>{\r\n                                        setMenuOpen(!menuOpen)\r\n                                    }}\r\n                                />\r\n                            <div className=\"fold-out-content\">\r\n                                <Text text=\"Press Page\" href={getUrl() + \"/press\"} />\r\n                                <Description \r\n                                        id={`description-${props.meta.import}`}\r\n                                        borderImg\r\n                                        texts={props.meta.descriptions.map(e => {\r\n                                            return e.text;\r\n                                        })}\r\n                                        images={props.meta.descriptions.map(e => {\r\n                                            if(e && e.img) return e.img.childImageSharp;\r\n                                            return null;\r\n                                        })}\r\n                                    />\r\n                              \r\n                            </div>\r\n                        </FoldOut>\r\n                    </Reveal>\r\n                                        \r\n                  \r\n    </React.Fragment>\r\n}\r\n\r\n\r\n  export default GameIndex;\r\n\r\n\r\n  //+10 for the negative margin used in quest line\r\n  const SocialWrapper = styled.div`\r\n    position: absolute;\r\n    top:0px;\r\n    right:10px;\r\n  `\r\n  const IndexWrapper = styled(motion.div)`\r\n        overflow: auto;\r\n        max-height:100%;\r\n        padding-bottom: 50px;\r\n        .play-buttons{\r\n            z-index: ${props => props.theme.zMid};\r\n            top: 20%;\r\n            left: 50%;\r\n            position:absolute;\r\n            width: 90%;\r\n        }\r\n  `\r\n\r\n\r\nconst FoldOut = styled(motion.div)`\r\n    position: fixed;\r\n    background-color:black;\r\n    left: 0px;\r\n    right:0px;\r\n    top:100%;\r\n    z-index: ${props => props.theme.zUi};\r\n    height: ${FOLD_OUT_HEIGHT};\r\n    .fold-out-trigger{\r\n        height:50px;\r\n    }\r\n    .fold-out-content{\r\n        overflow: auto;\r\n        max-height:250px;\r\n    }\r\n`\r\n//why was this relevant? messes up the modal, probably for good reason\r\n\r\n","\r\nimport {mergePaths, getLocalChanges} from 'utilities/Merge.js';\r\nimport {gradeAnswers, measureScores} from 'utilities/Game/Scoring';\r\nimport * as randomize from 'utilities/Randomize.js';\r\nimport * as createAll from 'utilities/Create';\r\nimport * as formatAll from 'utilities/Format';\r\nimport * as ScoreAll from 'utilities/Game/Scoring.js';\r\nimport * as math from 'utilities/Game/MathFun';\r\nimport * as iterators from 'utilities/Iterators.js';\r\nimport * as latex from 'utilities/Game/Latex.js';\r\nimport {endGame, createExam, updateExam} from 'apis/firebase/cloudFunctions';\r\nimport {log, sendEvent} from 'utilities/Measure';\r\n\r\n// var mockSimState = {};\r\nconst initialize = async (gameCode, gameName, settings, examMode) => {\r\n    let sim;\r\n    if(examMode){\r\n       //call initializeExam on server, it returns a promise, await the result\r\n        let r = await createExam(gameName, settings);\r\n        r.playTime = [Date.now()];\r\n        return r;\r\n    }else{\r\n        sim = gameCode.sim.simInit(settings, createAll, randomize, formatAll, math, ScoreAll, iterators, latex); //(create, generate, format, math)\r\n     //   mockSimState = clone(sim);\r\n        sim.game.changes = [];\r\n        sim.playTime = [Date.now()];\r\n        //make any measurements\r\n        if(sim.game.meta.measurements){\r\n            sim.game.meta.measurements.map(event => {\r\n                sendEvent(event);\r\n            })\r\n        }\r\n        return sim;\r\n        \r\n    }\r\n}\r\n\r\nconst simulate = (state, sim, nodeId, gameId, settings) => {\r\n    let sendState = getLocalChanges(state.game);\r\n    return new Promise((res, rej) => {\r\n        let changes = null;\r\n        if(state.examId){\r\n            let result = updateExam(state.examId, gameId, nodeId, sendState);\r\n            res(result);\r\n        }else{\r\n            changes  =  { //\r\n                ...updateGame(sendState, state, sim, settings),\r\n            }\r\n            setTimeout(()=>{\r\n                res(changes);\r\n            }, 3000)\r\n        }\r\n    })\r\n\r\n}\r\n\r\nconst killTime = (changes) => {\r\n    return new Promise((res, rej) => {\r\n        setTimeout(()=>{\r\n            res(changes);\r\n        }, 3000)\r\n    })\r\n}\r\n\r\nconst updateGame = (sendToSim, state, simNode, settings) => {\r\n    //merge localChanges into game\r\n    let nGame = mergePaths(state.game, sendToSim.inputs);\r\n    state.game = nGame;\r\n    state.answers = mergePaths(state.answers || {}, sendToSim.mcq);\r\n    let changes = simNode(sendToSim, state, settings, createAll, randomize, formatAll, math, ScoreAll, iterators, latex);\r\n    return changes;\r\n}\r\n\r\n\r\n\r\n\r\nconst onEndGame = async (inputs, state, gameId) => {\r\n    let report;\r\n    log(`MyExamMode Tree onEndGame state.examId ${state.examId} state`, state);\r\n    if(state.examId){\r\n        let filledChanges = getLocalChanges(state.game);\r\n        filledChanges.values = state.game.values;\r\n        report = await endGame(state.examId, gameId, filledChanges);\r\n        //can recieve {error: } object TODO handle this case\r\n        log(`MyTree Gate onEndGame server returned report`, report);\r\n    }else{\r\n\r\n        report = gradeAnswers(state); //has to match server structure\r\n        //get time statement\r\n        measureScores(report);\r\n        report = await killTime(report);\r\n    }\r\n    log(`Gate onEndGame returning state`, state);\r\n    state.playTime.push(Date.now());\r\n    report.playTime = state.playTime;\r\n    log(`Gate onEndGame returning report`, report);\r\n\r\n    //measure the flags\r\n    let flags = state.game.flags;\r\n    for(let f in flags){\r\n        sendEvent(createAll.Event('flag', f, null, flags[f]));\r\n    }\r\n    return report;\r\n}\r\nexport default {\r\n   initialize, \r\n   simulate,\r\n   onEndGame\r\n}\r\n","import React, {useEffect, useState} from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport {log} from 'utilities/Measure';\r\n\r\nconst importAssets = (assets) => {\r\n    return Promise.all(assets.map(a => {\r\n        return importFile(a);\r\n    }))\r\n}\r\n\r\nconst importFile = (id) => {\r\n    switch(id){\r\n        case 'good-work-neku': return import('./assets/good-work-neku.mp3');\r\n        case 'tatakai': return import('./assets/tatakai.mp3');\r\n        case 'observe-the-star': return import('./assets/observe-the-star.mp3');\r\n        case 'f1-annoyed': return import('./assets/f1-annoyed.mp3');\r\n        case 'f1-gasp': return import('./assets/f1-gasp.wav');\r\n        case 'f1-laugh': return import('./assets/f1-laugh.mp3');\r\n        case 'f1-grumble': return import('./assets/f1-grumble.mp3');\r\n        case 'f1-sigh': return import('./assets/f1-sigh.mp3');\r\n        case 'f1-okay': return import('./assets/f1-okay.wav');\r\n        case 'f1-what': return import('./assets/f1-what.wav');\r\n        case 'f1-why': return import('./assets/f1-why.wav');\r\n        case 'f1-how': return import('./assets/f1-how.wav');\r\n        case 'strangeShop': return import('./assets/strangeShop.mp3');\r\n    }\r\n}\r\n\r\nconst unplayedRequests = {};\r\n\r\nconst AudioView = (View) => function MyAudio(props){\r\n    const [audio, setAudio] = useState({});\r\n    const [toPlay, setToPlay] = useState(null);\r\n\r\n    useEffect(()=>{\r\n        if(props.audio){\r\n            importAssets(props.audio).then(function(values) {\r\n                let players = {};\r\n                values.map((v, i) => {\r\n                    players[props.audio[i]] =  new Audio(v.default);\r\n                })\r\n                setAudio(players);\r\n    \r\n            }).catch(e => {\r\n                log(`Audio import failed `, e);\r\n            })\r\n        }\r\n      \r\n    }, [])\r\n    useEffect(()=>{\r\n        return () => {\r\n            for(let kPlaying in audio){\r\n                stopAudio(audio[kPlaying]);\r\n            }\r\n        }  \r\n    }, [audio])\r\n    const stopAudio = (track) => {\r\n        track.pause();\r\n        track.remove();\r\n    }\r\n    useEffect(()=>{\r\n        for(let kAudio in audio){\r\n            audio[kAudio].volume = props.settings.sound;\r\n        }\r\n    }, [props.settings.sound])\r\n    useEffect(()=>{\r\n      \r\n        if(toPlay){\r\n            let playList = Array.isArray(toPlay)?toPlay:[toPlay];\r\n            playList.map(e => {\r\n                playAudio(e, audio);\r\n            })\r\n        }\r\n        let unplayedKeys = Object.keys(unplayedRequests);\r\n        if(unplayedKeys.length > 0){\r\n            unplayedKeys.map(k => {\r\n                playAudio(unplayedRequests[k], audio)\r\n            })\r\n        }\r\n\r\n    }, [toPlay, audio])\r\n    const getVolume = (volume) => {\r\n        if(props.settings && props.settings.hasOwnProperty('sound')){\r\n            return (volume || 0.5)*props.settings.sound;\r\n        }else{\r\n            return volume || 0.5\r\n        }\r\n    }\r\n    const playAudio = (e, src) => {\r\n        let audioFile;\r\n        if(audio[e.id] && e.stop){\r\n            audioFile = audio[e.id];\r\n            // audioFile.pause();\r\n            // audioFile.remove();\r\n            stopAudio(audioFile);\r\n        }else if(audio[e.id]){\r\n            audioFile = audio[e.id];\r\n            if(e.loop) audioFile.loop = e.loop;\r\n            audioFile.autoplay = true;\r\n            audioFile.volume = getVolume(e.volume);\r\n            audioFile.play();\r\n            if(unplayedRequests[e.id]){\r\n                delete unplayedRequests[e.id];\r\n            }\r\n        }else{\r\n            unplayedRequests[e.id] = e;\r\n        }\r\n    }\r\n    const updatePlay = (play) => {\r\n        return new Promise((res,req) => {\r\n            setTimeout(()=>{\r\n                setToPlay(play);\r\n                res();\r\n            }, 1000)\r\n        })\r\n        \r\n    }\r\n    const doPlay = (play) => {\r\n        if(props.settings && props.settings.sound > 0){\r\n            //setToPlay(play);\r\n            setTimeout(()=>{\r\n                setToPlay(play);\r\n            }, 10)\r\n        }\r\n    }\r\n    return  <View {...props} doPlay={doPlay}  />;\r\n}\r\n\r\nAudioView.propTypes = {\r\n    audio: PropTypes.array\r\n}\r\n\r\nexport default AudioView;\r\n\r\n","import React, {useState, useEffect, useLayoutEffect, useContext, useMemo, useRef} from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport styled, {withTheme} from 'styled-components';\r\nimport Worker from './Gate'; //used to be GateWorker\r\nimport Factory from './ViewFactory.js';\r\nimport generator from 'utilities/Generator';\r\nimport Layout from 'views/FlexContainer/v1/FlexContainer';\r\nimport IconButton from 'views/IconButton/v1/IconButton';\r\nimport { AnimatePresence, motion } from 'framer-motion';\r\nimport Loading from 'views/Loading/v1/Loading';\r\nimport {ANIM_PAGE} from './Animations';\r\nimport {makeChange, mergeStates, mergePaths} from 'utilities/Merge.js';\r\nimport {sendEvent, sendError, sendTime, log} from 'utilities/Measure';\r\nimport {Event} from 'utilities/Create';\r\nimport Subscribable from 'views/hoc/Subscribable/index.js';\r\nimport {cloudCatch} from 'apis/firebase/cloudFunctions';\r\nimport Audio from './../Audio/index';\r\nimport clone from 'lodash/clone';\r\nimport {addFlag} from 'utilities/Game/Flags';\r\n\r\n\r\nconst Tree = (props) => {\r\n    const [mystate, setMyState] = useState({});\r\n    const [node, setNode] = useState({});\r\n    const [inputs, setInputs] = useState({});\r\n    const [views, setViews] = useState(null);\r\n    const [isInitializing, setIsInitializing] = useState(\"Initializing Game...\");\r\n    const [mergeInputs, setMergeInputs] = useState([]);\r\n\r\n    /***TRACK VIEW SIZE */\r\n    useEffect(()=>{ \r\n        //if declare dependence on treeSettings, game keep reinitializing\r\n        log(`Tree gameState initialize`, props);\r\n        if(!props.gameState){\r\n            props.doSubscribe('treeInit', \r\n            ()=> {return Worker.initialize(props.game, props.meta.import, props.settings, props.examMode)},\r\n            e => {\r\n                e.time = Date.now();\r\n                update(e,  onInput);\r\n                setIsInitializing(false);\r\n            },\r\n            cloudCatch,\r\n            onTreeError)\r\n        }\r\n        else if(props.gameState.game.sentHash !== props.gameState.game.recievedHash){\r\n            //if it doesnt go through change Nodes again, chance that loop didn't finish and game is in illegal state\r\n            props.gameState.playTime.push(Date.now());\r\n            changeNodes(props.gameState.inputs || {}, props.gameState, props.game, props.meta, \r\n                        props.settings, props.doSubscribe, onInput);\r\n            setIsInitializing(false);\r\n        }else{\r\n            props.gameState.playTime.push(Date.now());\r\n            update(props.gameState,  onInput);\r\n            setIsInitializing(false);\r\n        }\r\n      //  initialize(props.game, props.gameState, viewProps, props.meta.import, props.examId); //not exma if id is null\r\n      }, [viewProps, onInput, props.meta, props.examMode]);\r\n\r\n    useEffect(()=>{\r\n        props.setMenuItem({settings: <IconButton icon=\"icon-cog\" size=\"iconMem\" height=\"100%\" color=\"text\" onInput={props.showSettings} />});\r\n        return ()=>{\r\n            props.setMenuItem({quest: null, save: null, settings: null});\r\n        }\r\n    }, [])\r\n\r\n    const getSaveCallback = (mystate, inputs, autoSave) => (event) => {\r\n        // Cancel the event as stated by the standard.\r\n        if(event){\r\n            event.preventDefault();\r\n            // Chrome requires returnValue to be set.\r\n            event.returnValue = '';\r\n        }\r\n        if(node){ \r\n        \r\n            if(mystate.game && mystate.game.meta && !mystate.game.meta.gameover){\r\n                let save = {...mystate};\r\n                save.settings =props.settings;\r\n                save.hash = generator.getHash();\r\n                save.inputs = inputs;\r\n                let result = props.onSave(save, autoSave);\r\n                if(result !== false){\r\n                    props.showUI('toasttool', {text: 'Your progress has been saved', timeout: 3000});\r\n                }\r\n            }\r\n        }\r\n    }\r\n    useEffect(()=>{\r\n        let callback = getSaveCallback(mystate, inputs, true);\r\n        window.addEventListener('beforeunload', callback);\r\n        return ()=>{\r\n            //node is null initially, filled after init\r\n            getSaveCallback(mystate, inputs, false)();\r\n            window.removeEventListener('beforeunload', callback);\r\n        }\r\n    }, [mystate, props.settings, inputs]);\r\n\r\n\r\n    const getNode = (location, gameState) => {\r\n        let node =props.game.trees[location];\r\n        if(!node){\r\n            throw Error(`unable to find a node with the location ${location}`);\r\n        }\r\n        return node(gameState.game, gameState.settings || props.settings, viewProps);\r\n    }\r\n\r\n    const update = (game, oi) => {\r\n        try{\r\n            let location = game.game.move.location;\r\n            let key = location?location:props.game.start;\r\n           \r\n            let node = getNode(key, game);\r\n            startNewNode(game, node, oi)\r\n\r\n        }catch(e){\r\n            onTreeError(e.message, e.stack);\r\n        }\r\n\r\n    }\r\n    const startNewNode = (game, node, makeChange) => {\r\n        /**Record node user has selected */\r\n        sendEvent(new Event(props.game.k.acLoc, node.node, node.label, null, null));  //const sendPageview = (location) => {\r\n\r\n        /**Load new node into state */\r\n        let nInputs = {temp: {}};\r\n        setInputs(nInputs);\r\n        setMyState(game); \r\n        setNode(node)\r\n        renderViews(node.view, nInputs, makeChange);\r\n    }\r\n    const onTreeError = (message, stack) => {\r\n        sendError(`onTreeError ${message}`);\r\n        log(`onTreeError message ${message} stack`, stack, 'warn');\r\n        props.onError(`There was an error loading the game`);\r\n    }\r\n    const changeNodes = (inputs, game, tree, meta, settings,  doSubscribe, onInput) => {\r\n        //let game = mystate.game;\r\n            let mergedState = game.game;\r\n            if(!inputs.move || (inputs.move && !inputs.move.skipChange)){\r\n         \r\n                mergedState = mergeStates(mergedState, inputs);\r\n                game.game = mergedState;\r\n                \r\n                if(inputs.move) inputs.move.skipChange = false;\r\n            }\r\n            if(game.game.meta.gameover){\r\n                //call server onGameOver with finall changes\r\n              //  setIsInitializing(\"Ending game\")\r\n                game.game.sentHash = Math.random();\r\n                props.doSubscribe('treeEndGame', \r\n                ()=>{return Worker.onEndGame(inputs, game, props.meta.import)},\r\n                e => {\r\n                    game.game.recievedHash = game.game.sentHash;\r\n                    props.onGameOver(e);\r\n                },\r\n                cloudCatch, \r\n                onTreeError)\r\n            }else{\r\n                let location = game.game.move.location;\r\n                let key = location?location:tree.start;\r\n            \r\n                game.game.flags = addFlag(game.game.flags, key);\r\n                if(tree.sim[key]){\r\n                    //setIsInitializing(\"Talking to server\");\r\n                    game.game.sentHash = game.game.sentHash === 'hello'?'hi':'hello';\r\n                     doSubscribe('treeSimulate', \r\n                        ()=>{return Worker.simulate(clone(game), tree.sim[key], key,\r\n                             meta.import, settings)},\r\n                        e => {\r\n                            game.game.recievedHash = game.game.sentHash;\r\n                            let sState = mergePaths(game, e);\r\n                            update(sState, onInput);\r\n                        },\r\n                        cloudCatch,\r\n                        onTreeError\r\n                    )\r\n                }else{\r\n                    game.game.recievedHash = game.game.sentHash;\r\n                }\r\n                \r\n            }\r\n            if(game.hasOwnProperty('time')){\r\n                let time = Date.now();\r\n                let elapsedTime = time - game.time;\r\n                game.time = time;\r\n                sendTime(`tree-timing`, node.node, null, elapsedTime, null); \r\n            }else{\r\n                game.time = Date.now();\r\n            }\r\n            update(game, onInput);\r\n    }\r\n    useEffect(()=>{\r\n        if(mystate && inputs.move || (inputs.meta && inputs.meta.gameover)){\r\n            changeNodes(inputs, mystate, props.game, props.meta, props.settings, props.doSubscribe, onInput);\r\n        }\r\n    }, [mystate.game, inputs, props.settings, viewProps, onInput, props.meta])\r\n\r\n    useEffect(()=>{\r\n        if(mystate && mergeInputs.length > 0){\r\n            let nInputs = makeChange(mystate.game, inputs, mergeInputs, props.showUI, mystate.game.meta.simFields);\r\n       \r\n            setMergeInputs([]);\r\n            setInputs({...nInputs}); //ensure mergeInputs is overridden so actions arent performed multiple times\r\n            \r\n            if(!nInputs.move){ //will be called laterif move is true\r\n                renderViews(node.view, nInputs,  onInput)\r\n            }\r\n        }\r\n    }, [mergeInputs, inputs, props.showUI, mystate, props.settings])\r\n\r\n    const onInput = (id, value)=>{\r\n        let v = value;\r\n        if(!value){\r\n            debugger;\r\n        }\r\n        if(v.hasOwnProperty('out')) v = v.out; //some views store actions as parameter out\r\n        if(!Array.isArray(v)) v = [v];\r\n        setMergeInputs(v);\r\n    }\r\n    const renderViews = (views, inputs,  onInput) => {\r\n        setViews(Factory(views(inputs, onInput)))\r\n    }\r\n\r\n\r\n    const [viewProps] = useState({meta: props.meta, \r\n        showUI: props.showUI, \r\n        doPlay: props.doPlay,\r\n        images: props.images,\r\n        keys: props.game.k});\r\n\r\n    return <Container>\r\n        <motion.div id=\"tree-loading\" key=\"tree-loading\" style={stylesLoading} \r\n            variants={ANIM_PAGE} \r\n            animate={isInitializing?'animate':'exit'} initial='initial'>\r\n            <div style={stylesLoaderWrapper}>\r\n                <Loading id=\"tree-loading-view\" autoActive spinner delay={300} text={isInitializing}/>\r\n            </div>\r\n        </motion.div>\r\n        <motion.div id=\"tree-game-content\" key=\"tree-game-content\" style={stylesLoading} \r\n            variants={ANIM_PAGE} \r\n            animate={isInitializing?'exit':'animate'} initial='initial'>\r\n            <Flex \r\n                //breakpoint={props.breakpoint}\r\n            >\r\n                  \r\n                    {node.node  && views && <AnimatePresence exitBeforeEnter>\r\n                        <Layout key={node.node} id={node.node} padding scrollable\r\n                            fontsize={props.settings.fontsize} viewProps={viewProps} layoutRelative>\r\n                                {views}\r\n                        </Layout>\r\n                    </AnimatePresence>}\r\n            </Flex>\r\n        </motion.div>\r\n\r\n  \r\n    </Container>\r\n}\r\n\r\nTree.propTypes = {\r\n    id: PropTypes.string\r\n}\r\n\r\nconst stylesLoaderWrapper = {position: 'absolute', top: '50%', left: '50%', transform: 'translate(-50%, -50%)'}\r\nconst stylesLoading = {width: '100%', height: '100%', position: 'absolute',\r\n                top:'0px', left: '0px', right:'0px', bottom:'0px'};\r\nconst themedTree = withTheme(Subscribable(Tree));\r\nexport default Audio(themedTree);\r\n\r\n\r\nconst Container = styled.div`\r\n    height: 100%;\r\n    display: inline-block;\r\n    width:100%;\r\n    margin: auto; \r\n    \r\n`\r\nconst Flex = styled.div`\r\n    width:100%;\r\n    height:100%;\r\n`\r\n","import React, {useState, useEffect} from 'react';\r\nimport Text from 'views/Text/Text/v1/Text.js';\r\nimport styled from 'styled-components';\r\nimport {motion, AnimatePresence} from 'framer-motion';\r\nimport {log} from 'utilities/Measure';\r\nimport {roundTo} from 'utilities/Format';\r\n\r\nconst defaultTime = 1500;\r\n\r\nconst unlockConfig ={\r\n    duration: defaultTime,\r\n    spread: 40,\r\n    dragFriction: 0.05,\r\n    startVelocity: 45,\r\n    colors: ['blue', 'cyan', 'white']\r\n}\r\nconst correctConfig ={\r\n    duration: defaultTime,\r\n    spread: 60,\r\n    dragFriction: 0.1,\r\n    startVelocity: 55,\r\n    colors: ['lime', 'yellow', 'green']\r\n}\r\nconst incorrectConfig ={\r\n    duration: defaultTime,\r\n    spread: 200,\r\n    angle: 270,\r\n    dragFriction: 0.2,\r\n    startVelocity: 15,\r\n    colors: ['red', 'orange', 'purple']\r\n}\r\nconst getScoreFuck = (sc) => {\r\n    if(isNaN(sc)) return sc\r\n    let r = sc;\r\n    if(sc >= 0 && sc <= 1){\r\n        r = sc * 100;\r\n    }\r\n    return roundTo(r, 2);\r\n}\r\n\r\nconst View = (props) => {\r\n    const [active, setActive] = useState(false);\r\n    const [score, setScore] = useState(getScoreFuck(props.score));\r\n    useEffect(()=>{\r\n        setScore(getScoreFuck(props.score))\r\n    }, [props.score])\r\n    useEffect(()=>{\r\n        if(props.id){\r\n            setActive(true);\r\n            let timer = setTimeout(()=>{\r\n                setActive(false);\r\n            }, defaultTime);\r\n            \r\n            return ()=>{clearTimeout(timer)}\r\n        }\r\n    }, [props.id]);\r\n    const getOpacity = (howWrong) => {\r\n        if(howWrong){\r\n            return (100 - score)/100 + \"\"\r\n        }\r\n        return score/100 + \"\"\r\n    }\r\n    return(\r\n        <Container className=\"z-ui\">    \r\n            <Overlay key={'feedbackui'} id={'feedbackui'} initial=\"exit\" animate={active?'enter':'exit'}\r\n                variants={{enter: VISIBLE, exit: HIDDEN}}>\r\n                {/* <Container className={`${props.unlock?'unlock':props.score === 100?'correct':'incorrect'}`}/> */}\r\n                <FeedbackScore>\r\n                    <Text fontSize=\"5\" color=\"secondary\">{score}%</Text>\r\n                </FeedbackScore>\r\n                <Container style={{opacity: getOpacity()}} className={'correct'}/>\r\n                <Container style={{opacity: getOpacity(true)}}className={'incorrect'}/>\r\n        \r\n            </Overlay>}\r\n        </Container>\r\n    )\r\n}\r\n\r\n// && props.settings.animation\r\nexport default View;\r\n\r\nconst VISIBLE = {\r\n    opacity: 1,\r\n}\r\nconst HIDDEN = {\r\n    opacity: 0,\r\n}\r\nconst FeedbackScore = styled.div`\r\n    position: absolute;\r\n    bottom:10%;\r\n    left:0px; right:0px;\r\n    text-align:center;\r\n    background-color: ${props => props.theme.textBg};\r\n`\r\nconst Overlay = styled(motion.div)`\r\n    position: absolute;\r\n    left: 0px; right: 0px; top: 0px; bottom: 0px;\r\n    width: 100%;\r\n    height: 100%;\r\n    transform-origin: 50% 100%;\r\n`;\r\nconst Positioned = styled.div`\r\n    position: fixed;\r\n    left: 50vw;\r\n    top: ${props => props.top};\r\n    pointer-events: none;\r\n   \r\n`\r\nconst Container = styled.div`\r\nposition: fixed;\r\ntop: 0px; left: 0px; right: 0px; bottom: 0px;\r\n  \r\n    pointer-events: none;\r\n    &.correct{\r\n        background-image: radial-gradient(at 50% 25%, transparent 30%, rgba(3, 191, 0, 0.2) 70%, rgba(3, 191, 0, 1) 100%);\r\n    }\r\n    &.incorrect{\r\n        background-image: radial-gradient(at 50% 25%, transparent 30%, rgba(255, 0, 0, 0.2) 70%, rgba(255, 0, 0, 1) 100%);\r\n    }\r\n    &.unlock{\r\n        background-image: radial-gradient(at 50% 25%, transparent 30%, rgba(0, 0, 255, 0.2) 70%, rgba(0, 0, 255, 1) 100%);\r\n    }\r\n`\r\n//background-image: linear-gradient(transparent, lime);width: 100%; height: 100%;\r\n\r\n/*position: fixed;  z-index: 200;\r\ntop: 0px; left: 0px; right: 0px; bottom: 0px;\r\n\r\nleft: ${props => props.left};\r\ntop: ${props => props.top};\r\nbackground-image: radial-gradient(at 50% 25%, transparent 30%,rgba(255, 0, 0, 0.2) 70%, rgba(255, 0, 0, 1) 100%);\r\n    position: fixed;\r\n    top: 0px; left: 0px; right: 0px; bottom: 0px;\r\n\r\n*/","import keys from 'games/keys.js';\r\n\r\nconst settingsViews = [\r\n    {key: keys.setDiff, active: true,text:'difficulty', type: 'category', value: 1, \r\n        labels: [{label: 'easy - simple, automatic', value: 1}, \r\n        {label: 'normal - simple, not automatic', value: 2}, \r\n        {label: 'hard - harder, not automatic', value: 4}]\r\n    },\r\n    // {key: keys.setAni, active: true, type: 'boolean', value: 1, labels: ['animation is off', 'animation is on'], inPlay: true},\r\n     {key: keys.setSound, active: true, type: 'slider', value: 0.5, label: 'Sound volume', inPlay: true},\r\n    // {key: keys.setExam, active: process.env.NODE_ENV === 'development', type: 'boolean', value: 0, labels: ['is not an exam', 'is an exam']},\r\n    {key: keys.setFont, active: true, type: 'category', inPlay: true, value: 18, \r\n    labels: [{label: 'small', value: 14}, {label: 'medium', value: 18}, {label: 'large', value: 22}],\r\n    text: 'Font Size'\r\n    },\r\n]\r\nexport default settingsViews;\r\n\r\n\r\n/*\r\nconst settingsViews = [\r\n    {key: keys.setDiff, active: true,text:'difficulty', type: 'category', value: 1, \r\n    labels: [{label: 'easy - math is done automatically', value: 1}, \r\n    {label: 'normal - math questions have fewer answers with a greater difference between them', value: 2}, \r\n    {label: 'hard - math questions have fewer answers with a smaller difference between them', value: 4}]\r\n    },\r\n    // {key: keys.setAni, active: true, type: 'boolean', value: 1, labels: ['animation is off', 'animation is on'], inPlay: true},\r\n    {key: keys.setSound, active: true, type: 'boolean', value: 0, labels: ['sound is off', 'sound is on'], inPlay: true},\r\n    // {key: keys.setExam, active: process.env.NODE_ENV === 'development', type: 'boolean', value: 0, labels: ['is not an exam', 'is an exam']},\r\n    {key: keys.setFont, active: true, type: 'category', inPlay: true, value: 18, \r\n    labels: [{label: 'small', value: 12}, {label: 'medium', value: 18}, {label: 'large', value: 24}],\r\n    text: 'Font Size'\r\n    },\r\n]\r\n*/","import styled from 'styled-components';\r\n\r\nexport const Wrapper = styled.div`\r\ntext-align: left;\r\n    padding-left:30px;\r\n    .radio-item{\r\n        pointer-events: none;\r\n        color: ${props => props.theme.text};\r\n        padding-left:5px;\r\n        margin-right:30px;\r\n        font-size: 1em;\r\n    }\r\n`","import React, {useState} from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport './radio.css';\r\nimport {Wrapper} from './radio.css.js';\r\nimport Text from 'views/Text/Text/v1/Text';\r\nimport {log} from 'utilities/Measure';\r\n\r\nconst Radio = (props) => {\r\n    const [active, setActive] = useState(props.active || {})\r\n    const handleChange = (ev) => {\r\n        let index = ev.target.value;\r\n        let item = props.options[index];\r\n        let nState = props.multi?{...active}:{};\r\n        nState[index] = nState[index]?false:item.value;\r\n        setActive(nState);\r\n        /**See if there are any modifying functions for output */\r\n        let out = convertToOutput(nState);\r\n        if(props.out){\r\n            out = props.out(props.id, nState);\r\n        }\r\n        props.onInput(props.id, out);\r\n      \r\n    }\r\n    const convertToOutput = (selected) => {\r\n        let ray = [];\r\n        for(let key in selected){\r\n            if(selected[key]){\r\n                ray.push(selected[key]);\r\n            }\r\n        };\r\n        return ray.length === 1?ray[0]:ray;\r\n    }\r\n    const getRadioKey = (id, e) => {\r\n        if(props.multi){\r\n            return `${props.id}-${e}`;\r\n        }\r\n        return props.id;\r\n    }\r\n    const isChecked = (e) => {\r\n        let key = getRadioKey(props.id, e.value);\r\n        \r\n        let value = false;\r\n        if(Array.isArray(props.active)){\r\n            value = props.active.includes(e.value);\r\n        }else{\r\n            value = props.active === e.value;\r\n        }\r\n        return value;\r\n    }\r\n    return <div className={`${props.className || ''}`}>\r\n                \r\n                {props.text && <div><Text tag=\"h4\">{props.text}</Text></div>}  \r\n              \r\n                {props.options.map((e, i) => {\r\n                    return <Wrapper key={i} className=\"radio-container\"><label><input type=\"checkbox\" value={i} name={props.id} \r\n                                checked={isChecked(e)}  onChange={handleChange}/>\r\n                                <span className=\"radio-checkmark\"></span>\r\n                                <p className=\"radio-item\">{e.label || e}</p>\r\n                            </label></Wrapper>\r\n                })}\r\n            </div>\r\n}\r\n\r\nRadio.propTypes = {\r\n    options: PropTypes.array,\r\n    active: PropTypes.oneOfType([\r\n        PropTypes.number,\r\n        PropTypes.object,\r\n        PropTypes.bool\r\n    ]),\r\n    onInput: PropTypes.func,\r\n    out: PropTypes.func,\r\n    isMulti: PropTypes.bool\r\n}\r\n\r\nexport default Radio;\r\n","import React from 'react';\r\nimport Switch from 'views/Switch/v1/Switch'\r\nimport PropTypes from 'prop-types';\r\nimport styled from 'styled-components';\r\nimport Modal from \"views/Modal/v1/Modal\";\r\nimport Button from 'views/Button/v1/Button';\r\nimport Radio from 'views/Radio/v1/Radio';\r\nimport Slider from 'views/Slider/v1/Slider';\r\nimport Text from 'views/Text/Text/v1/Text';\r\nimport {log} from 'utilities/Measure';\r\nimport keys from 'games/keys.js';\r\n\r\nclass Set extends React.PureComponent{\r\n    constructor(props){\r\n        super(props);\r\n        this.onInput = this.onInput.bind(this);\r\n        this.handleSelect = this.handleSelect.bind(this);\r\n        this.onClose = this.onClose.bind(this);\r\n        this.state = {\r\n            settings: {...this.props.settings}, id: Math.random()\r\n        }\r\n    }\r\n    componentDidUpdate(prevProps){\r\n        if(prevProps.settings !== this.props.settings){\r\n            this.setState({settings: {...this.props.settings}});\r\n        }\r\n    }\r\n    onInput(id, value){\r\n        if(value.hasOwnProperty('value')){\r\n            this.setState({settings: {...this.state.settings, [id]: value.value}})\r\n        }else{\r\n            this.setState({settings: {...this.state.settings, [id]: value}})\r\n        }\r\n       \r\n    }\r\n    handleSelect(ev){\r\n        let name=ev.target.name;\r\n        let value=ev.target.value;\r\n        this.onInput(name, value);\r\n    }\r\n\r\n    renderSettings(){\r\n        return this.props.views.map((setting, i) => {\r\n            //some games don't have a difficulty setting\r\n            if(this.props.hasDifficultySetting || setting.key !== keys.setDiff){\r\n                if((!this.props.isPlaying || (this.props.isPlaying && setting.inPlay)) && setting.active){\r\n                    switch(setting.type){\r\n                        case 'category':\r\n                            return <Setting id={setting.key} key={i}>\r\n                                <Radio \r\n                                    id={setting.key}\r\n                                    onInput={this.onInput}\r\n                                    options={setting.labels}\r\n                                    active={this.state.settings[setting.key]}\r\n                                    text={setting.text}\r\n                                />\r\n                            </Setting>\r\n                        case 'boolean':\r\n                            return <Setting id={setting.key} key={i}>\r\n                                <p className=\"label-text\">{setting.labels[this.state.settings[setting.key]]}</p>\r\n                                <Switch id={setting.key} className=\"setting\" onInput={this.onInput} id={setting.key} \r\n                                        active={this.state.settings[setting.key] === 1} \r\n                                        label1={setting.labels[0]}\r\n                                        label2={setting.labels[1]}\r\n                                         />\r\n                            </Setting>\r\n                        case 'slider':\r\n                            return <Setting id={setting.key} key={i}>\r\n                                <Slider \r\n                                    id={setting.key}\r\n                                    min={0} max={1} step={0.1} value={this.state.settings[setting.key]}\r\n                                    text={setting.label}\r\n                                    onInput={this.onInput}\r\n                                />\r\n                            </Setting>\r\n                        default:\r\n                            return(\r\n                                <div id={setting.key} key={i}>\r\n                                    <p style={{color: 'pink'}}> Unknown type</p>\r\n                                </div>\r\n                            )\r\n                    }\r\n                }\r\n            }\r\n        })\r\n        \r\n    }\r\n    onClose(){\r\n        this.props.onClose(this.state.settings);\r\n    }\r\n    render(){\r\n        return(\r\n            <Modal active={this.props.active}>\r\n                <Container key=\"settings-container\" className=\"modal-child\">\r\n                    <Text tag=\"h2\">Settings</Text>\r\n                    {this.renderSettings()}\r\n                    {this.props.onClose &&  <Button id=\"setting-button\" key=\"setting-buttom\" glow \r\n                            onInput={this.onClose} width=\"100%\" margin=\"10px 0px\" >close</Button>}\r\n                </Container>\r\n            </Modal>\r\n        )\r\n    }\r\n}\r\n\r\nexport default Set;\r\n\r\nSet.propTypes = {\r\n    settings: PropTypes.object,\r\n    views: PropTypes.array\r\n}\r\nconst Container = styled.div`\r\n    max-width: ${props => props.theme.mediaM};\r\n    width:100%;\r\n    margin: auto;\r\n    padding: 40px 10px 10px 10px;\r\n    hr{\r\n        margin: 5px 0px;\r\n    }\r\n    h2{\r\n        text-align: center;\r\n        color: ${props => props.theme.text};\r\n        text-transform: uppercase;\r\n    }\r\n    div switch{\r\n        margin-top: 4px;\r\n    }\r\n`\r\n\r\nconst Setting = styled.div`\r\n    position: relative;\r\n   \r\n    padding: 10px;\r\n    border-bottom: 2px solid ${props => props.theme.neutral};\r\n    .label-text{\r\n        margin: 0px;\r\n        text-align: left;\r\n        color: ${props => props.theme.text};\r\n    }\r\n    .setting{\r\n        position: absolute;\r\n        top:50%; right:10px;\r\n        transform: translateY(-50%);\r\n        color: ${props => props.theme.text};\r\n    }\r\n    .category{\r\n        display: inline-block;\r\n        color: ${props => props.theme.text};\r\n        label{\r\n            padding: 0px 10px;\r\n        }\r\n    }\r\n`","import React, {useState, useEffect, useRef} from 'react';\r\nimport styled from 'styled-components';\r\nimport Tree from './Tree.js';\r\nimport FeedbackUi from 'views/Feedback/v1/Feedback';\r\nimport ToastToolUI from 'views/ToastTool/v1/ToastTool';\r\nimport Loading from 'views/Loading/v1/Loading';\r\nimport {Event} from 'utilities/Create';\r\nimport {sendEvent} from 'utilities/Measure';\r\nimport settingsViews from './SettingsConfig.js';\r\nimport Settings from './Settings';\r\nimport {getRandomIndex} from 'utilities/Format';\r\n\r\nconst BREAKPOINT = 1000; //keep it here, analytics divides by number of digits, 3 or 4\r\n\r\nconst makeSettings = (gameSettings) => {\r\n    let settings = {};\r\n    settingsViews.map(e => {\r\n        settings[e.key] = e.value;\r\n    })\r\n    if(gameSettings){\r\n        gameSettings.map(e => {\r\n            settings[e.key] = e.values[getRandomIndex(e.values.length)];\r\n        })\r\n    }\r\n    return settings;\r\n}\r\n\r\nconst measureSettings = (settings) => {\r\n    for(let kSett in settings){\r\n        sendEvent(Event('settings', kSett, settings[kSett], null, true))\r\n    }\r\n    return settings;\r\n}\r\n\r\n\r\nconst App = (props) => {\r\n    const [feedback, setFeedback] = useState({id: null, question: null, answer: null, correct: false});\r\n    const [toasttool, setToastTool] = useState({id: null, title: null, text: null, timeout: null});\r\n    const [loading, setLoading] = useState(false);\r\n    const [treeError, setTreeError] = useState(null);\r\n   // const [largeView, setLargeView] = useState(false);\r\n    const [settings, setSettings] = useState(props.gameState?\r\n            props.gameState.settings\r\n            :makeSettings(props.meta.gameSettings));\r\n    const [openSettings, setOpenSettings] = useState(props.gameState?false:true);\r\n    const [modalOpenedCounter, setModalOpenCounter] = useState(0);\r\n    //const [images, setImages] = useState(null);\r\n    const dimensionsRef = useRef();\r\n\r\n    // useEffect(()=>{\r\n    //     getCharacterSrc(props.meta.images).then(e=> {\r\n    //         if(props.meta.gameImages){\r\n    //             props.meta.gameImages.map(img => {\r\n    //                     e[img.id] =img.src.childImageSharp.fluid.src;\r\n    //             })\r\n    //         }\r\n    //         setImages(e);\r\n    //     }).catch(e => {\r\n    //             log(`game-post catch`, e);\r\n    //     })\r\n    // }, []);\r\n    const onError = (message) => {\r\n        setTreeError(message);\r\n    }\r\n    const onSave = (save, caller) => {\r\n        //if there is no error, save\r\n        if(!treeError){\r\n            return props.onSave(save, caller);\r\n        }\r\n    }\r\n    const showUI = (type, params) => {\r\n        if(type === 'feedback'){\r\n            setFeedback(params);\r\n        }else if(type === 'toasttool'){\r\n            setToastTool({id: `${Math.random()}`, ...params});\r\n        }else if(type === 'loading'){\r\n            setLoading(params);\r\n        }\r\n    }\r\n    const renderLoading = () => {\r\n        return <LoadingBlock>\r\n            <Loading />\r\n        </LoadingBlock>\r\n    }\r\n    const onModalClose = (nSettings) => {\r\n        setModalOpenCounter(modalOpenedCounter + 1);\r\n        setSettings(nSettings);\r\n        measureSettings(nSettings);\r\n        setOpenSettings(false);\r\n    }\r\n    const showSettings = () => {\r\n        setOpenSettings(true);\r\n    }\r\n    const isGameInit = () => {\r\n        return !props.gameState && modalOpenedCounter === 0;\r\n    }\r\n\r\n    return <Container  ref={dimensionsRef}>\r\n        <Content>\r\n            {!isGameInit() &&   <Tree \r\n                settings={settings} \r\n                game={props.game} \r\n                meta={props.meta} \r\n                gameState={props.gameState} \r\n                showUI={showUI} \r\n                onGameOver={props.onGameOver} \r\n                onSave={onSave} \r\n                setMenuItem={props.setMenuItem}\r\n                onError={onError} \r\n                //largeView={largeView} \r\n                //breakpoint={BREAKPOINT}\r\n                showSettings={showSettings}\r\n                examMode={props.examMode}\r\n                onError={props.onError}\r\n                audio={props.meta.audio}\r\n                images={props.images}\r\n            />}\r\n        </Content> \r\n        <FeedbackUi settings={props.settings} {...feedback} />\r\n        <ToastToolUI {...toasttool} />\r\n        {loading && renderLoading()}\r\n        <Settings\r\n            views={settingsViews}\r\n            settings={settings}\r\n            active={openSettings}\r\n            onClose={onModalClose}\r\n            isPlaying={!isGameInit()}\r\n            hasDifficultySetting={props.meta.hasDifficultySetting}\r\n            gameSettings={props.meta.gameSettings}\r\n        />\r\n    </Container>\r\n}\r\n\r\nexport default App;\r\n\r\nconst LoadingBlock = styled.div`\r\n    position: fixed; top: 0px; left: 0px; bottom: 0px; right: 0px;\r\n    background-color: #000000bb;\r\n`\r\nconst Container = styled.div`\r\n    padding:0;\r\n    box-sizing: border-box;\r\n    height:100%;\r\n`\r\n//font-size: ${props => props.fontsize?props.fontsize:'12'}px;\r\nconst Content = styled.div`\r\n    position: relative;\r\n    width:100%;\r\n    height:100%;\r\n`\r\n","import React, {useState, useEffect, useRef} from 'react';\r\nimport styled from 'styled-components';\r\nimport Button from 'views/Button/v1/Button.js'\r\nimport Subscribable from 'views/hoc/Subscribable/index.js';\r\nimport {motion, AnimatePresence} from 'framer-motion';\r\nimport {loadPersistent, setupProperty,  clearPersistantValues, trackPersistent,  \r\n             sendError, sendEvent, log, getPersistentValues} from 'utilities/Measure';\r\nimport {Event} from 'utilities/Create';\r\nimport gameKeys from 'games/keys.js';\r\nimport { navigate, Link } from \"gatsby\";\r\n import {Helmet} from 'react-helmet';\r\nimport Text from 'views/Text/Text/v1/Text';\r\nimport ToastToolUI from 'views/ToastTool/v1/ToastTool';\r\nimport {saveProgress, deleteSave} from './LoadGame/local/Storage';\r\nimport {saveExam} from 'apis/firebase/firestoreFunctions';\r\nimport {getUrl, getParentUrl} from 'utilities/Format.js';\r\nimport './main.css';\r\nimport getStructuredData from 'views/SEO/StructuredData/game.js';\r\nimport Modal from 'views/Modal/v1/Modal';\r\nimport Credits from 'views/Credits/index.js';\r\nimport Intro from './Intro/index';\r\nimport Layout from './tree/Layout';\r\nimport {storeItem, getEncKey} from 'utilities/Storage';\r\nimport {getReportKey} from './report/Report';\r\n\r\n\r\nexport const GAME_LAYOUT_ANIM = {\r\n    initial: {\r\n        opacity: 0, //y: 100,  \r\n        position: 'absolute', \r\n        transition: {duration: 0, delay:0}\r\n    },\r\n    animate: {\r\n        opacity: 1,// y: 0, \r\n        position: 'relative'\r\n    },\r\n    exit: {\r\n        opacity: 0, //y: 100,  \r\n        position: 'relative', \r\n    },\r\n    transition: {duration: 0.3, delay:0}\r\n}\r\nexport const EXTRA_LATE = {\r\n    initial: {\r\n        opacity: 0, //y: 100,  \r\n        position: 'absolute', \r\n        transition: {duration: 0.3, delay: 1}\r\n    },\r\n    animate: {\r\n        opacity: 1,// y: 0, \r\n        position: 'relative', \r\n        transition: {duration: 0.3, delay: 1}\r\n    },\r\n    exit: {\r\n        opacity: 0, //y: 100,  \r\n        position: 'relative', \r\n        transition: {duration: 0.3, delay:0}\r\n    },\r\n    \r\n}\r\nclass MainPage extends React.Component{\r\n    constructor(props){\r\n        super(props);\r\n        console.log(`Game MainPage props`, props);\r\n        this.state = {\r\n            menuOpen: false, play: false, form: false, report: false,\r\n            toasttool: {id: null, title: null, text: null, timeout: null},\r\n            signInProps: {},\r\n            showModal: null\r\n        }\r\n        this.onBack = this.onBack.bind(this);\r\n        this.onToast = this.onToast.bind(this);\r\n        this.onPlay=this.onPlay.bind(this);\r\n        this.onError=this.onError.bind(this);\r\n        this.renderScene = this.renderScene.bind(this);\r\n        this.getLogo = this.getLogo.bind(this);\r\n      //  this.showForm = this.showForm.bind(this);\r\n        this.showReport = this.showReport.bind(this);\r\n        this.showCredits = this.showCredits.bind(this);\r\n        this.saveGame = this.saveGame.bind(this);\r\n        this.setMenuItem = this.setMenuItem.bind(this);\r\n        this.showModal = this.showModal.bind(this);\r\n        this.closeModal = this.closeModal.bind(this);\r\n        this.onSignIn = this.onSignIn.bind(this);\r\n    } \r\n\r\n    componentDidMount(){\r\n        //addToDataLayer('event', 'optimize.activate');\r\n        setupProperty(this.props.meta.analytics);\r\n        loadPersistent({});\r\n        if(document.referrer){\r\n            sendEvent(Event('meta', 'referrer', document.referrer, null, true));\r\n        }\r\n        sendEvent(Event('meta', 'game-title', this.props.meta.import, null, true));\r\n        if(this.props.meta.measurments){\r\n            this.props.meta.measurments.map(d => {\r\n                trackPersistent(d);\r\n            })\r\n        }\r\n        //if this is a BUILD_GAME, then this page is root, no back button\r\n        this.props.addMenuItem({title: this.props.meta.title, onBack: this.props.BUILD_GAME?null:this.onBack});\r\n\r\n    }\r\n    componentWillUnmount(){\r\n        clearPersistantValues();\r\n        setupProperty(null);\r\n     }\r\n    setMenuItem(items, remove){\r\n        this.props.addMenuItem({title: this.props.meta.title, onBack: this.onBack, menuItems: items});\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @param {ReactComponentLike} GameComponent - the layout and tree for playing the game\r\n     * @param {Object} gameState - any saved game state from previous sessions\r\n     * @param {String|null} examId - in exam mode, is the exam id\r\n     */\r\n    onPlay(GameComponent, gameState, examMode){ //if examId is defined is an exam\r\n        let nState = {gameState, GameComponent, examMode: gameState?gameState.examId:examMode}; //if gameState isnt true, start new game with fresh state\r\n\r\n        if(gameState){ //is prev session\r\n            nState.settings = gameState.settings;\r\n            nState.gameState = gameState;\r\n            loadPersistent({...getPersistentValues(), ...gameState.analytics});\r\n            sendEvent(new Event(gameKeys.acMenu, 'resume', null, null));\r\n        }else{\r\n            sendEvent(new Event(gameKeys.acMenu, 'play', null, null));\r\n        }\r\n        nState.play = true;\r\n        this.setState(nState);\r\n    }\r\n    onError(message){\r\n        sendError(message, false);\r\n        this.setState({error: message, play: false, report: false, form: false})\r\n    }\r\n    onSignIn(signInProps){\r\n        this.setState({signInProps})\r\n    }\r\n    saveGame(gameState, autoSave, attempts = 0){\r\n        if(!autoSave && this.state.play){\r\n            return false;\r\n        };\r\n        gameState.playTime.push(Date.now());\r\n        if(!gameState) throw new Error(`Game attempted to save null gameState`);\r\n        let analytics = getPersistentValues();\r\n        gameState.analytics = analytics;\r\n        if(attempts < 3){ //expensive op\r\n            this.props.doSubscribe('saveGame', \r\n            this.state.signInProps && this.state.signInProps.user && this.state.examId?\r\n                ()=>{return saveExam(this.state.signInProps.user.uid, this.state.examId, gameState)}:\r\n                ()=>{return saveProgress(gameState, this.props.meta.import)},\r\n            e => {\r\n                //successfully saved new state to the db, pass back the game\r\n               // this.setState({toasttool: {id: Math.random() + \"\", timeout: 3000, text: \"Your game was saved\"}});\r\n                this.onToast(\"Your game was saved\")\r\n                return true;\r\n            },\r\n            e => {\r\n                log(`saveGame failed`, e);\r\n                //this.onError(`failed to saveGame, attempt ${attempts}: ${e.message}`);\r\n                this.saveGame(gameState, caller, attempts + 1);\r\n                return `failed to saveGame, attempt ${attempts}`;\r\n            },this.onError)\r\n        }\r\n    }\r\n    onToast(message){\r\n        this.setState({toasttool: {id: Math.random() + \"\", timeout: 3000, text: message}});\r\n    }\r\n    onBack(){\r\n        if(this.state.modSettings){\r\n            this.setState({modSettings: false});  //just close the settings box\r\n        }else if(this.state.play || this.state.gameover || this.state.report || this.state.error){ //gameover also returns report to main screen\r\n            \r\n            sendEvent(new Event(gameKeys.acMenu, 'back', this.state.play || this.state.gameover?'game':'report', null));\r\n            this.setState({play:false, form: false, error: false, report: false, newGameSettings: false, modSettings: false});\r\n        }else{\r\n            sendEvent(new Event(gameKeys.acMenu, 'exit', null, null));\r\n           // navigate('/mathgames/');\r\n            navigate(getParentUrl(getUrl(), 1));\r\n        }\r\n    }\r\n    showReport(answers){\r\n        sendEvent(new Event(gameKeys.acMenu, 'report', null, null));\r\n        let a = answers || this.state.answers;\r\n        //save answers to storage\r\n         console.log(`store item encrypt this.props.meta`, this.props.meta);\r\n         storeItem(getReportKey(this.props.meta.import), answers, getEncKey(this.props.meta.import));\r\n         navigate(getUrl() + \"/report\");\r\n        //navigate to game report page\r\n    }\r\n    showCredits(answers){\r\n        sendEvent(new Event(gameKeys.acMenu, 'credits', null, null));\r\n        let a = answers || this.state.answers;\r\n        this.setState({credits: true, report: false, answers: a, form: false});\r\n    }\r\n\r\n    showModal(modalConents){\r\n        this.setState({showModal: modalConents})\r\n    }\r\n    closeModal(){\r\n        this.setState({showModal:null});\r\n    }\r\n    renderScene(){\r\n        if(this.state.error){\r\n            return <motion.div id=\"view-form\" key=\"view-form\" speed=\"page\" className=\"item-fill scroll-please\"\r\n               {...GAME_LAYOUT_ANIM}\r\n                >\r\n               <Text id=\"main-error\"  tag=\"h2\" fontSize=\"remM\" color=\"red\" \r\n                     className=\"text-center\" >\r\n                         {this.state.error}\r\n                     </Text>\r\n            </motion.div>\r\n        }\r\n        else if(this.state.credits){\r\n            return <motion.div id=\"view-credits\" key=\"view-credits\" speed=\"page\" className=\"item-fill scroll-please text-center\"\r\n                {...GAME_LAYOUT_ANIM}\r\n                >            \r\n                    <Credits credits={this.props.meta.credits}/>\r\n                    <Button onInput={()=>{this.showReport(this.state.answers)}} compact>Next</Button>\r\n                </motion.div>\r\n        }\r\n        else if(this.state.report){\r\n            return <motion.div id=\"view-results\" key=\"view-results\" speed=\"page\" className=\"item-fill scroll-please\" \r\n                    //{...animations[animKeys.ANIM_LAYOUT_OVERLAP_EBE]}\r\n                    {...GAME_LAYOUT_ANIM}\r\n                    >\r\n                    <h1 style={{color: 'cyan'}}>Sorry your browser lacks the storage facilities necessary to display the report page</h1>\r\n                </motion.div>\r\n        }\r\n        else if(this.state.play){\r\n            return <motion.div id=\"view-play\" key=\"view-play\" speed=\"page\" className=\"item-fill\" \r\n               {...GAME_LAYOUT_ANIM}\r\n                >\r\n                <Layout\r\n                    onGameOver={this.showCredits} \r\n                    onSave={this.saveGame}\r\n                    game={this.props.game} \r\n                    meta={this.props.meta}\r\n                    gameState={this.state.gameState}\r\n                    setMenuItem={this.setMenuItem} \r\n                    //onBack={this.onBack} \r\n                    examMode={this.state.examMode}\r\n                    onError={this.onError} \r\n                    images={this.props.images}\r\n                    />\r\n            </motion.div>\r\n        }else{\r\n            return <motion.div id=\"view-menu\" key=\"view-menu\" className=\"scroll-please text-center\" speed=\"page\"  \r\n                {...GAME_LAYOUT_ANIM}\r\n                >\r\n                    <Intro {...this.props} \r\n                    onPlay={this.onPlay} \r\n                    showReport={this.showReport} \r\n                    onError={this.onError} \r\n                    showCredits={this.showCredits} \r\n                    showModal={this.showModal}\r\n                    closeModal={this.closeModal}\r\n                    gameState={this.state.gameState}\r\n                    images={this.props.images}\r\n                    onToast={this.onToast}\r\n                    onSignIn={this.onSignIn}\r\n                    //signInProps={this.state.signInProps}\r\n                    {...this.state.signInProps}\r\n                    />\r\n            </motion.div>\r\n        }\r\n    }\r\n\r\n    renderContent(){\r\n        return <Content>\r\n            \r\n            <AnimatePresence exitBeforeEnter>\r\n            {this.renderScene()}\r\n            </AnimatePresence>\r\n        </Content>\r\n    }\r\n    renderLinks(){\r\n        log(`renderLinks url ${getUrl()}`);\r\n        //to ensure is preloaded, so can play offline if accessed once\r\n        return <div>\r\n            <Link to={`${getUrl()}/report`} />\r\n        </div>\r\n    }\r\n\r\n    getLogo(){\r\n        let img;\r\n        if(this.props.meta && this.props.meta.descriptions){\r\n            this.props.meta.descriptions.map(e => {\r\n                if(!img && e.img){\r\n                    img = e.img.childImageSharp.fixed.src;\r\n                }\r\n            })\r\n        }\r\n        if(!img)  img = this.props.logo;\r\n        return img;\r\n    }\r\n    render(){ \r\n        log(`Main game page props`, this.props)\r\n        return(\r\n            <div style={{height:'100%', width:'100%'}} >\r\n                <Helmet>\r\n                    <link rel=\"stylesheet\"  href=\"https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/katex.min.css\" async defer/>\r\n                    <script className='structured-data-list' type=\"application/ld+json\">{getStructuredData({\r\n                        date:  this.props.meta.date,\r\n                        name:  this.props.meta.title,\r\n                        description:  this.props.meta.snippet,\r\n                        headline:  this.props.meta.snippet,\r\n                        keywords: this.props.meta.topics.join(', '),\r\n                        url: getUrl(),\r\n                        logoWidth: '512',\r\n                        logoHeight: '512',\r\n                        logo: this.getLogo()\r\n                    })}</script>\r\n                </Helmet>   \r\n                \r\n                {this.renderLinks()}\r\n                {this.renderContent()}\r\n                {/* <NerdView /> */}\r\n                <ToastToolUI {...this.state.toasttool} />\r\n                <Modal active={this.state.showModal} onClose={this.closeModal}>{this.state.showModal}</Modal>\r\n        \r\n            </div>\r\n        )\r\n    }\r\n}\r\n\r\n\r\n export default Subscribable(MainPage);\r\n\r\nconst Content = styled(motion.div)`\r\n    height:100%;\r\n`\r\n\r\n\r\n","import React, {useEffect, useState} from 'react';\r\nimport styled from 'styled-components';\r\nimport {motion} from 'framer-motion';\r\nimport {log} from 'utilities/Measure';\r\n\r\nconst animations = {\r\n    bounce: {\r\n        translateY:['0%', '-5%', '0%', '-5%', '0%', '-5%', '0%'], \r\n        transition: { yoyo: 3, repeatDelay:4, duration: 2, delay: 1,  ease: \"anticipate\" }\r\n    },\r\n    shake: {\r\n        translateX:['0%', '-2%', '2%', '-2%', '2%', '-2%', '0%'], \r\n        transition: { yoyo: 3, repeatDelay:4, duration: 0.5, delay: 1,  ease: \"easeInOut\" }\r\n    },\r\n    tremble: {\r\n        translateX:['0%', '-2%', '2%', '-2%', '2%', '-2%', '0%'], \r\n        transition: { yoyo: 3, repeatDelay:0.5, duration: 0.3, delay: 1,  ease: \"easeInOut\" }\r\n    },\r\n    iBg: {opacity:0.2, width: '100%', height:'100%'}, \r\n    aBg: {opacity:1, width: '100%', height:'100%'}, \r\n    eBg: {opacity:0.2, width: '100%', height:'100%'}, \r\n    aC: {left: '50%', x: '-50%', opacity: 1, y: '5vh',\r\n        transition: {duration: 0.5, delay:0}},\r\n    iCC: {scaleX: 1, left: '50%', x: '-50%', y: '5vh', opacity: 1},\r\n    iCL: {scaleX: 1, left: '-50%', x: '-50%', y: '5vh', opacity: 1},\r\n    iCR: {scaleX: 1, left: '150%', x: '-50%', y: '5vh', opacity: 1},\r\n    tC: {duration: 5, delay:2.2},\r\n    prevC: {scaleX: 1, y: '-10vh', opacity: 0.7, transition: {duration: 0.3, delay: 0.2}},\r\n    eC: {y: '-200px', opacity: 0, transition: {duration: 0.3}},\r\n    mirror: {scaleX: -1},\r\n    reverseMirror: {scaleX: 1},\r\n    iM: {opacity: 0, left: '50%', x: '-50%', y: '10vh', transition: {duration: 0.5, delay: 0.5}, scale:1},\r\n    aM: {opacity: 1, left: '50%', x: '-50%', y: '0vh', scale:0.7},\r\n    eM: {opacity: 0, left: '50%', x: '-50%', y: '-10vh', transition: {duration: 0.8, delay: 0}, scale:0.7},\r\n    cM: {opacity: 1, left: '50%', x: '-50%', y: '-15vh', transition: {duration: 0.8, delay: 0}, scale:1},\r\n\r\n    iL: {opacity: 0.2, left: '-50%', x: '0%', scaleX: -1},\r\n    eL: {opacity: 0.2, left: '-50%', x: '0%', scaleX: -1},\r\n    aL: {opacity: 1, left: '10px', x: '0%',  scaleX: -1},\r\n    pL: {opacity: 0.8, left: '-30px', x: '0%',  scaleX: -1},\r\n    //to move entire image inside parent, -100% of its x width,\r\n    iR: {opacity: 0.2, left: '150%', x:'-100%', scaleX: 1},\r\n    eR: {opacity: 0, left: '150%', x:'-100%',  scaleX: 1},\r\n    aR: {opacity: 1,  left: '97%', x:'-100%', scaleX: 1},\r\n    pR: {opacity: 0.8,  left: '103%', x:'-100%', scaleX: 1},\r\n\r\n    visible: {opacity: 1},\r\n    invisible: {opacity: 0},\r\n    exit: {opacity: 0},\r\n    initial: {opacity: 0},\r\n    animate: {opacity: 1},\r\n    initialLeft: {opacity:0, scaleX: -1},\r\n\r\n    transition: {duration: 1, delay:0.8},\r\n    exitTransition: {duration: 0.5, delay:0},\r\n\r\n}\r\n\r\n\r\nconst getAnimations = (key, props) => {\r\n    let sty = {transition: key === 'exit'?animations.exitTransition:animations.transition};\r\n    let states = props[key];\r\n    if(states){\r\n        if(Array.isArray(states)){\r\n            sty = states.reduce((a, e, i) => {\r\n                if(animations[e]){\r\n                    a = {...a, ...animations[e]};\r\n                }else if(e){\r\n                    a = {...a, ...e};\r\n                }\r\n                return a;\r\n            }, sty);\r\n        }else{\r\n           // sty = {...sty, ...animations[states]};\r\n            if(animations[states]){\r\n                sty = {...sty, ...animations[states]};\r\n            }else if(states){\r\n                sty = {...sty, ...states};\r\n            }\r\n        }\r\n    }\r\n    if(props.override) sty = {...sty, ...props.override};\r\n    return sty;\r\n}\r\n\r\nconst StagedView = (props) => {\r\n    return <StagedWrapper key={`staged-${props.id}`} id={`staged-${props.id}`} \r\n                initial={getAnimations(props.initial?'initial':'animate', props)}\r\n                animate={getAnimations('animate', props)}\r\n                exit={getAnimations('exit', props)}\r\n                bottom={props.bottom || (!props.top?'0px':null)}\r\n                top={props.top}\r\n                width={props.width}\r\n                height={props.height}\r\n                bgColor={props.bgColor}\r\n                >\r\n                {props.children}\r\n            </StagedWrapper>;\r\n}\r\n\r\nexport default StagedView;\r\n\r\n\r\nconst StagedWrapper = styled(motion.div)`\r\n    ${props => props.bottom?`bottom: ${props.bottom};`:''}\r\n    ${props => props.top?`top: ${props.top};`:''}\r\n    ${props => props.bgColor?`background-color: ${props.bgColor};`:''}\r\n    position: absolute;\r\n    left: 100px;\r\n    ${props => {\r\n        log(`StagedWrapper props`, props);\r\n        if(props.width){\r\n            return `width: ${props.width};`\r\n        }\r\n    }}\r\n    ${props => {\r\n        if(props.height){\r\n            return `height: ${props.height};`\r\n        }\r\n    }}\r\n`"],"sourceRoot":""}