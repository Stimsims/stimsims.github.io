(window.webpackJsonp=window.webpackJsonp||[]).push([[43],{PKOl:function(e,r,t){t("rzGZ"),t("Dq+y"),t("zGcK"),t("Ml7+"),t("sc67"),t("q8oJ"),t("C9fy"),t("8npG");var i=t("Ffb8");t("QBbR"),t("rsGY"),function(){"use strict";var e=i.getCore(),r=e.PARSER,t=e.Symbol,n=e.Utils.format,a=e.Utils.isVector,s=e.Utils.isArray,o=(e.Vector,e.groups.S),l=(e.groups.EX,e.groups.CP),u=e.groups.CB,c=e.groups.FN;e.Settings.Laplace_integration_depth=40,t.prototype.findFunction=function(e){if(this.group===c&&this.fname===e)return this.clone();var r;if(this.symbols)for(var t in this.symbols)if(r=this.symbols[t].findFunction(e))break;return r};var p=e.Extra={version:"1.4.1",LaPlace:{transform:function(i,a,s){a=a.toString();var l,f=(i=t.unwrapSQRT(i,!0)).stripVar(a),m=i.group;if((i=r.divide(i,f.clone())).isConstant()||!i.contains(a,!0))l=r.parse(n("({0})/({1})",i,s));else if(m===o&&e.Utils.isInt(i.power)){var g=String(i.power);l=r.parse(n("factorial({0})/({1})^({0}+1)",g,s))}else if(i.group===o&&i.power.equals(.5))l=r.parse(n("sqrt(pi)/(2*({0})^(3/2))",s));else if(i.isComposite())l=new t(0),i.each((function(e){l=r.add(l,p.LaPlace.transform(e,a,s))}),!0);else if(!i.isE()||i.power.group!==o&&i.power.group!==u){if(i.group!==c||-1===["sin","cos","sinh","cosh"].indexOf(i.fname)||i.args[0].group!==o&&i.args[0].group!==u){var v=e.Settings.integration_depth<e.Settings.Laplace_integration_depth;if(v){var h=e.Settings.integration_depth;e.Settings.integration_depth=e.Settings.Laplace_integration_depth}e.Utils.block("PARSE2NUMBER",(function(){var n=a,o=i.sub(a,n),u=r.parse("e^(-"+s+"*"+n+")*"+o);(l=e.Calculus.integrate(u,n)).hasIntegral()&&r.error("Unable to compute transform"),l=l.sub(a,0),l=(l=r.expand(r.multiply(l,new t(-1)))).sub(n,a)}),!1),l=e.Utils.block("PARSE2NUMBER",(function(){return r.parse(l)}),!0),v&&(e.Settings.integration_depth=h)}else{d=i.args[0].stripVar(a);switch(i.fname){case"sin":l=r.parse(n("({0})/(({1})^2+({0})^2)",d,s));break;case"cos":l=r.parse(n("({1})/(({1})^2+({0})^2)",d,s));break;case"sinh":l=r.parse(n("({0})/(({1})^2-({0})^2)",d,s));break;case"cosh":l=r.parse(n("({1})/(({1})^2-({0})^2)",d,s))}}}else{var d=i.power.stripVar(a);l=r.parse(n("1/(({1})-({0}))",d,s))}return r.multiply(l,f)},inverse:function(i,a,s){var c=i.clone();return e.Utils.block("POSITIVE_MULTIPLIERS",(function(){if(i.group===o||i.group===u||i.group===l){var p,f,m,g,v,h,d,b,w,y=function(){(g=r.multiply(g,p)).multiplier=g.multiplier.multiply(i.multiplier),g=r.divide(g,v.a)};if(h=i.multiplier.clone(),i.toUnitMultiplier(),p=i.getNum(),(f=i.getDenom().toUnitMultiplier()).group===l?(d=f.power.clone(),f.toLinear()):d=new e.Frac(1),m=a.toString(),v=e.Utils.decompose_fn(f,m,!0),e.Utils.decompose_fn(r.expand(p.clone()),m,!0),p.multiplier=p.multiplier.multiply(h),(f.group===o||f.group===u)&&v.x.value===m&&v.b.equals(0)&&e.Utils.isInt(v.x.power))w=v.x.power-1,b=e.Math2.factorial(w),g=r.divide(r.pow(s,new t(w)),new t(b)),y();else if(f.group===l&&d.equals(1)){if(v.x.isLinear()&&!p.contains(m))console.log(v.a.toString(),v.b.toString()),s=r.divide(s,v.a.clone()),g=r.parse(n("(({0})^({3}-1)*e^(-(({2})*({0}))/({1})))/(({3}-1)!*({1})^({3}))",s,v.a,v.b,d)),y();else if(v.x.group===o&&v.x.power.equals(2))if(p.contains(m)){var S=new t(1);if(p.group===u){var q=new t(1);p.each((function(e){e.contains(m)?q=r.multiply(q,e):S=r.multiply(S,e)})),p=q}var U,x,M,L,N,_,C,E,A,T,k=e.Utils.decompose_fn(p,m,!0);if(U=k.a,x=k.b,M=U.containsFunction("sin"),N=U.containsFunction("cos"),L=x.containsFunction("cos"),_=x.containsFunction("sin"),k.x.value===m&&k.x.isLinear()&&!(M&&L||N||_))g=r.parse(n("(({1})*cos((sqrt(({2})*({3}))*({0}))/({2})))/({2})",s,k.a,v.a,v.b));else if(M&&L)if(C=U.findFunction("sin"),E=x.findFunction("cos"),C.args[0].equals(E.args[0])&&!C.args[0].contains(m))F=r.divide(x,E.toUnitMultiplier()).toString(),A=C.args[0].toString(),I=v.b,T=r.divide(U,C.toUnitMultiplier()),R="(({1})*({2})*cos({3})*sin(sqrt({4})*({0})))/sqrt({4})+({1})*sin({3})*({5})*cos(sqrt({4})*({0}))",g=r.parse(n(R,s,S,F,A,I,T))}else g=r.parse(n("(({1})*sin((sqrt(({2})*({3}))*({0}))/({2})))/sqrt(({2})*({3}))",s,p,v.a,v.b))}else if(v.x.power.num&&v.x.power.num.equals(3)&&v.x.power.den.equals(2)&&p.contains("sqrt(pi)")&&!p.contains(m)&&p.isLinear()){var F=r.divide(p.clone(),r.parse("sqrt(pi)"));g=r.parse(n("(2*({2})*sqrt({0}))/({1})",s,v.a,F,p))}else if(d.equals(2)&&v.x.power.equals(2)){var I,R;if(p.contains(m))if((k=e.Utils.decompose_fn(r.expand(p.clone()),m,!0)).x.isComposite()){var P=[],O=p.collectSymbols((function(r){r=t.unwrapPARENS(r);var i=e.Utils.decompose_fn(r,m,!0);return i.symbol=r,i})).sort((function(e,r){var t;return t=e.x.value!==m?0:e.x.power,(r.x.value!==m?0:r.x.power)-t}));S=new t(-1);for(var D=0;D<O.length;D++){var H=O[D];H.x.value===m?P.push(H):S=r.multiply(S,H.symbol)}P[0].x.power.equals(2)&&P[1].x.power.equals(1)&&P[1].b.equals(0)&&!P[0].b.equals(0)&&(F=P[0].a.negate(),R="-(({1})*({2})*({5})*({0})*sin((sqrt(({4})*({5}))*({0}))/({4})))/(2*({4})^2*sqrt(({4})*({5})))-(({1})*({3})*({0})*sin((sqrt(({4})*({5}))*({0}))/({4})))/(2*({4})*sqrt(({4})*({5})))+(({1})*({2})*cos((sqrt(({4})*({5}))*({0}))/({4})))/({4})^2",g=r.parse(n(R,s,S,F,P[0].b,v.a,v.b)))}else k.x.isLinear()?(S=r.divide(k.a,new t(2)),R="(({1})*({0})*sin((sqrt(({2})*({3}))*({0}))/({2})))/(({2})*sqrt(({2})*({3})))",g=r.parse(n(R,s,S,v.a,v.b))):k.x.power.equals(2)&&(k.b.equals(0)?(S=r.divide(k.a,new t(2)),R="(({1})*sin((sqrt(({2})*({3}))*({0}))/({2})))/(({2})*sqrt(({2})*({3})))+(({1})*({0})*cos((sqrt(({2})*({3}))*({0}))/({2})))/({2})^2",g=r.parse(n(R,s,S,v.a,v.b))):(S=r.divide(k.a,new t(2)),I=k.b.negate(),R="-((({2})*({4})-2*({1})*({3}))*sin((sqrt(({2})*({3}))*({0}))/({2})))/(2*({2})*({3})*sqrt(({2})*({3})))+(({4})*({0})*cos((sqrt(({2})*({3}))*({0}))/({2})))/(2*({2})*({3}))+(({1})*({0})*cos((sqrt(({2})*({3}))*({0}))/({2})))/({2})^2",g=r.parse(n(R,s,S,v.a,v.b,I))));else S=r.divide(p,new t(2)),R="(({1})*sin((sqrt(({2})*({3}))*({0}))/({2})))/(({3})*sqrt(({2})*({3})))-(({1})*({0})*cos((sqrt(({2})*({3}))*({0}))/({2})))/(({2})*({3}))",g=r.parse(n(R,s,S,v.a,v.b))}}return g||(g=r.symfunction("ilt",[c,a,s])),g}),!0)}},Statistics:{frequencyMap:function(e){for(var r={},t=0,i=e.length;t<i;t++){var n=e[t].toString();r[n]||(r[n]=0),r[n]++}return r},sort:function(e){return e.sort((function(e,t){return e.isConstant()&&t.isConstant()||r.error("Unable to sort! All values must be numeric"),e.multiplier.subtract(t.multiplier)}))},count:function(e){return new t(e.length)},sum:function(e,i){for(var n=new t(0),a=0,s=e.length;a<s;a++){var o=e[a].clone();n=i?r.add(r.pow(r.subtract(o,i.clone()),new t(2)),n):r.add(o,n)}return n},mean:function(){var e=[].slice.call(arguments);return a(e[0])?p.Statistics.mean.apply(this,e[0].elements):r.divide(p.Statistics.sum(e),p.Statistics.count(e))},median:function(){var t,i=[].slice.call(arguments);if(a(i[0]))return p.Statistics.median.apply(this,i[0].elements);try{var n=p.Statistics.sort(i),s=i.length;if(e.Utils.even(s)){var o=s/2;t=p.Statistics.mean(n[o-1],n[o])}else t=n[Math.floor(s/2)]}catch(l){t=r.symfunction("median",i)}return t},mode:function(){var t,i=[].slice.call(arguments);if(a(i[0]))return p.Statistics.mode.apply(this,i[0].elements);var n=p.Statistics.frequencyMap(i);if(1===e.Utils.keys(n).length)t=i[0];else{var o={};for(var l in n){var u=n[l];if(u in o){var c=o[u];s(c)?c.push(l):o[u]=[l,o[u]]}else o[u]=l}var f=o[Math.max.apply(null,e.Utils.keys(o))];t=s(f)?r.symfunction("mode",f.sort()):r.parse(f)}return t},gVariance:function(e,t){var i=p.Statistics.mean.apply(p.Statistics,t),n=p.Statistics.sum(t,i);return r.multiply(e,n)},variance:function(){var e=[].slice.call(arguments);if(a(e[0]))return p.Statistics.variance.apply(this,e[0].elements);var i=r.divide(new t(1),p.Statistics.count(e));return p.Statistics.gVariance(i,e)},sampleVariance:function(){var e=[].slice.call(arguments);if(a(e[0]))return p.Statistics.sampleVariance.apply(this,e[0].elements);var i=r.divide(new t(1),r.subtract(p.Statistics.count(e),new t(1)));return p.Statistics.gVariance(i,e)},standardDeviation:function(){var e=[].slice.call(arguments);return a(e[0])?p.Statistics.standardDeviation.apply(this,e[0].elements):r.pow(p.Statistics.variance.apply(p.Statistics,e),new t(.5))},sampleStandardDeviation:function(){var e=[].slice.call(arguments);return a(e[0])?p.Statistics.sampleStandardDeviation.apply(this,e[0].elements):r.pow(p.Statistics.sampleVariance.apply(p.Statistics,e),new t(.5))},zScore:function(e,t,i){return r.divide(r.subtract(e,t),i)}},Units:{table:{foot:"12 inch",meter:"100 cm",decimeter:"10 cm"}}};i.register([{name:"laplace",visible:!0,numargs:3,build:function(){return p.LaPlace.transform}},{name:"ilt",visible:!0,numargs:3,build:function(){return p.LaPlace.inverse}},{name:"mean",visible:!0,numargs:-1,build:function(){return p.Statistics.mean}},{name:"median",visible:!0,numargs:-1,build:function(){return p.Statistics.median}},{name:"mode",visible:!0,numargs:-1,build:function(){return p.Statistics.mode}},{name:"smpvar",visible:!0,numargs:-1,build:function(){return p.Statistics.sampleVariance}},{name:"variance",visible:!0,numargs:-1,build:function(){return p.Statistics.variance}},{name:"smpstdev",visible:!0,numargs:-1,build:function(){return p.Statistics.sampleStandardDeviation}},{name:"stdev",visible:!0,numargs:-1,build:function(){return p.Statistics.standardDeviation}},{name:"zscore",visible:!0,numargs:3,build:function(){return p.Statistics.zScore}}]),i.api()}()},QBbR:function(e,r,t){if(t("rzGZ"),t("Dq+y"),t("zGcK"),t("AqHK"),t("Ml7+"),t("q8oJ"),t("C9fy"),t("8npG"),t("YBKJ"),t("sc67"),void 0===i){var i=t("Ffb8");t("rsGY")}!function(){"use strict";var e=i.getCore(),r=e.PARSER,t=e.Frac,n=e.Settings,a=e.Utils.isSymbol,s=e.groups.FN,o=e.Symbol,l=e.Utils.text,u=e.Utils.inBrackets,c=e.Utils.isInt,p=e.Utils.format,f=e.Utils.even,m=e.Utils.evaluate,g=e.groups.N,v=e.groups.S,h=(s=e.groups.FN,e.groups.PL),d=e.groups.CP,b=e.groups.CB,w=e.groups.EX,y=e.groups.P,S=n.LOG,q="sqrt",U="sin",x="cos",M="tan",L="sec",N="csc",_="cot",C="sinh",E="cosh";function A(e){this.message=e||""}A.prototype=new Error,o.prototype.hasIntegral=function(){return this.containsFunction("integrate")},o.prototype.fnTransform=function(){if(this.group!==s)return this;var e,t=this.args[0],i=new o(this.multiplier),n=this.clone().toUnitMultiplier();if(this.isLinear())switch(this.fname){case C:e=r.parse(p("(e^({0})-e^(-({0})))/2",t));break;case E:e=r.parse(p("(e^({0})+e^(-({0})))/2",t));break;case"tanh":e=r.parse(p("(e^({0})-e^(-({0})))/(e^({0})+e^(-({0})))",t));break;case M:e=r.parse(p("sin({0})/cos({0})",t));break;case N:e=r.parse(p("1/sin({0})",t));break;case L:e=r.parse(p("1/cos({0})",t));break;default:e=n}else if(this.power.equals(2))switch(this.fname){case U:e=r.parse(p("1/2-cos(2*({0}))/2",t));break;case x:e=r.parse(p("1/2+cos(2*({0}))/2",t));break;case M:e=r.parse(p("sin({0})^2/cos({0})^2",t));break;case E:e=r.parse(p("1/2+cosh(2*({0}))/2",t));break;case C:e=r.parse(p("-1/2+cosh(2*({0}))/2",t));break;case"tanh":e=r.parse(p("(1+cosh(2*({0})))/(-1+cosh(2*({0})))",t));break;case L:e=r.parse(p("(1-cos(2*({0})))/(1+cos(2*({0})))+1",t));break;default:e=n}else e=this.fname===L?r.parse(p("1/cos({0})^({1})",this.args[0],this.power)):this.fname===N?r.parse(p("1/sin({0})^({1})",this.args[0],this.power)):this.fname===M?this.power.lessThan(0)?r.parse(p("cos({0})^(-({1}))/sin({0})^({1})",this.args[0],this.power.negate())):r.parse(p("sin({0})^({1})/cos({0})^({1})",this.args[0],this.power)):this.fname===U&&this.power.lessThan(0)?r.parse(p("csc({0})^(-({1}))",this.args[0],this.power.negate())):this.fname===x&&this.power.lessThan(0)?r.parse(p("sec({0})^(-({1}))",this.args[0],this.power.negate())):this.fname===U&&this.power.equals(3)?r.parse(p("(3*sin({0})-sin(3*({0})))/4",this.args[0])):this.fname===x&&this.power.equals(3)?r.parse(p("(cos(3*({0}))+3*cos({0}))/4",this.args[0])):n;return r.multiply(e,i)},o.prototype.hasTrig=function(){if(this.isConstant(!0)||this.group===v)return!1;if(this.fname&&(e.Utils.in_trig(this.fname)||e.Utils.in_inverse_trig(this.fname)))return!0;if(this.symbols)for(var r in this.symbols)if(this.symbols[r].hasTrig())return!0;return!1},e.Expression.prototype.hasIntegral=function(){return this.symbol.hasIntegral()},e.Utils.toCommonDenominator=function(t){if(t.isComposite()&&t.isLinear()){var i=new o(t.multiplier),n=new o(1),a=new o(0);return t.each((function(e){n=r.multiply(n,e.getDenom())}),!0),t.each((function(e){var t=e.getNum(),i=e.getDenom(),s=r.multiply(t,r.divide(n.clone(),i));a=r.add(a,s)})),r.multiply(i,e.Algebra.divide(r.expand(a),r.expand(n)))}return t},e.Utils.in_inverse_trig=function(e){return-1!==["asin","acos","atan","acsc","asec","acot"].indexOf(e)},e.Utils.in_trig=function(e){return-1!==[x,U,M,L,N,_].indexOf(e)},e.Utils.in_htrig=function(e){return-1!==[C,E,"tanh","acsch","asech","acoth"].indexOf(e)};var T=e.Utils.all_functions=function(e){for(var r=0,t=e.length;r<t;r++)if(e[r].group!==s)return!1;return!0},k=e.Utils.cosAsinBtranform=function(e,t){var i,n;return i=e.args[0],n=t.args[0],r.parse(p("(sin(({0})+({1}))-sin(({0})-({1})))/2",i,n))},F=e.Utils.cosAsinAtranform=function(e,t){return 1!==Number(t.power)?r.multiply(e,t):(i=e.args[0],r.parse(p("(sin(2*({0})))/2",i)));var i},I=e.Utils.cosAsinBtranform=function(e,t){var i,n;return i=e.args[0],n=t.args[0],r.parse(p("(cos(({0})+({1}))-cos(({0})-({1})))/2",i,n))},R=e.Utils.trigTransform=function(e){for(var t,i,n={},a=new o(1),l=0,u=e.length;l<u;l++)if((t=e[l]).group===s){var c=t.fname;c===x&&n.sin?(i=n.sin.args[0].toString()!==t.args[0].toString()?k(t,n.sin):F(t,n.sin),delete n.sin,a=r.multiply(a,i)):c===U&&n.cos?(i=n.cos.args[0].toString()!==t.args[0].toString()?k(t,n.cos):F(t,n.cos),delete n.cos,a=r.multiply(a,i)):c===U&&n.sin?(n.sin.args[0].toString()!==t.args[0].toString()?(i=I(t,n.sin),delete n.sin):(i=r.multiply(t,n.sin),delete n.sin),a=i):n[c]=t}else a=r.multiply(a,t);for(var p in n)a=r.multiply(a,n[p]);return a};e.Settings.integration_depth=10,e.Settings.max_lim_depth=10;var P=e.Calculus={version:"1.4.6",sum:function(t,i,n,a){if(i.group!==e.groups.S)throw new e.exceptions.NerdamerTypeError("Index must be symbol. "+l(i)+" provided");var s;if(i=i.value,e.Utils.isNumericSymbol(n)&&e.Utils.isNumericSymbol(a)){var u=a-n<200?"":"PARSE2NUMBER";n=Number(n),a=Number(a),s=e.Utils.block(u,(function(){for(var s=t.text(),l={"~":!0},u=new e.Symbol(0),c=n;c<=a;c++){l[i]=new o(c);var p=r.parse(s,l);u=r.add(u,p)}return u}))}else s=r.symfunction("sum",arguments);return s},product:function(t,i,n,a){if(i.group!==e.groups.S)throw new e.exceptions.NerdamerTypeError("Index must be symbol. "+l(i)+" provided");var s;if(i=i.value,e.Utils.isNumericSymbol(n)&&e.Utils.isNumericSymbol(a)){var u=a-n<200?"":"PARSE2NUMBER";s=e.Utils.block(u,(function(){n=Number(n),a=Number(a.multiplier);for(var s=t.text(),l={},u=new e.Symbol(1),c=n;c<=a;c++)l[i]=new o(c),u=r.multiply(u,r.parse(s,l));return u}))}else s=r.symfunction("product",arguments);return s},diff:function(i,c,p){if(e.Utils.isVector(i)){var f=new e.Vector([]);return i.each((function(e){f.elements.push(P.diff(e,c,p))})),f}if(e.Utils.isMatrix(i)){var m=new e.Matrix;return i.each((function(e,r,t){m.set(r,t,P.diff(e,c,p))})),m}var C=a(c)?c.text():c;if(p=a(p)?p.multiplier:p||1,void 0===C&&(C=e.Utils.variables(i)[0]),i.group===s&&i.fname===q){var E=i.args[0],A=i.power.clone();E.group===g&&E.group===y||(E.power=a(E.power)?r.multiply(E.power,r.multiply(new o(.5)),A):E.power.multiply(new t(.5)).multiply(A),E.multiplier=E.multiplier.multiply(i.multiplier)),i=E}if(i.group!==s||a(i.power))i=I(i);else{var T=I(r.parse(i)),k=P.diff(i.args[0].clone(),C);i=r.multiply(T,k)}return p>1&&(p--,i=P.diff(i,c,p)),i;function F(e){return(e.value===C||e.contains(C,!0))&&(e.multiplier=e.multiplier.multiply(e.power),e.power=e.power.subtract(new t(1)),e.power.equals(0)&&(e=o(e.multiplier))),e}function I(e){var i,p,f=e.group;if(f===g||f===v&&e.value!==C||f===y)e=o(0);else if(f===v)e=F(e);else{if(f===b){var m=e.multiplier.clone();e.toUnitMultiplier();var q=r.multiply(function(e){for(var t=e.collectSymbols(),i=new o(0),n=t.length,a=0;a<n;a++){for(var s=P.diff(t[a].clone(),C),l=0;l<n;l++)a!==l&&(s=r.multiply(s,t[l].clone()));i=r.add(i,s)}return i}(e),F(e));return q.multiplier=q.multiplier.multiply(m),q}if(f===s&&e.power.equals(1))switch(e.fname){case S:p=e.clone(),(e=e.args[0].clone()).power=e.power.negate(),e.multiplier=p.multiplier.divide(e.multiplier);break;case x:e.fname=U,e.multiplier.negate();break;case U:e.fname=x;break;case M:e.fname=L,e.power=new t(2);break;case L:e=R(e,M);break;case N:e=R(e,"-cot");break;case _:e.fname=N,e.multiplier.negate(),e.power=new t(2);break;case"asin":e=r.parse("(sqrt(1-("+l(e.args[0])+")^2))^(-1)");break;case"acos":e=r.parse("-(sqrt(1-("+l(e.args[0])+")^2))^(-1)");break;case"atan":e=r.parse("(1+("+l(e.args[0])+")^2)^(-1)");break;case"abs":m=e.multiplier.clone(),e.toUnitMultiplier(),(i=e.args[0].clone()).toUnitMultiplier(),(e=r.parse(u(l(e.args[0]))+"/abs"+u(l(i)))).multiplier=m;break;case"parens":e=o(1);break;case"cosh":e.fname="sinh";break;case"sinh":e.fname="cosh";break;case"tanh":e.fname="sech",e.power=new t(2);break;case"sech":e=R(e,"-tanh");break;case"csch":var E=String(e.args[0]);return r.parse("-coth("+E+")*csch("+E+")");case"coth":E=String(e.args[0]);return r.parse("-csch("+E+")^2");case"asinh":e=r.parse("(sqrt(1+("+l(e.args[0])+")^2))^(-1)");break;case"acosh":e=r.parse("(sqrt(-1+("+l(e.args[0])+")^2))^(-1)");break;case"atanh":e=r.parse("(1-("+l(e.args[0])+")^2)^(-1)");break;case"asech":E=String(e.args[0]);e=r.parse("-1/(sqrt(1/("+E+")^2-1)*("+E+")^2)");break;case"acoth":e=r.parse("-1/(("+e.args[0]+")^2-1)");break;case"acsch":E=String(e.args[0]);e=r.parse("-1/(sqrt(1/("+E+")^2+1)*("+E+")^2)");break;case"asec":E=String(e.args[0]);e=r.parse("1/(sqrt(1-1/("+E+")^2)*("+E+")^2)");break;case"acsc":E=String(e.args[0]);e=r.parse("-1/(sqrt(1-1/("+E+")^2)*("+E+")^2)");break;case"acot":e=r.parse("-1/(("+e.args[0]+")^2+1)");break;case"S":E=String(e.args[0]);e=r.parse("sin((pi*("+E+")^2)/2)");break;case"C":E=String(e.args[0]);e=r.parse("cos((pi*("+E+")^2)/2)");break;case"Si":E=e.args[0];e=r.parse("sin("+E+")/("+E+")");break;case"Shi":E=e.args[0];e=r.parse("sinh("+E+")/("+E+")");break;case"Ci":E=e.args[0];e=r.parse("cos("+E+")/("+E+")");break;case"Chi":E=e.args[0];e=r.parse("cosh("+E+")/("+E+")");break;case"Ei":E=e.args[0];e=r.parse("e^("+E+")/("+E+")");break;case"Li":E=e.args[0];e=r.parse("1/"+n.LOG+"("+E+")");break;case"erf":e=r.parse("(2*e^(-("+e.args[0]+")^2))/sqrt(pi)");break;case"atan2":var A=String(e.args[0]),T=String(e.args[1]);e=r.parse("("+T+")/(("+T+")^2+("+A+")^2)");break;case"sign":e=new o(0);break;case n.LOG10:e=r.parse("1/(("+e.args[0]+")*"+n.LOG+"(10))");break;default:e=r.symfunction("diff",[e,c])}else if(f===w||f===s&&a(e.power)){var k;k=f===w?e.value:f===s&&e.contains(C)?e.fname+u(l(e.args[0])):e.value+u(l(e.args[0])),r.multiply(r.parse(S+u(k)),e.power.clone()),i=P.diff(r.multiply(r.parse(S+u(k)),e.power.clone()),C),e=r.multiply(e,i)}else if(f!==s||e.power.equals(1)){if(f===d||f===h){var O=new o(0);for(var D in e.symbols)O=r.add(O,P.diff(e.symbols[D].clone(),C));e=r.multiply(F(e.clone()),O)}}else(i=e.clone()).toLinear(),i.toUnitMultiplier(),e=r.multiply(F(e.clone()),I(i))}return e.updateHash(),e}function R(e,t,i){return r.multiply(e,r.parse(t+u(i||l(e.args[0]))))}},integration:{u_substitution:function(t,i){function n(e,t,n){var a=P.diff(t,i),s=n?n(e,t):r.divide(e.clone(),a);return s.contains(i,!0)?null:s}function a(e,t){var i=P.integrate(r.symfunction(e,[new o(m)]),m,0);return(i=i.sub(new o(m),t)).updateHash(),i}var l,u=t[0].clone(),c=t[1].clone(),p=u.group,f=c.group,m="__u__";if(p===s&&f!==s){if(l=n(c,(g=u.args[0]).clone()))return r.multiply(l,a(u.fname,g));if(l=n(c,u))return P.integration.poly_integrate(u)}else if(f===s&&p!==s){var g;if(l=n(u,(g=c.args[0]).clone()))return r.multiply(l,a(c.fname,g))}else if(p===s&&f===s){if(l=n(u.clone(),c.clone()))return r.multiply(P.integration.poly_integrate(c),l);if(l=n(c.clone(),u.clone()))return r.multiply(P.integration.poly_integrate(c),l)}else{if(p===w&&f!==w){if(!(l=n(c,(q=u.power).clone()))){var v=P.integration.decompose_arg(q.clone(),i),h=P.diff(v[2].clone(),i),d=P.integration.decompose_arg(h.clone(),i);if(r.multiply(v[1],d[1]).power.equals(c.power)){var b=r.divide(v[0].clone(),d[0].clone()),y=r.multiply(b.clone(),r.pow(new o(u.value),r.multiply(v[0],new o(m))));return y=r.multiply(y,new o(m)),P.integration.by_parts(y,m,0,{}).sub(m,v[1].clone())}}var S=P.integrate(u.sub(q.clone(),new o(m)),m,0);return r.multiply(S.sub(new o(m),q),l)}if(f===w&&p!==w){var q;l=n(u,(q=c.power).clone());S=P.integrate(c.sub(q,new o(m)),m,0);return r.multiply(S.sub(new o(m),q),l)}if(u.isComposite()||c.isComposite()){var U=function(t,n){var a=P.diff(n,i),s=e.Algebra.Factor.factor(t),o=e.Algebra.Factor.factor(a);return r.divide(s,o)},x=u.isComposite()?u.clone().toLinear():u.clone(),M=c.isComposite()?c.clone().toLinear():c.clone();if(l=n(x.clone(),M.clone(),U))return r.multiply(P.integration.poly_integrate(c),l);if(l=n(M.clone(),x.clone(),U))return r.multiply(P.integration.poly_integrate(u),l)}}},poly_integrate:function(e){var t=e.power.toString(),i=e.multiplier.toDecimal(),n=e.toUnitMultiplier().toLinear();return-1===Number(t)?r.multiply(new o(i),r.symfunction(S,[n])):r.parse(p("({0})*({1})^(({2})+1)/(({2})+1)",i,n,t))},stop:function(r){throw r=r||"Unable to compute integral!",e.Utils.warn(r),new A(r)},partial_fraction:function(t,i,n,s){var l,u;return a(i)||(i=r.parse(i)),l=new o(0),(u=e.Algebra.PartFrac.partfrac(t,i)).group===b&&u.isLinear()?(u.each((function(e){e.isLinear()||P.integration.stop()})),u.each((function(e){l=r.add(l,P.integrate(e,i,n,s))}))):l=r.add(l,P.integrate(u,i,n,s)),l},get_udv:function(t){var i=[[],[],[],[],[]],n=function(r){var t=r.group;if(t===s){var n=r.fname;e.Utils.in_trig(n)||e.Utils.in_htrig(n)?i[3].push(r):e.Utils.in_inverse_trig(n)?i[1].push(r):n===S?i[0].push(r):P.integration.stop()}else t===v||r.isComposite()&&r.isLinear()||t===b&&r.isLinear()?i[2].push(r):t===w||r.isComposite()&&!r.isLinear()?i[4].push(r):P.integration.stop()};t.group===b?t.each((function(e){n(o.unwrapSQRT(e,!0))})):n(t);for(var a,l=new o(1),u=0;u<5;u++){var c,p=i[u],f=p.length;if(f>0){if(f>1){c=new o(1);for(var m=0;m<f;m++)c=r.multiply(c,p[m].clone())}else c=p[0].clone();a?l=r.multiply(l,c):(a=c).multiplier=a.multiplier.multiply(t.multiplier)}}return[a,l]},trig_sub:function(t,i,n,a,s,o){(s=s||P.integration.decompose_arg(t.clone().toLinear(),i))[3],s[2];var l=s[0],c=s[1];if(c.power.equals(2)&&l.greaterThan(0)){var p=e.Utils.getU(t),f=r.parse(M+u(p)),m=r.parse(L+u(p)+"^2"),g=r.multiply(t.sub(c,f),m),v=P.integrate(g,p,n,a).sub(f,c);return e.Utils.clearU(f),v}},by_parts:function(t,i,n,a){var s,l,u,c,p,f,m,g,v,h,d,b;if(a.previous=a.previous||[],l=(s=P.integration.get_udv(t))[0],u=s[1],d=(c=o.unwrapSQRT(r.expand(P.diff(l.clone(),i)),!0)).clone().stripVar(i),c=r.divide(c,d.clone()),p=P.integrate(u.clone(),i,n||0),b=(f=r.multiply(p.clone(),c)).toString(),-1!==a.previous.indexOf(b)&&e.Utils.in_trig(l.fname)&&u.isE())return a.is_cyclic=!0,new o(1);if(a.previous.push(b),m=r.multiply(l,p),h=f.multiplier.clone(),f.toUnitMultiplier(),(v=r.multiply(P.integrate(f.clone(),i,n,a),d)).multiplier=v.multiplier.multiply(h),g=r.subtract(m,v),a.is_cyclic&&(a.previous.pop(),0===a.previous.length)){g=r.expand(g);var w=new o(0);g.each((function(e){e.contains(i)||(w=r.add(w,e.clone()))})),g=r.divide(r.subtract(g,w.clone()),r.subtract(new o(1),w))}return g},decompose_arg:e.Utils.decompose_fn},integrate:function(i,l,m,g){if(!l){var y=e.Utils.variables(i);1===y.length&&(l=y[0]),l=l||"x"}if(e.Utils.isVector(i)){var k=new e.Vector([]);return i.each((function(e){k.elements.push(P.integrate(e,l))})),k}return isNaN(l)||r.error("variable expected but received "+l),i.isConstant(!0)?r.multiply(i.clone(),r.parse(l)):(g=g||{},e.Utils.block("PARSE2NUMBER",(function(){m=m||0;var y,k=a(l)?l.toString():l,F=o.unwrapSQRT(i.clone(),!0),I=F.group;try{if(++m>e.Settings.integration_depth&&P.integration.stop("Maximum depth reached. Exiting!"),F.contains(k,!0)){if(I===v)y=P.integration.poly_integrate(F,k,m);else if(I===w)if(F.previousGroup===s&&"sqrt"!==F.fname&&F.fname!==n.PARENTHESIS&&P.integration.stop(),F.contains(k)&&F.previousGroup!==s){if(F.power.contains(k))P.integration.stop();else(Ie=P.diff(F.clone().toLinear(),k)).contains(k)&&P.integration.stop(),y=P.integration.poly_integrate(F,k,m)}else{if((Q=P.diff(F.power.clone(),k)).contains(k)){var O=Q.stripVar(k);if((Z=r.divide(Q.clone(),O.clone())).group===v&&Z.isLinear())return O.multiplier=O.multiplier.divide(new t(2)),r.parse(p("({2})*(sqrt(pi)*erf(sqrt(-{0})*{1}))/(2*sqrt(-{0}))",O,k,F.multiplier));P.integration.stop()}if(F.isE())Q.isLinear()?y=F:Q.isE()&&Q.power.group===v&&Q.power.power.equals(1)?y=r.multiply(r.symfunction("Ei",[F.power.clone()]),F.power):P.integration.stop();else{var D=r.symfunction(S,[r.parse(F.value)]);y=r.divide(F,D)}y=r.divide(y,Q)}else if(F.isComposite()&&F.isLinear()){var H=r.parse(F.multiplier);F.toUnitMultiplier(),y=new o(0),F.each((function(e){y=r.add(y,P.integrate(e,k,m))})),y=r.multiply(H,y)}else if(I===d)if(F.power.greaterThan(1)&&(F=r.expand(F)),F.power.equals(1))y=new o(0),F.each((function(e){y=r.add(y,P.integrate(e,k,m))}),!0);else{var V=Number(F.power);H=F.multiplier.clone();F.toUnitMultiplier();var G=F.clone().toLinear(),B=(yr=P.integration.decompose_arg(G,k))[3],z=yr[2],Q=yr[0],Z=yr[1];if(-1===V&&Z.group!==h&&Z.power.equals(2)){var j=!c(B)||B>0;if(Z.group===v&&Z.power.equals(2)&&j){var Y=function(e){var t=new o(1);return e.each((function(e){t=r.multiply(t,"abs"===e.fname?e.args[0]:e)})),t},J=Q.clone(),X=B.clone();J=r.pow(J,new o(.5)),X=r.pow(X,new o(.5));D=r.multiply(Y(X),Y(J));var K=r.symfunction("atan",[r.divide(r.multiply(Q,Z.toLinear()),D.clone())]);y=r.divide(K,D)}else if(Z.group===v&&Z.isLinear())y=r.divide(P.integration.poly_integrate(F),Q);else if(Z.power.equals(4)){var W,$,ee,re,te,ie,ne=u;J=r.parse(q+ne(Q)+"*"+k+"^2"),X=r.parse(q+ne(2)+"*"+ne(Q)+"^"+ne("1/4")+"*"+ne(B)+"^"+ne("1/4")+"*"+k),W=r.parse(q+ne(B)),de=r.add(r.add(J.clone(),X.clone()),W.clone()),He=r.add(r.subtract(J,X),W),$=r.parse(q+ne(2)+"*"+ne(B)+"^"+ne("3/4")),ee=r.parse(q+ne(B)+"*"+ne(B)+"^"+ne("1/4")+"*"+k),re=r.parse("2*"+ne(B)+"*"+q+ne(2)+"*"+ne(B)+"^"+ne("1/4")),te=r.divide(r.subtract($.clone(),ee.clone()),r.multiply(re.clone(),He)),ie=r.divide(r.add($,ee),r.multiply(re,de.clone())),y=r.add(P.integrate(te,k,m,g),P.integrate(ie,k,m,g))}else y=P.integration.partial_fraction(F,k,m)}else if(-.5===V)if(Z.group===v&&Z.power.equals(2))if(z.multiplier.lessThan(0)&&!B.multiplier.lessThan(0))if(Q.negate(),B.isConstant()&&Q.isConstant()){D=r.symfunction(q,[Q.clone()]);var ae=r.symfunction(q,[r.multiply(Q.clone(),B)]);y=r.divide(r.symfunction("asin",[r.divide(z.toLinear(),ae)]),D)}else{var se=r.symfunction(q,[Q]),oe=r.multiply(se.clone(),Z.clone().toLinear());y=r.divide(r.symfunction("atan",[r.divide(oe,r.symfunction(q,[G.clone()]))]),se)}else P.integration.stop();else P.integration.stop();else if(Z.isLinear()&&Z.group!==h)y=r.divide(P.integration.poly_integrate(F),Q);else{if(Z.power.equals(2)&&Q.greaterThan(0)){var le,ue,ce,pe,fe,me;le=r.parse(q+u(Q)),ue=r.parse(q+u(B)),ce=r.multiply(le.clone(),ue.clone()).invert(),pe=r.pow(B,new o(F.power)),me=e.Utils.getU(F),qe=r.multiply(ce,Z.clone().toLinear()),fe=r.parse("atan"+u(qe));var ge=2*(Math.abs(F.power)-1),ve=P.integrate(r.parse(x+u(me)+"^"+ge));return e.Utils.clearU(me),r.multiply(ve.sub(me,fe),pe)}if(F.group===b||F.power.lessThan(0)){K=F.clone().toLinear();var he=e.Algebra.Factor.factor(K).toString()!==K.toString();if(e.Algebra.degree(K,r.parse(k)).equals(2)&&!he)try{var de,be,we;we=e.Algebra.sqComplete(K,k),qe=e.Utils.getU(K),de=we.f.sub(we.a,qe),be=r.pow(de,r.parse(F.power)),y=P.integrate(be,qe).sub(qe,we.a)}catch(Dr){P.integration.stop()}else y=P.integration.partial_fraction(F,k,m,g)}else y=P.integration.by_parts(F,k,m,g)}y.multiplier=y.multiplier.multiply(H)}else if(I===s){var ye=F.args[0];H=F.multiplier.clone();F.toUnitMultiplier();Q=(yr=P.integration.decompose_arg(ye,k))[0],Z=yr[1];var Se=F.fname;if(Se===S||"asin"===Se||"acos"===Se||"atan"===Se&&Z.isLinear()){V=F.power.toString();if(c(V)&&(m-=V),ye.isComposite()){var qe=e.Utils.getU(F),Ue=(K=r.pow(r.parse(S+u(qe)),new o(V)),P.diff(ye,k)),xe=r.multiply(K,Ue);ve=P.integrate(xe,qe,m,g);y=r.multiply(r.parse(H),ve.sub(qe,ye))}else y=r.multiply(r.parse(H),P.integration.by_parts(F,k,m,g))}else{if(Se===M&&F.power.lessThan(0))return(Er=F.clone()).power.negate(),Er.fname=_,r.multiply(r.parse(H),P.integrate(Er,k,m));if(!Q.contains(k,!0)&&F.isLinear())if("abs"===Se){if((Z=r.divide(ye.clone(),Q.clone())).group!==v||Z.power.lessThan(0))P.integration.stop();else if(e.Utils.even(Z.power))y=P.integrate(ye,k,m);else{var Me=P.integrate(Z,k,m);Me.power=Me.power.subtract(new t(1)),y=r.multiply(r.multiply(r.symfunction("abs",[Z.toLinear()]),Me),Q)}}else{var Le=F.args[0].group,Ne=P.integration.decompose_arg(ye,k);switch((Le!==d&&Le!==v&&Le!==b||!Ne[1].power.equals(1)||ye.hasFunc())&&P.integration.stop(),Se){case x:y=r.symfunction(U,[ye]);break;case U:(y=r.symfunction(x,[ye])).negate();break;case M:y=r.parse(p(n.LOG+"(sec({0}))",ye));break;case L:y=r.parse(p(n.LOG+"(tan({0})+sec({0}))",ye));break;case N:y=r.parse(p("-"+n.LOG+"(csc({0})+cot({0}))",ye));break;case _:y=r.parse(p(n.LOG+"(sin({0}))",ye));break;case C:y=r.symfunction(E,[ye]);break;case E:y=r.symfunction(C,[ye]);break;case"tanh":y=r.parse(p(n.LOG+"(cosh({0}))",ye));break;case"asec":case"acsc":case"acot":case"asech":case"acsch":case"acoth":y=P.integration.by_parts(F,k,m,g);break;case"sech":y=r.parse(p("atan(sinh({0}))",ye));break;case"csch":y=r.parse(p(n.LOG+"(tanh(({0})/2))",ye));break;case"coth":y=r.parse(p(n.LOG+"(sinh({0}))",ye));break;case"exp":y=P.integrate(r.parse(p("e^({0})",ye)),k,m);break;case"S":ye=F.args[0].clone();var _e=(Lr=P.integration.decompose_arg(ye,k))[1],Ce=Lr[0],Ee=Lr[3];y=r.parse(p("(cos((1/2)*pi*(({1})+({0})*({2}))^2)+pi*(({1})+({0})*({2}))*S(({1})+({0})*({2})))/(({0})*pi)",Ce,Ee,Z));break;case"C":ye=F.args[0].clone(),_e=(Lr=P.integration.decompose_arg(ye,k))[1],Ce=Lr[0],Ee=Lr[3];y=r.parse(p("(pi*(({1})+({0})*({2}))*C(({1})+({0})*({2}))-sin((1/2)*pi*(({1})+({0})*({2}))^2))/(({0})*pi)",Ce,Ee,_e));break;case"erf":ye=F.args[0].clone(),_e=(Lr=P.integration.decompose_arg(ye,k))[1],Ce=Lr[0];y=r.parse(p("e^(-(({2}))^2)/(({0})*sqrt(pi))+(1/({0})+({1}))*erf(({2}))",Ce,_e,ye));break;case"sign":y=r.multiply(F.clone(),ye.clone());break;default:P.integration.stop()}y=r.divide(y,Q)}else if(Z.isLinear()){if(Se===x||Se===U)if((V=Number(F.power))<0)F.fname=Se===U?N:L,F.invert().updateHash(),y=P.integrate(F,k,m);else{ye=F.args[0];var Ae=F.clone(),Te=F.clone(),ke=new o((V-1)/V),Fe=r.multiply(Q.clone(),new o(V)).invert();Ae.power=Ae.power.subtract(new t(1)),Te.power=Te.power.subtract(new t(2));var Ie=r.symfunction(Se===x?U:x,[ye.clone()]);Se===U&&Ie.negate(),y=r.add(r.multiply(r.multiply(Fe,Ae),Ie),r.multiply(ke,P.integrate(r.parse(Te),k,m)))}else if(Se===M||Se===_){if(F.args[0].isLinear(k)){ge=F.power.subtract(new t(1)).toString();var Re=F.clone().toUnitMultiplier(),Pe=r.parse(p((Se===_?"-":"")+"1/({2}*{0})*{3}({1})^({0})",ge,ye,Q,Se));Re.power=Re.power.subtract(new t(2)),Re.power.equals(0)&&(Re=r.parse(Re)),y=r.subtract(Pe,P.integrate(Re,k,m))}}else if(Se===L||Se===N){var Oe=F.power.subtract(new t(1)).toString(),De=F.power.subtract(new t(2)).toString(),He=Se===L?M:_,Ve=(Re=F.clone().toUnitMultiplier(),p((Se===N?"-":"")+"1/({0}*{1})*{4}({3})^({2})*{5}({3})",Q,Oe,De,ye,Se,He));Pe=r.parse(Ve);Re.power=Re.power.subtract(new t(2)),Re.power.equals(0)&&(Re=r.parse(Re)),y=r.add(Pe,r.multiply(new o(De/Oe),P.integrate(Re,k,m)))}else Se!==E&&Se!==C||!F.power.equals(2)?P.integration.stop():y=P.integrate(F.fnTransform(),k,m)}else P.integration.stop();y.multiplier=y.multiplier.multiply(H)}}else if(I===h)y=P.integration.partial_fraction(F,k,m);else if(I===b){F.getDenom().group===v&&(F=r.expand(F));var Ge=F.stripVar(k),Be=r.divide(F.clone(),Ge.clone());if(Ge.contains(k)&&(Be=r.multiply(Be,Ge),Ge=new o(1)),Be.group!==b){if(Be.equals(1))return P.integrate(r.expand(F),k,m);Be.clone().toLinear().isPoly(!0)&&e.Utils.variables(Be).length>1&&(Be=e.Algebra.Factor.factor(Be)),y=P.integrate(Be,k,m)}else{var ze=Be.collectSymbols().sort((function(e,r){return e.group===r.group?Number(e.power)===Number(r.power)?e<r?1:-1:r.power-e.power:r.group-e.group})).map((function(e){var t=o.unwrapSQRT(e,!0);return"exp"===t.fname?r.parse(p("({1})*e^({0})",t.args[0],t.multiplier)):t})),Qe=ze.length;if(F.power<0){if(2===Qe)return P.integrate(r.expand(F),k,m,g)}else if(2===Qe){try{y=P.integration.u_substitution(ze,k)}catch(Dr){}if(!y){var Ze=ze[0].group,je=ze[1].group,Ye=ze[0],Je=ze[1],Xe=Ye.fname,Ke=Je.fname;if(F=r.multiply(Ye.clone(),Je.clone()),Ze===s&&je===s)if(Xe===S||Ke===S)y=P.integration.by_parts(F.clone(),k,m,g);else{ze.sort((function(e,r){return r.fname>e.fname}));var We=Ye.args[0];(!We.isLinear()||We.group!==d&&We.group!==b&&We.group!==v)&&P.integration.stop(),Z=(yr=P.integration.decompose_arg(We,k))[1],Q=yr[0],Z.isLinear()||P.integration.stop();var $e=Je.args[0];if(We.equals($e))if(Xe===U&&Ke===x||Xe===x&&Ke===U)if(Ye.power.lessThan(0)&&P.integration.stop(),Xe===U&&Ye.power.add(Je.power).equals(0))Ye.fname=M,Ye.updateHash(),y=P.integrate(Ye,k,m);else if(f(Ye.power)&&Ke===x&&Je.power.lessThan(0)){ge=Number(Ye.power)/2;var er=r.parse(p("(1-cos({0})^2)^({1})",Ye.args[0],ge));y=P.integrate(r.expand(r.multiply(er,Je.clone())),k,m,g)}else if(f(Ye.power)&&Ke===U&&Je.power.lessThan(0)){ge=Number(Ye.power)/2,er=r.parse(p("(1-sin({0})^2)^({1})",Ye.args[0],ge));y=P.integrate(r.expand(r.multiply(er,Je.clone())),k,m,g)}else{var rr=e.Utils.even(Ye.power),tr=e.Utils.even(Je.power);if(y=new o(0),rr&&tr){var ir=function(e){var t,i=e.power/2;return t=e.fname===x?"((1/2)+(cos(2*("+e.args[0]+"))/2))^"+i:"((1/2)-(cos(2*("+e.args[0]+"))/2))^"+i,r.parse(t)};Q=ir(Ye),B=ir(Je),Ie=r.multiply(Q,B);return(Er=r.expand(Ie)).each((function(e){y=r.add(y,P.integrate(e,k,m))})),r.multiply(y,Ge)}rr?(qe=Ye,Re=Je):(qe=Je,Re=Ye);var nr=qe.fname===x?-1:1,ar=((ge=Re.power)-1)/2,sr=r.parse("(1-"+qe.fname+e.Utils.inBrackets(We)+"^2)^"+ar);(Er=r.expand(r.multiply(new o(nr),r.multiply(qe.clone(),sr)))).each((function(e){y=r.add(y,P.integration.poly_integrate(e.clone()))}))}else if(Xe===L&&Ke===M&&Z.isLinear()&&Je.isLinear())y=r.parse(p("sec({0})^({1})/({1})",Ye.args[0],Ye.power));else if(Xe===M&&Ke===L&&Z.isLinear())if(Ye.isLinear()&&Je.isLinear())y=r.divide(r.symfunction(L,[We.clone()]),Q);else if(f(Ye.power)){V=Number(Ye.power)/2,Ie=r.parse(p("(sec({0})^2-1)^({1})",Ye.args[0],V));y=P.integrate(r.expand(r.multiply(Ie,Je)),k,m)}else P.integration.stop();else if(Xe===L&&Ke===x)Ye.fname=x,Ye.invert().updateHash(),y=P.integrate(r.multiply(Ye,Je),k,m);else if(Xe===U&&Ke===N)Je.fname=U,Je.invert().updateHash(),y=P.integrate(r.multiply(Ye,Je),k,m);else if(Xe!==M||Ke!==x&&Ke!==U||!Je.power.lessThan(0)){Ie=r.multiply(Ye.fnTransform(),Je.fnTransform());y=P.integrate(r.expand(Ie),k,m)}else{var Ie=r.multiply(Ye.fnTransform(),Je);y=P.integrate(r.expand(Ie),k,m)}else if(Xe!==U&&Xe!==x||Ke!==U&&Ke!==x)P.integration.stop();else{var or=R(ze);y=P.integrate(r.expand(or),k,m)}}else if(Ze===s&&je===v){var lr=Ye.isLinear();if(Ye.fname===x&&lr&&Je.power.equals(-1))y=r.symfunction("Ci",[Ye.args[0]]);else if(Ye.fname===x&&Je.power.equals(-1))y=P.integrate(r.multiply(Ye.fnTransform(),Je.clone()),k,m);else if(Ye.fname===E&&lr&&Je.power.equals(-1))y=r.symfunction("Chi",[Ye.args[0]]);else if(Ye.fname===E&&Je.power.equals(-1))y=P.integrate(r.multiply(Ye.fnTransform(),Je.clone()),k,m);else if(Ye.fname===U&&lr&&Je.power.equals(-1))y=r.symfunction("Si",[Ye.args[0]]);else if(Ye.fname===U&&Je.power.equals(-1))y=P.integrate(r.multiply(Ye.fnTransform(),Je.clone()),k,m);else if(Ye.fname===C&&lr&&Je.power.equals(-1))y=r.symfunction("Shi",[Ye.args[0]]);else if(Ye.fname===C&&Je.power.equals(-1))y=P.integrate(r.multiply(Ye.fnTransform(),Je.clone()),k,m);else if(Ye.fname===S&&Je.power.equals(-1))y=P.integration.poly_integrate(Ye,k,m);else if("erf"===Ye.fname){if(Je.power.equals(1)){Ce=(Lr=P.integration.decompose_arg(Ye.args[0],k))[0],_e=Lr[1],ye=Ye.args[0].toString();y=r.parse(p("(e^(-(({2}))^2)*(sqrt(pi)*e^((({2}))^2)*(2*({0})^2*({1})^2-3)*erf(({2}))+2*({0})*({1})-2))/(4*sqrt(pi)*({0})^2)",Ce,_e,ye))}}else y=P.integration.by_parts(F,k,m,g)}else if(Ze===w&&je===v){Z=Xe===S?P.integration.decompose_arg(Ye.args[0],k)[1]:null;y=Ye.isE()&&(Ye.power.group===v||Ye.power.group===b)&&Je.power.equals(-1)?r.symfunction("Ei",[Ye.power.clone()]):Xe===S&&Z.value===Je.value?P.integration.poly_integrate(Ye,k,m):P.integration.by_parts(F,k,m,g)}else if(Ze===h&&je===v){if(Je.value===Ye.value&&Ye.power.equals(-1)){var ur=Math.min.apply(null,e.Utils.keys(Ye.symbols)),cr=Math.min(ur,Je.power),pr=Je.clone();pr.power=new t(cr),Je=r.divide(Je,pr.clone());Ie=new o(0);Ye.each((function(e){Ie=r.add(Ie,r.divide(e.clone(),pr.clone()))})),Ie.multiplier=Ye.multiplier,F=r.divide(Je,Ie)}else F=r.expand(F);y=P.integration.partial_fraction(F,k,m)}else if(Ze===d&&je===v){K=Ye.clone().toLinear();var fr=e.Algebra.degree(K,r.parse(k)).equals(1);if(Ye.power.equals(-.5)){Q=(yr=P.integration.decompose_arg(Ye.clone().toLinear(),k))[0].negate(),Z=yr[1],B=yr[3];var mr=Number(Ye.power),gr=Number(Je.power);if(c(gr)&&e.Utils.even(gr)&&Z.power.equals(2)){var vr=r.divide(r.multiply(r.pow(B.clone(),new o(2)),r.symfunction(q,[r.divide(B.clone(),Q.clone())])),r.pow(Q.clone(),new o(2)));vr=r.multiply(vr,r.symfunction(q,[B]).invert());var hr=r.parse("sin(u)");hr.power=hr.power.multiply(Je.power);ve=P.integrate(hr,"u",m);var dr=r.parse("asin(sqrt("+Q+"/"+B+")*"+k+")");y=r.multiply(vr,ve.sub(new o("u"),dr))}else if(-.5===mr){var br=function(e,t){var i=r.parse(P.integrate(e,k,m,g).sub(k,p(t,k)));if(!i.hasIntegral())return i};-1===gr?y=br(r.expand(r.expand(r.pow(r.multiply(Ye.invert(),Je.invert()),new o(2)))).invert(),"sqrt(1-1/({0})^2)"):-2===gr&&(y=br(r.sqrt(r.expand(r.divide(r.pow(F,new o(2)).invert(),r.pow(new o(k),new o(2))).negate())).invert(),"sqrt(1-1/({0})^2)"))}}else if(Ye.power.equals(-1)&&Je.isLinear()&&fr)y=P.integration.partial_fraction(F,k,m);else if(!Ye.power.lessThan(0)&&c(Ye.power)){var wr=r.expand(Ye);y=new o(0),wr.each((function(e){e.group===h?e.each((function(e){y=r.add(y,P.integrate(r.multiply(Je.clone(),e),k,m))})):y=r.add(y,P.integrate(r.multiply(Je.clone(),e),k,m))}))}else if(Ye.power.lessThan(-2))y=P.integration.by_parts(F,k,m,g);else if(Ye.power.lessThan(0)&&Je.power.greaterThan(1)){var yr;Q=(yr=P.integration.decompose_arg(Ye.clone().toLinear(),k))[0].negate(),Z=yr[1],B=yr[3],G=Ye.clone().toLinear();if(Z.group!==h&&Z.isLinear()){V=Number(Je.power),qe=new o(Ue="_u_");var Sr=r.expand(r.divide(r.pow(r.subtract(qe.clone(),B.clone()),new o(V)),qe.clone())),qr={};qr[Ue]=G;var Ur=r.parse(Sr,qr);y=P.integrate(Ur,k,0)}else if(Je.power.greaterThan(Z.power)||Je.power.equals(Z.power)){var xr=new e.Algebra.Classes.Factors;Ye=e.Algebra.Factor.coeffFactor(Ye.invert(),xr);var Mr=e.Algebra.divide(Je,Ye);Mr.group!==b?(y=new o(0),Mr.each((function(e){y=r.add(y,P.integrate(e,k,m))})),xr.each((function(e){y=r.divide(y,e)})),y=r.expand(y)):y=P.integration.by_parts(F,k,m,g)}else y=P.integration.partial_fraction(F,k,m)}else if(Ye.power.den.equals(2)){var Lr;Q=(Lr=P.integration.decompose_arg(Ye.clone().toLinear(),k))[3],Z=Lr[1],B=Lr[0],Lr[2];if(Z.power.equals(2)&&B.lessThan(0)){Q.equals(1)||(Ge=r.multiply(Ge,r.pow(Q,new o(2))));qe=k,vr=r.divide(r.pow(B.clone().negate(),new o(.5)),r.pow(Q,new o(.5))),Ue=r.symfunction(x,[new o(qe)]);var Nr=r.pow(r.symfunction(x,[new o(qe)]),new o(Ye.power.num)),_r=r.pow(r.symfunction(U,[new o(qe)]),new o(Je.power)),Cr=r.multiply(r.multiply(Nr,Ue),_r);ve=P.integrate(Cr,qe,m);y=ve.sub(qe,r.symfunction("asin",[r.multiply(new o(k),vr)]))}else y=P.integration.partial_fraction(F,k,m,g)}else fr&&(y=P.integration.partial_fraction(F,k,m))}else if(Ye.isComposite()&&Je.isComposite())if(y=new o(0),Ye.power.greaterThan(0)&&Je.power.greaterThan(0)){var Er;(Er=r.expand(F)).each((function(e){y=r.add(y,P.integrate(e,k,m))}),!0)}else{mr=Number(Ye.power),gr=Number(Je.power);if(mr<0&&gr>0){Ie=Ye;Ye=Je,Je=Ie}-1===mr&&-1===gr?y=P.integration.partial_fraction(F,k):Ye.each((function(e){var t=r.multiply(e,Je.clone()),i=P.integrate(t,k,m);y=r.add(y,i)}))}else if(Ze===d&&ze[0].power.greaterThan(0))Ye=r.expand(Ye),y=new o(0),Ye.each((function(e){y=r.add(y,P.integrate(r.multiply(e,Je.clone()),k,m))}),!0);else if(Ze===s&&je===w&&e.Utils.in_htrig(Ye.fname))Ye=Ye.fnTransform(),y=P.integrate(r.expand(r.multiply(Ye,Je)),k,m);else if(Ze===s&&je===d||je===s&&Ze===d){if(je===s&&Ze===d){Ie=Ye;Ye=Je,Je=Ie}var Ar,Tr,kr;if(Ue=o.unwrapSQRT(P.diff(Ye.clone(),k),!0),Ar=o.unwrapSQRT(Je,!0),Ue.power.equals(Ar.power)){if(V=new o(Je.power),Tr=Ue.clone().toLinear(),kr=Je.clone().toLinear(),(ke=e.Algebra.divide(Tr.toLinear(),kr)).isConstant()){var Fr=r.pow(ke,V.negate());y=r.multiply(Fr,P.integration.poly_integrate(Ye.clone()))}}else y=P.integration.by_parts(F,k,m,g)}else{var Ir=Ye.clone().toLinear(),Rr=Je.clone().toLinear();y=Ze===w&&je===w&&Ye.power.contains(k)&&Je.power.contains(k)&&!Ir.contains(k)&&!Rr.contains(k)?r.parse(p("(({0})^(({2})*({4}))*({1})^(({3})*({4})))/(log(({0})^({2}))+log(({1})^({3})))",Ir.toString(),Rr.toString(),Ye.power.multiplier.toString(),Je.power.multiplier.toString(),k)):P.integration.by_parts(F,k,m,g)}}}else if(3===Qe&&(ze[2].group===v&&ze[2].power.lessThan(2)||ze[0].group===d)){var Pr=ze[0];if(Pr.group===d){Pr.power.greaterThan(1)&&(Pr=r.expand(Pr));Re=r.multiply(ze[1],ze[2]);y=new o(0),Pr.each((function(e){var t=r.multiply(e,Re.clone()),i=P.integrate(t,k,m);y=r.add(y,i)}),!0)}else y=P.integration.by_parts(F,k,m,g)}else if(T(ze)){Ie=new o(1);var Or=0;for(Qe=ze.length;Or<Qe;Or++)Ie=r.multiply(Ie,ze[Or].fnTransform());Ie=r.expand(Ie),y=P.integrate(Ie,k,m)}else{or=R(ze);y=P.integrate(r.expand(or),k,m)}}y=r.multiply(y,Ge)}}else y=r.multiply(F.clone(),r.parse(k));if(y)return y}catch(Hr){if(!(Hr instanceof A||Hr instanceof e.exceptions.DivisionByZero))throw Hr}return r.symfunction("integrate",[i,l])}),!1))},defint:function(t,i,n,a){a=a||"x";var s,l,u=function(e,t,i){try{return r.parse(e,t)}catch(n){return P.Limit.limit(e,a,i)}},c=e.Utils.variables(t),p=t.hasTrig();if(1===c.length&&(a=c[0]),p||(l=P.integrate(t,a)),p||l.hasIntegral())if(1===c.length&&i.isConstant()&&n.isConstant()){var f=e.Utils.build(t);s=new o(e.Math2.num_integrate(f,Number(i),Number(n)))}else s=r.symfunction("defint",[t,i,n,a]);else{var m,g,v={},h={};v[a]=n,h[a]=i,m=u(l,v,n),g=u(l,h,i),s=r.subtract(m,g)}return s},Limit:{interval:function(e,t){return r.parse(p("[{0}, {1}]",e,t))},diverges:function(){return P.Limit.interval("-Infinity","Infinity")},divide:function(t,i,a,s,l){if(!(l++>n.max_lim_depth)){var u=t.clone(),c=i.clone();if("abs"===i.fname){var p=t.sign(),f=s.sign();if(s.isInfinity)return r.multiply(new o(p),new o(f));if(s.equals(0)){var g=r.parse(t.multiplier),v=r.parse(i.multiplier);return r.divide(r.multiply(g,P.Limit.interval("-1","1")),v)}P.Limit.diverges()}var h,d=function(r){if(e.Utils.isVector(r)){for(var t=0;t<r.elements.length;t++)if(!r.elements[t].isInfinity)return!1;return!0}return r.isInfinity},b=function(r,t){return!e.Utils.isVector(r)&&r.equals(t)};do{var w=m(P.Limit.limit(t,a,s,l)),y=m(P.Limit.limit(i,a,s,l)),S=d(w)&&d(y)||b(w,0)&&b(y,0);if(S){var q=P.diff(u.clone(),a),U=P.diff(c.clone(),a),x=r.expand(r.divide(q,U));t=x.getNum(),i=x.getDenom()}}while(S);var M=y.equals(0),L=Number(c.power);return w.isConstant(!0)&&M&&e.Utils.isInt(L)?e.Utils.even(L)?(h=e.Symbol.infinity(),w.lessThan(0)&&h.negate()):h=P.Limit.diverges():h=M?P.Limit.diverges():r.divide(w,y),h}},rewriteToLog:function(e){var t=e.power.clone();return e.toLinear(),r.pow(new o("e"),r.multiply(t,r.symfunction(n.LOG+"",[e])))},getSubbed:function(e,r,t){var i;e.group===w&&(e=P.rewriteToLog(e));try{i=e.sub(r,t)}catch(n){i=e}return i},isInterval:function(r){return e.Utils.isVector(r)},isConvergent:function(e){return!(P.Limit.isInterval(e)&&e.elements[0].isInfinity&&e.elements[1].isInfinity||e.containsFunction("limit"))},limit:function(t,i,a,l){if(t=e.Algebra.Simplify.simplify(t),l=l||1,!(l++>n.max_lim_depth)){var u=r.parse(t.multiplier);t.toUnitMultiplier();try{var c;if(t.isConstant(!0))c=t;else{var f={};f[i]=a;try{var g=r.parse(t.sub(i,a),f);(g.isConstant(!0)||g.isInfinity)&&(c=g)}catch(K){}if(!c){var h=t.getNum(),d=t.getDenom();if(d.isConstant(!0)){if(t.group===w){var y=t.clone().toLinear(),q=(t.power.clone(),y.getNum()),L=y.getDenom(),N=e.Utils.decompose_fn(L,i,!0);if(q.group===v&&q.multiplier.isOne()&&N.ax.group===v&&N.b.isConstant(!0)&&N.a.isOne()&&N.b.isConstant(!0))c=r.parse(p("(1/e^({0}))",N.b));else{var _=P.Limit.rewriteToLog(t.clone()),C=_.power.clone(),E=_.clone().toLinear(),A=P.Limit.limit(E,i,a,l),T=P.Limit.limit(C,i,a,l);c=r.pow(A,T)}}else if(t.group===s&&1===t.args.length){var k,F=P.Limit.limit(t.args[0],i,a,l);if(e.Utils.isVector(F))return c=F.map((function(e){return t.clone().args[0]=e,P.Limit.limit(r.symfunction(t.fname,[e]),i,a,l)})),r.multiply(u,c);if(F.isConstant(!0)){var I=r.symfunction(t.fname,[F]);try{m(I),k=!0}catch(K){k=!1}}if(k)c=I;else if(P.Limit.isConvergent(F))if(t.fname===S)switch(F.toString()){case"0":c=o.infinity().negate();break;case"Infinity":case"-Infinity":c=o.infinity()}else if(t.fname!==x&&t.fname!==U||!a.isInfinity){if(t.fname===M){var R=t.args[0],O=R.getNum(),D=R.getDenom(),H=O.toUnitMultiplier();(a.isInfinity||H.equals("pi")&&D.equals(2))&&(c=divergent())}else if(t.fname===n.FACTORIAL&&F.isInfinity)return o.infinity()}else c=P.Limit.interval(-1,1)}else if(t.group===v){if(t.power>0)return r.parse(t,f);c=e.Utils.even(t.power)?o.infinity():P.Limit.diverges()}else if(t.group===b)if(t.group!==b)c=P.Limit.limit(t,i,a,l);else{var V,G;y=(Q=t.collectSymbols().sort((function(e,r){return e.group-r.group}))).pop();for(V=m(P.Limit.limit(y,i,a,l));Q.length;){var B=Q.pop();G=m(P.Limit.limit(B,i,a,l)),V.isInfinity||!P.Limit.isConvergent(V)&&G.equals(0)||V.equals(0)&&P.Limit.isConvergent(G)?(B.containsFunction(S)&&(B=[y,y=B][0]),B.invert(),V=P.Limit.divide(y,B,i,a,l)):(V=r.multiply(V,G),y=r.multiply(y,B))}c=V}else if(t.isComposite()){var z;t.isLinear()||(t=r.expand(t)),c=new o(0);for(var Q=t.collectSymbols().sort((function(e,r){return r.group-e.group})),Z=[],j=new o(0),Y=0,J=Q.length;Y<J;Y++){(X=Q[Y].clone()).group===s||X.group===b&&X.hasFunc()?j=r.add(j,X):Z.push(X)}Z.unshift(j),1!==Z.length&&(Q=Z);for(Y=0,J=Q.length;Y<J;Y++){var X=Q[Y];try{z=P.Limit.limit(X,i,a,l)}catch(K){z=P.Limit.diverges()}try{c=r.add(c,z)}catch(K){if(l++>n.max_lim_depth)return;c=P.Limit.limit(P.diff(t,i),i,a,l)}}}}else c=P.Limit.divide(h,d,i,a,l)}}c||(c=r.symfunction("limit",[t,i,a]))}catch(K){c=r.symfunction("limit",[t,i,a])}return r.multiply(u,c)}}},Fresnel:{S:function(e){return e.isConstant(!0)?P.defint(r.parse("sin(pi*x^2/2)"),o(0),e,"x"):r.symfunction("S",arguments)},C:function(e){return e.isConstant(!0)?P.defint(r.parse("cos(pi*x^2/2)"),o(0),e,"x"):r.symfunction("C",arguments)}}};i.register([{name:"diff",visible:!0,numargs:[1,3],build:function(){return P.diff}},{name:"sum",visible:!0,numargs:4,build:function(){return P.sum}},{name:"product",visible:!0,numargs:4,build:function(){return P.product}},{name:"integrate",visible:!0,numargs:[1,2],build:function(){return P.integrate}},{name:"defint",visible:!0,numargs:[3,4],build:function(){return P.defint}},{name:"S",visible:!0,numargs:1,build:function(){return P.Fresnel.S}},{name:"C",visible:!0,numargs:1,build:function(){return P.Fresnel.C}},{name:"limit",visible:!0,numargs:[3,4],build:function(){return P.Limit.limit}}]),i.api()}()},YGv4:function(e,r,t){t("rzGZ"),t("Dq+y"),t("OeI1"),t("sC2a"),t("zGcK"),t("HQhv"),t("JHok"),t("AqHK"),t("Ml7+"),t("q8oJ"),t("C9fy"),t("8npG"),t("YBKJ"),t("DCNC");var i=t("Ffb8");t("QBbR"),t("rsGY"),function(){var e=i.getCore(),r=e.PARSER,t=e.Algebra,a=e.Calculus,s=a.integration.decompose_arg,o=e.Utils.evaluate,l=e.Utils.remove,u=e.Utils.format,c=e.Utils.build,p=e.Symbol,f=e.Utils.isSymbol,m=e.Utils.variables,g=e.groups.S,v=e.groups.PL,h=e.groups.CB,d=e.groups.CP,b=e.groups.FN,w=e.Settings,y=e.Utils.range,S=e.Utils.isArray;function q(r,t){if(t.isConstant()&&r.isConstant()&&!r.equals(t)||r.equals(e.Settings.IMAGINARY)||t.equals(e.Settings.IMAGINARY))throw new e.exceptions.NerdamerValueError(r.toString()+" does not equal "+t.toString());this.LHS=r,this.RHS=t}e.Settings.SOLVE_RADIUS=1e3,e.Settings.ROOTS_PER_SIDE=10,e.Settings.make_pi_conversions=!0,e.Settings.STEP_SIZE=.1,e.Settings.MAX_NEWTON_ITERATIONS=200,e.Settings.MAX_NON_LINEAR_TRIES=12,e.Settings.NON_LINEAR_JUMP_AT=50,e.Settings.NON_LINEAR_JUMP_SIZE=100,e.Settings.NON_LINEAR_START=.01,e.Settings.NEWTON_SLICES=200,e.Settings.NEWTON_EPSILON=2*Number.EPSILON,e.Settings.SOLUTION_PROXIMITY=1e-14,e.Settings.FILTER_SOLUTIONS=!0,e.Settings.MAX_SOLVE_DEPTH=10,e.Symbol.prototype.hasTrig=function(){return this.containsFunction(["cos","sin","tan","cot","csc","sec"])},e.Symbol.prototype.hasNegativeTerms=function(){if(this.isComposite())for(var e in this.symbols){var r=this.symbols[e];if(r.group===v&&r.hasNegativeTerms()||this.symbols[e].power.lessThan(0))return!0}return!1},q.prototype={toString:function(){return this.LHS.toString()+"="+this.RHS.toString()},text:function(e){return this.LHS.text(e)+"="+this.RHS.text(e)},toLHS:function(e){var t;t=(e=void 0===e)?this.removeDenom():this.clone();var i=r.subtract(t.LHS,t.RHS);return e?r.expand(i):i},removeDenom:function(){var e=this.LHS.clone(),t=this.RHS.clone(),i=r.multiply(e.getDenom(),t.getDenom());if(e=r.expand(r.multiply(e,i.clone())),(t=r.expand(r.multiply(t,i))).group===d&&t.group!==d){var n=e;e=t,t=n}if(e.group===h){n=new p(e.multiplier);var a=t.clone();e.each((function(e){e.power.lessThan(0)?a=r.divide(a,e):n=r.multiply(n,e)})),e=n,t=a}else if(e.group===d)for(var s in e.symbols){var o=e.symbols[s];if(o.group===h)for(var l in o.symbols){var u=o.symbols[l];if(u.power.lessThan(0))return new q(r.expand(r.multiply(u.clone().toLinear(),e)),r.expand(r.multiply(u.clone().toLinear(),t)))}}return new q(e,t)},clone:function(){return new q(this.LHS.clone(),this.RHS.clone())},sub:function(e,r){var t=this.clone();return t.LHS=t.LHS.sub(e.clone(),r.clone()),t.RHS=t.RHS.sub(e.clone(),r.clone()),t},isZero:function(){return e.Utils.evaluate(this.toLHS()).equals(0)},latex:function(e){return[this.LHS.latex(e),this.RHS.latex(e)].join("=")}},r.equals=function(e,r){return new q(e,r)},e.Expression.prototype.equals=function(r){return r instanceof e.Expression&&(r=r.symbol),new q(this.symbol,r)},e.Expression.prototype.solveFor=function(r){var t;if(this.symbol instanceof q){if(this.symbol.LHS.isConstant()&&this.symbol.RHS.equals(r))return new e.Expression(this.symbol.LHS);if(this.symbol.RHS.isConstant()&&this.symbol.LHS.equals(r))return new e.Expression(this.symbol.RHS);t=this.symbol.toLHS()}else t=this.symbol;return L(t,r).map((function(r){return new e.Expression(r)}))},e.Expression.prototype.expand=function(){if(this.symbol instanceof q){var t=this.symbol.clone();return t.RHS=r.expand(t.RHS),t.LHS=r.expand(t.LHS),new e.Expression(t)}return new e.Expression(r.expand(this.symbol))},e.Expression.prototype.variables=function(){return this.symbol instanceof q?e.Utils.arrayUnique(m(this.symbol.LHS).concat(m(this.symbol.RHS))):m(this.symbol)},e.Matrix.jacobian=function(r,t){var i=new e.Matrix;return t||(t=M.getSystemVariables(r)),t.forEach((function(t,n){r.forEach((function(r,a){var s=e.Calculus.diff(r.clone(),t);i.set(a,n,s)}))})),i},e.Matrix.prototype.max=function(){var e=new p(0);return this.each((function(r){var t=r.abs();t.gt(e)&&(e=t)})),e},e.Matrix.cMatrix=function(t,i){var n=new e.Matrix;return i.forEach((function(e,i){n.set(i,0,r.parse(t))})),n};var U=function(e,t){return r.equals(e,t)};e.Equation=q;var x=e.Utils.checkAll=function(e,r){for(var t=0;t<e.length;t++)if(r(e[t]))return!1;return!0},M=e.Solve={version:"2.0.3",solutions:[],solve:function(r,t){var i=L(r,String(t));return new e.Vector(i)},toLHS:function(e,t){if(f(e))return e;if(!(e instanceof q)){var i=e.split("=");i[1]=i[1]||"0",e=new q(r.parse(i[0]),r.parse(i[1]))}return e.toLHS(t)},getSystemVariables:function(r){vars=m(r[0],null,null,!0);for(var t=1,i=r.length;t<i;t++)vars=vars.concat(m(r[t]));return vars=e.Utils.arrayUnique(vars).sort(),vars},solveNonLinearSystem:function(t,i,a){if(i<0)return[];a=void 0===a?e.Settings.NON_LINEAR_START:a;var s=e.Settings.MAX_NON_LINEAR_TRIES,o=Math.floor(s/2);i=void 0===i?s:i;var l,u,p,f,m,g,v,h,d=e.Settings.NON_LINEAR_JUMP_AT,b=e.Settings.NON_LINEAR_JUMP_SIZE,w=!0,y=function(e,r){return e.map((function(e,t){return Number(r.get(t,0))}))},S=M.getSystemVariables(t),q=e.Matrix.jacobian(t,S,(function(e){return c(e,S)}),!0),U=e.Settings.MAX_NEWTON_ITERATIONS,x=t.map((function(e){return c(e,S)})),L=q.map((function(e){return c(e,S)}),!0);f=e.Matrix.cMatrix(0,S);var N=e.Matrix.cMatrix(a,S);p=0;do{if(p>U)break;l=y(S,N),v=N.clone(),x.forEach((function(e,r){N.set(r,0,e.apply(null,l))}));var _=new e.Matrix;if(L.each((function(e,r,t){var i=e.apply(null,l);_.set(r,t,i)})),_=_.invert(),h=(u=r.multiply(_,N).negate()).subtract(f,(function(e){return r.parse(Number(e))})),f=v.add(u,(function(e){return r.parse(Number(e))})),N=f,p>=d&&m>1){i===o&&(a=0);var C=i>o?1:-1;return n=i%Math.floor(o)+1,a+=C*n*b,M.solveNonLinearSystem(t,--i,a)}if(g=m,p++,m=h.max(),Number(m)===Number(g))break}while(Number(m)>=Number.EPSILON);return w?M.systemSolutions(N,S,!0,(function(r){return e.Utils.round(Number(r),14)})):[]},systemSolutions:function(t,i,n,a){var s=e.Settings.SOLUTIONS_AS_OBJECT?{}:[];return t.each((function(t,o){var l=(n?r.expand(t):t).valueOf();a&&(l=a.call(t,l));var u=i[o];e.Settings.SOLUTIONS_AS_OBJECT?s[u]=l:s.push([u,l])})),s},solveSystem:function(n,a){for(var o=0;o<n.length;o++)n[o]=M.toLHS(n[o]);var u,c=n.length,f=new e.Matrix,m=new e.Matrix,g=!1;if(void 0===a){if(!t.allLinear(n))return M.solveNonLinearSystem(n);u=M.getSystemVariables(n);for(o=0;o<u.length;o++)i.setVar(u[o],"delete");for(o=0;o<c;o++){for(var v=n[o],h=0;h<c;h++){var d=u[h],b=[];v.each((function(e){e.contains(d)&&(b=b.concat(e.coeffs()))}));var w=e.Utils.arraySum(b);f.set(o,h,w)}var y=v.clone();u.map((function(e){y=y.stripVar(e,!0)})),m.set(o,0,y.negate())}}else for(u=a,g=!0,o=0;o<c;o++){m.set(o,0,new p(0));for(v=r.expand(n[o]).collectSymbols(),h=0;h<a.length;h++){f.set(o,h,new p(0));d=a[h];for(var S=0;S<v.length;S++){for(var q=v[S],U=!1,x=0;x<a.length;x++)q.contains(a[x])&&(U&&e.err("Multiple variables found for term "+q),U=!0);if(q.contains(d)){var L=s(l(v,S),d);f.set(o,h,r.add(f.get(o,h),L[0]))}}}for(S=0;S<v.length;S++)m.set(o,0,r.add(m.get(o,0),v[S]))}if(f.determinant().equals(0))throw new e.exceptions.SolveError("System does not have a distinct solution");var N=(f=f.invert()).multiply(m);return e.Utils.isArray(a)&&N.each((function(e){return e.negate()})),M.systemSolutions(N,u,g)},quad:function(e,t,i){var n=r.subtract(r.pow(t.clone(),p(2)),r.multiply(r.multiply(i.clone(),e.clone()),p(4))),a=r.pow(n,p(.5));return[r.parse(r.divide(r.add(t.clone().negate(),a.clone()),r.multiply(new p(2),i.clone()))),r.parse(r.divide(r.subtract(t.clone().negate(),a.clone()),r.multiply(new p(2),i.clone())))]},cubic:function(t,i,n,a){var s=a.text(),o=n.text(),l=i.text(),c=t.text(),p=r.parse(u("({1})^2-3*({0})*({2})",s,o,l)),f=r.parse(u("((2*({1})^3-9*({0})*({1})*({2})+27*({0})^2*({3}))^2-4*(({1})^2-3*({0})*({2}))^3)^(1/2)",s,o,l,c)),g=r.parse(u("((1/2)*(({4})+2*({1})^3-9*({0})*({1})*({2})+27*({0})^2*({3})))^(1/3)",s,o,l,c,f)),v={};m(g).map((function(e){v[e]=1}));var h=e.Utils.block("PARSE2NUMBER",(function(){return r.parse(g,v)}));return 0===Number(p)&&0===Number(h)&&(g=r.parse(u("((1/2)*(-({4})+2*({1})^3-9*({0})*({1})*({2})+27*({0})^2*({3})))^(1/3)",s,o,l,c,f))),["-(b/(3*a))-C/(3*a)-(((b^2-3*a*c))/(3*a*C))","-(b/(3*a))+(C*(1+i*sqrt(3)))/(6*a)+((1-i*sqrt(3))*(b^2-3*a*c))/(6*a*C)".replace(/i/g,e.Settings.IMAGINARY),"-(b/(3*a))+(C*(1-i*sqrt(3)))/(6*a)+((1+i*sqrt(3))*(b^2-3*a*c))/(6*a*C)".replace(/i/g,e.Settings.IMAGINARY)].map((function(e,s){var o={a:a.clone(),b:n.clone(),c:i.clone(),d:t.clone(),C:g.clone()};return r.parse(e,o)}))},quartic:function(t,i,n,a,s){var o,l,c,p,f,v={};return e.Utils.arrayUnique(m(s).concat(m(a)).concat(m(n)).concat(m(i)).concat(m(t))).map((function(e){v[e]=1})),s=s.toString(),a=a.toString(),n=n.toString(),i=i.toString(),t=t.toString(),o=r.parse(u("(8*({0})*({2})-3*({1})^2)/(8*({0})^2)",s,a,n)).toString(),l=r.parse(u("(({1})^3-4*({0})*({1})*({2})+8*({0})^2*({3}))/(8*({0})^3)",s,a,n,i)).toString(),c=r.parse(u("12*({0})*({4})-3*({1})*({3})+({2})^2",s,a,n,i,t)).toString(),p=r.parse(u("2*({2})^3-9*({1})*({2})*({3})+27*({1})^2*({4})+27*({0})*({3})^2-72*({0})*({2})*({4})",s,a,n,i,t)).toString(),f=r.parse(u("((({1})+(({1})^2-4*({0})^3)^(1/2))/2)^(1/3)",c,p)).toString(),g=r.parse(u("(1/2)*(-(2/3)*({1})+(1/(3*({0}))*(({2})+(({3})/({2})))))^(1/2)",s,o,f,c)).toString(),[r.parse(u("-(({1})/(4*({0})))-({4})+(1/2)*sqrt(-4*({4})^2-2*({2})+(({3})/({4})))",s,a,o,l,g)),r.parse(u("-(({1})/(4*({0})))-({4})-(1/2)*sqrt(-4*({4})^2-2*({2})+(({3})/({4})))",s,a,o,l,g)),r.parse(u("-(({1})/(4*({0})))+({4})+(1/2)*sqrt(-4*({4})^2-2*({2})-(({3})/({4})))",s,a,o,l,g)),r.parse(u("-(({1})/(4*({0})))+({4})-(1/2)*sqrt(-4*({4})^2-2*({2})-(({3})/({4})))",s,a,o,l,g))]},divideAndConquer:function(r,t){var i=[],n=e.Algebra.Factor.factor(r);return n.group===h&&n.each((function(e){e=p.unwrapPARENS(e),i=i.concat(L(e,t))})),i},csolve:function(t,i){return e.Utils.block("IGNORE_E",(function(){var n,a,s,o,l,c,f,m;if(m=[],(n=e.Utils.decompose_fn(t,i,!0)).x.group===g){var v,h;a=r.parse(n.x.power),s=Number(a),o=r.pow(r.divide(n.b.negate(),n.a),a.invert()),c=(l=p.toPolarFormArray(o))[0],l[1],f=c.toString(),a.toString();for(var d=0;d<s;d++)h=u("({0})*e^(2*{1}*pi*{2}*{3})",f,d,a,e.Settings.IMAGINARY),v=r.parse(h),m.push(v)}return m}),!0)},getPoints:function(r,t,i){t=t||.01,i=i||[];var n=c(r),a=Math.round(0),s=n(a),o=s/Math.abs(s),l=e.Settings.ROOTS_PER_SIDE,u=l;i.push(Math.floor(a/2)),i.push(Math.abs(a)),i.push(a),r.each((function(r){r.containsFunction(e.Settings.LOG)&&i.push(.1)}));var p=y(-e.Settings.SOLVE_RADIUS,a,t),f=y(a,e.Settings.SOLVE_RADIUS,t),m=function(e,r){for(var t,a,s,l=[],u=0,c=e.length;u<c;u++)t=e[u],s=(a=n(t))/Math.abs(a),isNaN(a)||!isFinite(a)||l.length>r||(s!==o&&l.push(t),o=s);i=i.concat(l)};return m(p,u),m(f,l),i},Newton:function(r,t,i){var n,a=e.Settings.MAX_NEWTON_ITERATIONS,s=0,o=r;do{var l=t(o);if(0===o&&0===l){n=0;break}if(++s>a)return;n=o-l/i(o);var u=Math.abs(n-o);o=n}while(u>w.NEWTON_EPSILON);if(Math.abs(t(n))<=1e-13)return n},rewrite:function(t,i,n){if(i=i||new p(0),t.isComposite()&&t.isLinear()){var a=[],s=[];t.each((function(e){"sqrt"===(e=e.clone()).fname&&e.contains(n)?a.push(e):s.push(e)}),!0),1===a.length&&(i=r.expand(r.pow(r.subtract(i,e.Utils.arraySum(s)),new p(2))),t=r.expand(r.pow(p.unwrapSQRT(a[0]),new p(2))))}else t=p.unwrapSQRT(r.expand(t));var o=0,l=t.length;if(t.group===d&&t.contains(n)&&t.isLinear()){t.distributeMultiplier();var u=new p(0);return t.each((function(e){e.contains(n)?(o++,u=r.add(u,e.clone())):i=r.subtract(i,e.clone())})),t=u,o!==l?M.rewrite(t,i,n):[t,i]}if(t.group===h&&t.contains(n)&&t.isLinear()){if(t.multiplier.lessThan(0)&&(t.multiplier=t.multiplier.multiply(new e.Frac(-1)),i.multiplier=i.multiplier.multiply(new e.Frac(-1))),i.equals(0))return new p(0);u=new p(1);return t.each((function(e){e.contains(n)?u=r.multiply(u,e.clone()):i=r.divide(i,e.clone())})),t=u,M.rewrite(t,i,n)}if(!t.isLinear()&&t.contains(n)){var c=r.parse(t.power.clone().invert());return t=r.pow(t,c.clone()),i=r.pow(r.expand(i),c.clone()),M.rewrite(t,i,n)}if(t.group===b||t.group===g||t.group===v)return[t,i]},sqrtSolve:function(e,t){var i=new p(0),n=new p(0);if(e.isComposite()&&(e.each((function(e){"sqrt"===e.fname&&e.contains(t)?i=r.add(i,e.clone()):n=r.add(n,e.clone())})),!i.equals(0))){var a=r.expand(r.multiply(r.parse(e.multiplier),r.subtract(r.pow(n,new p(2)),r.pow(i,new p(2))))),s=L(a,t);return s=s.filter((function(r){if(r.isImaginary())return r;var i={};return i[t]=r,o(e,i).equals(0)?r:void 0}))}}},L=function i(n,o,l,u){if(u=u||0,u++>w.MAX_SOLVE_DEPTH)return l;if(n instanceof q){if(n.isZero())return[new p(0)];if(n.LHS.equals(o)&&!n.RHS.contains(o))return[n.RHS];if(n.RHS.equals(o)&&!n.LHS.contains(o))return[n.LHS]}if(n instanceof e.Vector&&(n=n.elements),o=o||"x",S(n))return M.solveSystem.apply(void 0,arguments);l=l||[];var m={},y=function t(i,n){var a=f(i);if(!(void 0===i||"number"==typeof i&&isNaN(i)))if(S(i))i.map((function(e){t(e)}));else if("null"!==i.valueOf()){if(a||(i=r.parse(i)),e.Settings.make_pi_conversions&&n){var s=r.divide(i.clone(),new p(Math.PI)),o=s.multiplier,u=Math.abs(o.num),c=Math.abs(o.den);u<10&&c<10&&(i=r.multiply(s,new p("pi")))}var g=i.toString();m[g]||l.push(i),m[g]=!0}};if(n.group===g&&n.contains(o))return y(new p(0)),l;if(n.group===h){var U=String(o);return n.each((function(e){e.contains(U)&&i(e,o,l)})),l}n.group===b&&"sqrt"===n.fname&&(n=r.pow(p.unwrapSQRT(n),new p(2)));var L=(e.Utils.isSymbol(n)?n:M.toLHS(n,!1)).getNum(),N=e.Utils.variables(L),_=N.length;if(e.Utils.isInt(L.power)&&L.power>0&&(L=r.parse(L).toLinear()),L.group===g||L.group===h&&L.contains(o))return[new p(0)];var C,E={},A=function t(i){var n=(i=r.expand(i)).clone();if(i.symbols)for(var a in i.symbols){var l=i.symbols[a],u=l.getDenom();if(!u.isConstant(!0)&&i.isComposite()){var c=new p(0);return i.each((function(e){c=r.add(c,r.multiply(e,u.clone()))})),t(r.multiply(r.parse(i.multiplier),c))}var m=s(l,o),g=m[1].fname===e.Settings.SQRT,h=p.unwrapSQRT(m[1]),d=h.power.clone();if(!f(d)&&!d.equals(.5))if(d.den.gt(1)){if(g)return i=r.subtract(i,l.clone()),t(i=r.add(i,r.multiply(m[0].clone(),h)));var b=E[d.den];E[d.den]=b?b++:1}else{if(-1===d.sign()){var w=r.parse(o+"^"+Math.abs(d));return i.each((function(e,t){e.contains(o)&&(i.symbols[t]=r.multiply(e,w.clone()))})),E={},t(r.parse(i))}if(l.group===v){var y=e.Utils.arrayMin(e.Utils.keys(l.symbols));if(y<0){w=r.parse(o+"^"+Math.abs(y));var S=new p(0);return n.each((function(e){S=r.add(S,r.multiply(e.clone(),w.clone()))}),!0),S}}}}return i},T=function(e){var t=new p(0),i=new p(0);return e.each((function(e){e.contains(o,!0)?t=r.add(t,e.clone()):i=r.subtract(i,e.clone())})),[t,i]};if(M.inverseFunctionSolve=function(e,t,i){var n=s(t.args[0],o);if(n[1].group===g)return r.divide(r.symfunction(e,[r.divide(i,r.parse(t.multiplier))]),n[0])},(L=A(L)).equals(0))return[L];var k=e.Utils.keys(E);if(1===k.length&&(C=k[0],L.each((function(t,i){if(t.contains(o)){var n=s(t,o),a=n[1],l=a.power;l.den.gt(1)&&(a.power=l.multiply(new e.Frac(C)),L.symbols[i]=r.multiply(a,n[0]))}})),L=r.parse(L)),y(M.sqrtSolve(L,o)),1===_)if(L.isPoly(!0)){var F=new e.Algebra.Classes.Factors;if(e.Algebra.Factor.factor(L,F),F.getNumberSymbolics()>1)for(var I in F.factors)y(i(F.factors[I],o));else{var R=(X=e.Utils.getCoeffs(L,o)).length-1,P=!1;if(N[0]===o){if(x(X,(function(r){return r.group!==e.groups.N}))){var O=e.Algebra.proots(L);x(O,(function(r){return!e.Utils.isInt(r)}))&&(P=!0,O.map((function(e){y(new p(e))})))}if(!P)if((n=r.parse(n))instanceof e.Equation&&(n=n.toLHS()),1===R)y(r.divide(X[0],X[1].negate()));else if(2===R)y(r.expand(M.quad.apply(void 0,X)));else if(3===R){l=[];var D=e.Algebra.Factor.factor(n);(l=D.equals(n)?[]:i(D,o)).length>0?y(l):y(M.cubic.apply(void 0,X))}else t.proots(L).map(y)}}}else try{for(var H=L.hasTrig(),V=M.getPoints(L,.1),G=M.getPoints(L,.05),B=M.getPoints(L,.01),z=e.Utils.arrayUnique(V.concat(G).concat(B)).sort((function(e,r){return e-r})),Q=c(L.clone()),Z=a.diff(L.clone()),j=c(Z),Y=0;Y<z.length;Y++){var J=z[Y];y(M.Newton(J,Q,j),H)}l.sort()}catch(ae){console.log(ae)}else if(!L.hasFunc(o)&&L.isComposite())try{if((D=e.Algebra.Factor.factor(L.clone())).group===h)D.each((function(e){y(i(e,o))}));else{var X,K=(X=e.Utils.getCoeffs(L,o)).length;switch(R=K-1){case 0:var W=(ie=T(L))[0],$=ie[1];W.group===e.groups.EX&&y(r.parse(e.Utils.format(e.Settings.LOG+"(({0})/({2}))/"+e.Settings.LOG+"({1})",$,W.value,W.multiplier)));break;case 1:y(r.divide(X[0],X[1].negate()));break;case 2:y(M.quad.apply(void 0,X));break;case 3:y(M.cubic.apply(void 0,X));break;case 4:y(M.quartic.apply(void 0,X));break;default:y(M.csolve(L,o)),0===l.length&&y(M.divideAndConquer(L,o))}0===l.length&&y(i(D,o,l,u))}}catch(ae){}else try{var ee=M.rewrite(L,null,o);W=ee[0],$=ee[1];if(W.group===b)if("abs"===W.fname)y([$.clone(),$.negate()]);else if("sin"===W.fname)y(M.inverseFunctionSolve("asin",W,$));else if("cos"===W.fname)y(M.inverseFunctionSolve("acos",W,$));else if("tan"===W.fname)y(M.inverseFunctionSolve("atan",W,$));else if(W.fname===e.Settings.LOG){var re=s(W.args[0],o);if((I=re[1]).group===g){L=new q(I,$=r.divide(r.subtract(r.pow(W.args.length>1?W.args[1]:new p("e"),r.divide($,r.parse(W.multiplier))),re[3]),re[0])).toLHS();y(i(L,o))}}else y(r.subtract(W,$));else{var te=new q(W,$).toLHS();if(te.equals(L))throw new Error("Stopping. No stop condition exists");y(i(te,o))}}catch(se){try{if(L.group===h)y(0);else if(L.group===d){var ie;W=(ie=T(L))[0],$=ie[1];if(W.group===e.groups.EX&&W.value===o){var ne=W.power.clone().invert();y(r.pow($,ne))}}}catch(se){}}return C&&(l=l.map((function(e){return r.pow(e,new p(C))}))),l};i.register([{name:"solveEquations",parent:"nerdamer",numargs:-1,visible:!0,build:function(){return L}},{name:"solve",parent:"Solve",numargs:2,visible:!0,build:function(){return e.Solve.solve}},{name:"setEquation",parent:"Solve",visible:!0,build:function(){return U}}]),i.api()}()},rsGY:function(e,r,t){t("MIFh"),t("U6Bt"),t("Ml7+"),t("sPse"),t("OeI1"),t("sC2a"),t("wZFJ"),t("AqHK"),t("cxuS"),t("zGcK"),t("q8oJ"),t("C9fy"),t("sc67"),t("HXzo"),t("YBKJ"),t("EMED"),t("n0hJ"),t("rzGZ"),t("Dq+y"),t("8npG");var i=t("Ffb8");t("QBbR"),function(){"use strict";var e=i.getCore(),r=e.PARSER,t=e.groups.N,n=e.groups.P,a=e.groups.S,s=e.groups.EX,o=e.groups.FN,l=e.groups.PL,u=e.groups.CP,c=e.groups.CB,p=e.Utils.keys,f=e.Utils.variables,m=e.Utils.format,g=e.Utils.round,v=e.Frac,h=e.Utils.isInt,d=e.Symbol,b=e.Settings.CONST_HASH,w=e.Utils.importFunctions(),y=e.Utils.evaluate;function S(t,i,n){if(e.Utils.isSymbol(t))this.parse(t),this.variable=this.variable||i;else if(isNaN(t))"string"==typeof t&&this.parse(r.parse(t));else{if(n=n||0,void 0===i)throw new e.exceptions.InvalidVariableNameError("Polynomial expects a variable name when creating using order");this.coeffs=[],this.coeffs[n]=t,this.fill(t)}}function q(){this.factors={},this.length=0}function U(r,t,i){this.terms=t||[],this.coeff=r,this.map=i,this.sum=new e.Frac(0),this.image=void 0}S.fromArray=function(r,t){if(void 0===t)throw new e.exceptions.InvalidVariableNameError("A variable name must be specified when creating polynomial from array");var i=new S;return i.coeffs=r,i.variable=t,i},S.fit=function(e,r,t,i,n,a){var s=new Array(n+1),o=t-r;s[0]=r,s[n]=e,o-=e*Math.pow(i,n);for(var l=n-1;l>0;l--){var u=Math.pow(i,l),c=o/u,p=Math.sign(c)*Math.floor(Math.abs(c));o-=p*u,s[l]=p}if(0!==o)return null;for(l=0;l<s.length;l++)s[l]=new v(s[l]);return S.fromArray(s,a)},S.prototype={parse:function(i,n){if(this.variable=f(i)[0],!i.isPoly())throw e.exceptions.NerdamerTypeError("Polynomial Expected! Received "+e.Utils.text(i));if(n=n||[],i.power.absEquals(1)||(i=r.expand(i)),i.group===e.groups.N)n[0]=i.multiplier;else if(i.group===e.groups.S)n[i.power.toDecimal()]=i.multiplier;else for(var a in i.symbols){var s=i.symbols[a],o=s.power;if(e.Utils.isSymbol(o))throw new e.exceptions.NerdamerTypeError("power cannot be a Symbol");o=s.group===t?0:o.toDecimal(),s.symbols?this.parse(s,n):n[o]=s.multiplier}this.coeffs=n,this.fill()},fill:function(e){e=Number(e)||0;for(var r=this.coeffs.length,t=0;t<r;t++)void 0===this.coeffs[t]&&(this.coeffs[t]=new v(e));return this},trim:function(){for(var e=this.coeffs.length;e--;){var r=this.coeffs[e],t=r.equals(0);if(!r||!t)break;if(0===e)break;this.coeffs.pop()}return this},modP:function(e){for(var r=this.coeffs.length,t=0;t<r;t++){var i=this.coeffs[t];if(i<0){for(var n,a=t;a<r;a++)if(this.coeffs[a]>0){n=this.coeffs[a];break}if(n){for(;a>t;a--)this.coeffs[a]=this.coeffs[a].subtract(new v(1)),this.coeffs[a-1]=this.coeffs[a-1].add(new v(e));i=this.coeffs[t]}}var s=i.mod(e),o=i.subtract(s).divide(e);if(!o.equals(0)){var l=t+1,u=this.coeffs[l]||new v(0);u=u.add(o),this.coeffs[l]=new v(u),this.coeffs[t]=new v(s)}}return this},add:function(e){for(var r=Math.max(this.coeffs.length,e.coeffs.length),t=0;t<r;t++){var i=this.coeffs[t]||new v(0),n=e.coeffs[t]||new v(0);this.coeffs[t]=i.add(n)}return this},subtract:function(e){for(var r=Math.max(this.coeffs.length,e.coeffs.length),t=0;t<r;t++){var i=this.coeffs[t]||new v(0),n=e.coeffs[t]||new v(0);this.coeffs[t]=i.subtract(n)}return this},divide:function(r){for(var t=this.variable,i=e.Utils.arrayClone(this.coeffs),n=e.Utils.arrayClone(r.coeffs),a=i.length,s=n.length-1,o=[],l=0;l<a;l++){var u=a-(l+1),c=u-s,p=i[u].divide(n[s]);if(c<0)break;o[c]=p;for(var f=0;f<=s;f++)i[f+c]=i[f+c].subtract(n[f].multiply(p))}var m=S.fromArray(i,t||"x").trim();return[S.fromArray(o,t||"x"),m]},multiply:function(e){for(var r=this.coeffs.length,t=e.coeffs.length,i=[],n=0;n<r;n++)for(var a=this.coeffs[n],s=0;s<t;s++){var o=n+s,l=e.coeffs[s],u=i[o]||new v(0);i[o]=u.add(a.multiply(l))}return this.coeffs=i,this},isZero:function(){for(var e=this.coeffs.length,r=0;r<e;r++){if(!this.coeffs[r].equals(0))return!1}return!0},sub:function(e){for(var r=new v(0),t=this.coeffs.length,i=0;i<t;i++){var n=this.coeffs[i];n.equals(0)||(r=r.add(n.multiply(new v(Math.pow(e,i)))))}return r},clone:function(){var e=new S;return e.coeffs=this.coeffs,e.variable=this.variable,e},deg:function(){return this.trim(),this.coeffs.length-1},lc:function(){return this.coeffs[this.deg()].clone()},monic:function(){for(var e=this.lc(),r=this.coeffs.length,t=0;t<r;t++)this.coeffs[t]=this.coeffs[t].divide(e);return this},gcd:function(r){if(this.coeffs.length-1<r.coeffs.length-1)return r.gcd(this);for(var t=this;!r.isZero();){var i=r.clone();r=(t=t.clone()).divide(i)[1],t=i}var n=e.Math2.QGCD.apply(null,t.coeffs);if(!n.equals(1))for(var a=t.coeffs.length,s=0;s<a;s++)t.coeffs[s]=t.coeffs[s].divide(n);return t},diff:function(){for(var e=[],r=this.coeffs.length,t=1;t<r;t++)e.push(this.coeffs[t].multiply(new v(t)));return this.coeffs=e,this},integrate:function(){for(var e=[0],r=this.coeffs.length,t=0;t<r;t++){var i=new v(t+1);e[i]=this.coeffs[t].divide(i)}return this.coeffs=e,this},gcf:function(r){for(var t=[],i=0;i<this.coeffs.length;i++){var n=this.coeffs[i];n.equals(0)||-1!==t.indexOf(n)||t.push(n)}var a=[e.Math2.QGCD.apply(void 0,t),function(e){for(var r=0;r<e.length;r++)if(!e[r].equals(0))return r}(this.coeffs)].toDecimal();if(r){var s=[];s[a[1]-1]=a[0],a=S.fromArray(s,this.variable).fill()}return a},quad:function(e){var r=[];if(this.coeffs.length>3)throw new Error("Cannot calculate quadratic order of "+(this.coeffs.length-1));if(0===this.coeffs.length)throw new Error("Polynomial array has no terms");var t=this.coeffs[2]||0,i=this.coeffs[1]||0,n=i*i-4*t*this.coeffs[0];return n<0&&!e||(r[0]=(-i+Math.sqrt(n))/(2*t),r[1]=(-i-Math.sqrt(n))/(2*t)),r},squareFree:function(){for(var e=this.clone(),r=1,t=e.clone().diff(),i=e.clone().gcd(t),n=e.divide(i)[0],a=S.fromArray([new v(1)],e.variable);!i.equalsNumber(1);){var s=n.gcd(i),o=n.divide(s)[0];if(!o.equalsNumber(1)&&r>1){for(var l=o.clone(),u=1;u<r;u++)l.multiply(o.clone());o=l}a=a.multiply(o),r++,n=s,i=i.divide(s)[0]}return[a,n,r]},toSymbol:function(){var t=this.coeffs.length,i=this.variable;if(0===t)return new e.Symbol(0);for(var n=t-1,a="",s=0;s<t;s++){var o=s===n?"":"+",l=this.coeffs[s];l.equals(0)||(a+=l+"*"+i+"^"+s+o)}return r.parse(a)},equalsNumber:function(e){return this.trim(),1===this.coeffs.length&&this.coeffs[0].toDecimal()===String(e)},toString:function(){return this.toSymbol().toString()}},d.prototype.coeffs=function(e,t){t&&!this.isPoly(!0)&&r.error("Polynomial expected when requesting coefficients with order"),e=e||[];var i=this.clone().distributeMultiplier();if(i.isComposite())for(var n in i.symbols){var a=i.symbols[n];a.isComposite()?a.clone().distributeMultiplier().coeffs(e,t):t?e[a.isConstant()?0:a.power.toDecimal()]=a.multiplier:e.push(a.multiplier)}else if(t)e[i.isConstant(!0)?0:i.power.toDecimal()]=i.multiplier;else if(i.group===c&&i.isImaginary()){var s=new d(i.multiplier);i.each((function(e){(e.isConstant(!0)||e.imaginary)&&(s=r.multiply(s,e))})),e.push(s)}else e.push(i.multiplier);if(t)for(var o=0;o<e.length;o++)void 0===e[o]&&(e[o]=new d(0));return e},d.prototype.tBase=function(e){if(void 0===e)throw new Error("Symbol.tBase requires a map object!");for(var r=[],t=this.collectSymbols(null,null,null,!0),i=t.length,n=0;n<i;n++){var a=t[n],s=a.group,o=new U(a.multiplier,[],e);if(s===c)for(var l in a.symbols){var u=a.symbols[l];o.terms[e[l]]=u.power}else o.terms[e[a.value]]=a.power;r.push(o.fill()),o.updateCount()}return r},d.prototype.altVar=function(e){var r=this.multiplier.toString(),t=this.power.toString();return("1"===r?"":r+"*")+e+("1"===t?"":"^"+t)},d.prototype.sameVars=function(e){if(!this.symbols&&this.group!==e.group)return!1;for(var r in this.symbols){var t=this.symbols[r],i=e.symbols[r];if(!i)return!1;if(t.value!==i.value)return!1}return!0},d.prototype.groupTerms=function(t){var i,n,a;t=String(t);var s=[];return this.each((function(o){if(o.group===l){a=o.groupTerms(t);for(var u=0;u<a.length;u++){var c=a[u];c&&(s[u]=c)}}else i=e.Utils.decompose_fn(o,t,!0),n=i.x.value===t?Number(i.x.power):0,s[n]=r.add(s[n]||new d(0),i.a)})),s},d.prototype.collectFactors=function(){var e=[];return this.group===c?this.each((function(r){e.push(r.clone())})):e.push(this.clone()),e},q.prototype.getNumberSymbolics=function(){var e=0;return this.each((function(r){r.isConstant(!0)||e++})),e},q.prototype.add=function(t){if(t.equals(0))return this;if(t.equals(-1)&&this.length>0){var i=e.Utils.firstObject(this.factors,null,!0);return this.add(r.symfunction(e.Settings.PARENTHESIS,[i.obj]).negate()),delete this.factors[i.key],this.length--,this}if(t.group===c){var n=this;t.multiplier.equals(1)||n.add(new d(t.multiplier)),t.each((function(e){n.add(e)}))}else{this.preAdd&&(t=this.preAdd(t)),this.pFactor&&(t=r.pow(t,new d(this.pFactor)));var a=t.isConstant();if(a&&t.equals(1))return this;var s=a?t.value:t.text();s in this.factors?(this.factors[s]=r.multiply(this.factors[s],t),this.factors[s].equals(1)&&(delete this.factors[s],this.length--)):(this.factors[s]=t,this.length++)}return this},q.prototype.toSymbol=function(){for(var t=new d(1),i=Object.values(this.factors).sort((function(e,r){return e.group>r.group})),n=0,a=i.length;n<a;n++){var s=i[n],o=s.power.equals(1)&&""!==s.fname?r.symfunction(e.PARENTHESIS,[s]):s;t=r.multiply(t,o)}return""===t.fname&&(t=d.unwrapPARENS(t)),t},q.prototype.merge=function(e){for(var t in e)t in this.factors?this.factors[t]=r.multiply(this.factors[t],e[t]):this.factors[t]=e[t];return this},q.prototype.each=function(r){for(var t in this.factors){var i=this.factors[t];i.fname===e.PARENTHESIS&&i.isLinear()&&(i=i.args[0]),r.call(this,i,t)}return this},q.prototype.count=function(){return p(this.factors).length},q.prototype.clean=function(){try{var r=e.Settings.CONST_HASH;this.factors[r].lessThan(0)&&(this.factors[r].equals(-1)?delete this.factors[r]:this.factors[r].negate(),this.each((function(e){e.negate()})))}catch(t){}},q.prototype.toString=function(){return this.toSymbol().toString()},U.prototype.updateCount=function(){this.count=this.count||0;for(var e=0;e<this.terms.length;e++)this.terms[e].equals(0)||this.count++;return this},U.prototype.getVars=function(){for(var e=[],r=0;r<this.terms.length;r++){var t=this.terms[r];this.getRevMap();t.equals(0)||e.push(this.rev_map[r])}return e.join(" ")},U.prototype.len=function(){return void 0===this.count&&this.updateCount(),this.count},U.prototype.toSymbol=function(e){e=e||this.getRevMap();for(var t=new d(this.coeff),i=0;i<this.terms.length;i++){var n=e[i],a=this.terms[i];if(!a.equals(0)&&n!==b){var s=new d(n);s.power=a,t=r.multiply(t,s)}}return t},U.prototype.getRevMap=function(){if(this.rev_map)return this.rev_map;var e={};for(var r in this.map)e[this.map[r]]=r;return this.rev_map=e,e},U.prototype.generateImage=function(){return this.image=this.terms.join(" "),this},U.prototype.getImg=function(){return this.image||this.generateImage(),this.image},U.prototype.fill=function(){for(var r=this.map.length,t=0;t<r;t++)void 0===this.terms[t]?this.terms[t]=new e.Frac(0):this.sum=this.sum.add(this.terms[t]);return this},U.prototype.divide=function(e){for(var r=this.coeff.divide(e.coeff),t=this.terms.length,i=new U(r,[],this.map),n=0;n<t;n++)i.terms[n]=this.terms[n].subtract(e.terms[n]),i.sum=i.sum.add(i.terms[n]);return i},U.prototype.multiply=function(e){for(var r=this.coeff.multiply(e.coeff),t=this.terms.length,i=new U(r,[],this.map),n=0;n<t;n++)i.terms[n]=this.terms[n].add(e.terms[n]),i.sum=i.sum.add(i.terms[n]);return i},U.prototype.isZero=function(){return this.coeff.equals(0)},U.prototype.toString=function(){return"{ coeff: "+this.coeff.toString()+", terms: ["+this.terms.join(",")+"]: sum: "+this.sum.toString()+", count: "+this.count+"}"},e.Utils.toMapObj=function(e){for(var r=0,t={},i=0;i<e.length;i++){var n=e[i];void 0===t[n]&&(t[n]=r,r++)}return t.length=r,t},e.Utils.filledArray=function(e,r,t){for(var i=[];r--;)i[r]=t?new t(e):e;return i},e.Utils.arrSum=function(e){for(var r=0,t=e.length,i=0;i<t;i++)r+=e[i];return r},e.Utils.haveIntersection=function(e,r){var t;return r.length>e.length&&(t=r,r=e,e=t),e.some((function(e){return r.indexOf(e)>-1}))},e.Utils.subFunctions=function(r,t){t=t||{};var i=[];return r.each((function(r){if(r.group===o||r.previousGroup===o){var n=e.Utils.text(r,"hash"),a=t[n];if(a)i.push(r.altVar(a));else{var s=r.fname+p(t).length;t[n]=s,i.push(r.altVar(s))}}else r.group===c||r.group===l||r.group===u?i.push(e.Utils.subFunctions(r,t)):i.push(r.text())})),r.group===u||r.group===l?r.altVar(e.Utils.inBrackets(i.join("+"))):r.group===c?r.altVar(e.Utils.inBrackets(i.join("*"))):r.text()},e.Utils.getFunctionsSubs=function(e){var t={};for(var i in e)t[e[i]]=r.parse(i);return t};var x=e.Algebra={version:"1.4.5",init:void 0,proots:function(t,i){i=i||7;var n=[],s=function(e,r,t){for(var i=C(e,r,t).concat(n),a=0;a<0;a++)i.unshift(0);return i};if(t instanceof d&&t.isPoly()){if(t.distributeMultiplier(),t.group===l){var o=e.Utils.arrayMin(p(t.symbols)),u=t.symbols[o].clone().toUnitMultiplier();t=r.expand(r.divide(t,u)),n.push(0)}if(t.group===e.groups.S)return[0];if(t.group===e.groups.PL){var c=p(t.symbols),f=e.Utils.arrayMin(c);t=e.PARSER.divide(t,e.PARSER.parse(t.value+"^"+f))}for(var m=p(t.symbols).sort().pop(),v=t.group===e.groups.PL?t.symbols:t.symbols[m],h=v.group,w=(c=h===a?[v.power.toDecimal()]:p(v.symbols),[]),y=e.Utils.arrayMax(c),S=1;S<=y;S++){var q=0;-1!==c.indexOf(S+"")&&(q=h===a?v.multiplier:v.symbols[S].multiplier),w.unshift(q)}return w.push(t.symbols[b].multiplier),v.group===a&&(w[0]=v.multiplier),s(w,c,y)}if(e.Utils.isArray(t)){var U=t,x=(w=[],c=[],0);for(S=0;S<U.length;S++){for(var M=U[S][0],L=U[S][1],N=L-x-1,_=0;_<N;_++)w.unshift(0);w.unshift(M),0!==L&&c.push(L),x=L}return s(w,c,y=Math.max.apply(void 0,c))}throw new e.exceptions.NerdamerTypeError("Cannot calculate roots. Symbol must be a polynomial!");function C(r,t,n){var a=r.slice(0);if(r.unshift(n),n>100)throw new e.exceptions.ValueLimitExceededError("This utility accepts polynomials of degree up to 100. ");var s=[],o={};for(o.Degree=n,S=0;S<n;S++)s.push(0);var l=s.slice(0);function u(e,r,t,i,n,a){n[0]=a.b=i[0],n[1]=a.a=-r*a.b+i[1];for(var s=2;s<e;s++)n[s]=-(r*a.a+t*a.b)+i[s],a.b=a.a,a.a=n[s]}function c(e,r,t,i,n,a,s,o,l){var c=new Object,p=3;return c.b=c.a=0,u(r,s,o,a,l,c),n.c=c.a,n.d=c.b,Math.abs(n.c)<=100*e*Math.abs(a[r-1])&&Math.abs(n.d)<=100*e*Math.abs(a[r-2])||(n.h=o*i,Math.abs(n.d)>=Math.abs(n.c)?(p=2,n.e=t/n.d,n.f=n.c/n.d,n.g=s*i,n.a3=n.e*(n.g+t)+n.h*(i/n.d),n.a1=-t+n.f*i,n.a7=n.h+(n.f+s)*t):(p=1,n.e=t/n.c,n.f=n.d/n.c,n.g=n.e*s,n.a3=n.e*t+(n.g+n.h/n.c)*i,n.a1=-t*(n.d/n.c)+i,n.a7=n.g*n.d+n.h*n.f+t)),p}function p(e,r,t,i,n,a,s,o,l){var u;if(3!=t)if(u=1==t?n:i,Math.abs(a.a1)>10*e*Math.abs(u)){a.a7/=a.a1,a.a3/=a.a1,s[0]=l[0],s[1]=-l[0]*a.a7+l[1];for(c=2;c<r;c++)s[c]=-l[c-1]*a.a7+o[c-2]*a.a3+l[c]}else{s[0]=0,s[1]=-l[0]*a.a7;for(c=2;c<r;c++)s[c]=-l[c-1]*a.a7+o[c-2]*a.a3}else{s[1]=s[0]=0;for(var c=2;c<r;c++)s[c]=o[c-2]}}function f(e,r,t,i,n,a,s,o,l,u,c,p,f,m,g,v,h){var d,b,w,y,S,q,U,x;r.b=r.a=0,3!=e&&(2!=e?(d=t+f*s+p*u,b=o+(f+m*u)*l):(d=(t+c)*u+p,b=(u+f)*o+m*l),0!=(x=-(U=-((S=(w=-g[v-1]/h[v])*a)+(q=w*w*n))+m*(y=-(g[v-2]+w*h[v-1])/h[v])*i)+b+w*d)&&(r.a=-(f*(q+S)+m*(w*i+y*a))/x+f,r.b=m*(1+U/x)))}function m(e,r,t,i){var n,a,s;i.sr=i.si=i.lr=i.li=0,0!=e?0!=t?(n=r/2,Math.abs(n)<Math.abs(t)?(s=-(s=t>=0?e:-e)+n*(n/Math.abs(t)),a=Math.sqrt(Math.abs(s))*Math.sqrt(Math.abs(t))):(s=-e/n*(t/n)+1,a=Math.sqrt(Math.abs(s))*Math.abs(n)),s>=0?(a=n>=0?-a:a,i.lr=(-n+a)/e,i.sr=0!=i.lr?t/i.lr/e:i.sr):(i.lr=i.sr=-n/e,i.si=Math.abs(a/e),i.li=-i.si)):i.lr=-r/e:i.sr=0!=r?-t/r:i.sr}function v(e,r,t,i,n,a,s,o,l,g,v,h){var d,b,w,y,S,q,U,x,M,L,N,_=new Object,C=0,E=0;t.NZ=0,q=i,x=n;do{if(_.li=_.lr=_.si=_.sr=0,m(1,q,x,_),t.szr=_.sr,t.szi=_.si,t.lzr=_.lr,t.lzi=_.li,Math.abs(Math.abs(t.szr)-Math.abs(t.lzr))>.01*Math.abs(t.lzr))break;for(u(s,q,x,l,a,o),b=Math.abs(-t.szr*o.b+o.a)+Math.abs(t.szi*o.b),L=Math.sqrt(Math.abs(x)),d=2*Math.abs(a[0]),S=-t.szr*o.b,N=1;N<r;N++)d=d*L+Math.abs(a[N]);if(b<=20*(d=(9*(d=d*L+Math.abs(S+o.a))+2*Math.abs(S)-7*(Math.abs(o.a+S)+L*Math.abs(o.b)))*e)){t.NZ=2;break}if(++C>20)break;if(C>=2&&y<=.01&&b>=w&&!E){for(u(s,q-=q*(y=y<e?Math.sqrt(e):Math.sqrt(y)),x+=x*y,l,a,o),N=0;N<5;N++)p(e,r,c(e,r,o.a,o.b,v,h,q,x,g),o.a,o.b,v,h,g,a);E=1,C=0}w=b,p(e,r,c(e,r,o.a,o.b,v,h,q,x,g),o.a,o.b,v,h,g,a),f(c(e,r,o.a,o.b,v,h,q,x,g),o,o.a,v.a1,v.a3,v.a7,o.b,v.c,v.d,v.f,v.g,v.h,q,x,h,r,l),U=o.a,0!=(M=o.b)&&(y=Math.abs((-x+M)/M),q=U,x=M)}while(0!=M)}function h(e,r,t,i,n,a,s,o,l){var u,c,p,f,m,g,v,h,d,b,w,y=i-1;for(r.NZ=w=d=0,v=t.a;;){for(g=n[0],s[0]=g,b=1;b<a;b++)s[b]=g=g*v+n[b];for(p=Math.abs(g),f=Math.abs(v),u=.5*Math.abs(s[0]),b=1;b<a;b++)u=u*f+Math.abs(s[b]);if(p<=20*e*(2*u-p)){r.NZ=1,r.szr=v,r.szi=0;break}if(++w>10)break;if(w>=2&&Math.abs(h)<=.001*Math.abs(-h+v)&&p>m){d=1,r.a=v;break}for(m=p,l[0]=c=o[0],b=1;b<i;b++)l[b]=c=c*v+o[b];if(Math.abs(c)>10*Math.abs(o[y])*e)for(h=-g/c,o[0]=s[0],b=1;b<i;b++)o[b]=h*l[b-1]+s[b];else for(o[0]=0,b=1;b<i;b++)o[b]=l[b-1];for(c=o[0],b=1;b<i;b++)c=c*v+o[b];v+=h=Math.abs(c)>10*Math.abs(o[y])*e?-g/c:0}return d}function d(e,r,t,i,n,a,s,o,l,m,g,d){var b,w,y,S,q,U,x,M,L,N,_,C,E,A,T,k,F,I,R,P,O,D,H,V,G,B=new Object,z=new Object,Q=new Array(r),Z=new Array(r),j=1;for(d.NZ=0,S=y=.25,q=i,M=n,B.b=B.a=0,u(l,g,n,o,m,B),b=B.a,w=B.b,z.h=z.g=z.f=z.e=z.d=z.c=z.a7=z.a3=z.a1=0,H=c(e,s,b,w,z,a,g,n,Q),P=0;P<t;P++){if(I=1,p(e,s,H,b,w,z,a,Q,m),f(H=c(e,s,b,w,z,a,g,n,Q),B,b,z.a1,z.a3,z.a7,w,z.c,z.d,z.f,z.g,z.h,g,n,a,s,o),T=B.a,F=k=B.b,N=0!=a[s-1]?-o[s]/a[s-1]:0,_=E=1,0!=P&&3!=H&&(V=(A=(E=0!=F?Math.abs((F-M)/F):E)<x?E*x:1)<S?1:0,(O=(C=(_=0!=N?Math.abs((N-q)/N):_)<U?_*U:1)<y?1:0)||V)){for(R=0;R<s;R++)Z[R]=a[R];for(L=N,D=G=0;;){if(I&&0==(I=0)&&O&&(!V||C<A));else{if(v(e,s,d,T,k,m,l,B,o,Q,z,a),b=B.a,w=B.b,d.NZ>0)return;if(j=G=1,S*=.25,D||!O)j=0;else for(R=0;R<s;R++)a[R]=Z[R]}if(0!=j){if(B.a=L,j=h(e,d,B,s,o,l,m,a,Q),L=B.a,d.NZ>0)return;if(D=1,y*=.25,0!=j){T=-(L+L),k=L*L;continue}}for(R=0;R<s;R++)a[R]=Z[R];if(!V||G)break}u(l,g,n,o,m,B),H=c(e,s,b=B.a,w=B.b,z,a,g,n,Q)}M=F,q=N,x=E,U=_}}!function(e,r,t,i){var n,a,s,o,l,u,c,p,f,g,v,h,b,w,y,S,q,U,x,M,L,N,_,C=e.Degree,E=Math.LN2,A=e.Degree+1,T=new Array(A),k=new Array(A),F=new Array(A),I=new Array(A),R=new Object,P=new Object;h=1;do{a=h,b=1+(h/=2)}while(b>1);var O=Number.MIN_VALUE/a,D=Math.cos(1.6406094968746698),H=Math.sin(1.6406094968746698),V=Math.sqrt(.5),G=-V;for(P.NZ=U=0,P.szr=P.szi=P.lzr=P.lzi=0;0==r[C];)t[U]=i[U]=0,C--,U++;for(N=C+1;C>=1;){if(C<=2){C<2?(t[e.Degree-1]=-r[1]/r[0],i[e.Degree-1]=0):(R.li=R.lr=R.si=R.sr=0,m(r[0],r[1],r[2],R),t[e.Degree-2]=R.sr,i[e.Degree-2]=R.si,t[e.Degree-1]=R.lr,i[e.Degree-1]=R.li);break}for(c=0,p=Number.MAX_VALUE,B=0;B<N;B++)(g=Math.abs(r[B]))>c&&(c=g),0!=g&&g<p&&(p=g);if(((f=O/p)<=1&&c>=10||f>1&&Number.MAX_VALUE/f>=c)&&(f=0==f?Number.MIN_VALUE:f,M=Math.floor(Math.log(f)/E+.5),1!=(l=Math.pow(2,M))))for(B=0;B<N;B++)r[B]*=l;for(var B=0;B<N;B++)k[B]=Math.abs(r[B]);k[C]=-k[C],L=C-1,g=Math.exp((Math.log(-k[C])-Math.log(k[0]))/C),0!=k[L]&&(g=(v=-k[C]/k[L])<g?v:g),v=g;do{v=.1*(g=v),u=k[0];for(B=1;B<N;B++)u=u*v+k[B]}while(u>0);o=g;do{s=u=k[0];for(B=1;B<C;B++)s=g*s+(u=g*u+k[B]);g-=o=(u=g*u+k[C])/s}while(Math.abs(o/g)>.005);n=g;for(B=1;B<C;B++)T[B]=(C-B)*r[B]/C;for(T[0]=r[0],h=r[C],b=r[L],_=0==T[L]?1:0,x=0;x<5;x++)if(w=T[L],_){for(B=0;B<L;B++)T[U=L-B]=T[U-1];T[0]=0,_=0==T[L]?1:0}else{S=-h/w;for(B=0;B<L;B++)T[U=L-B]=S*T[U-1]+r[U];T[0]=r[0],_=Math.abs(T[L])<=Math.abs(b)*a*10?1:0}for(B=0;B<C;B++)I[B]=T[B];for(x=1;x<=20;x++){if(q=-H*G+D*V,G=H*V+D*G,d(a,A,20*x,y=n*(V=q),n,T,C,r,N,F,-2*y,P),0!=P.NZ){t[U=e.Degree-C]=P.szr,i[U]=P.szi,C=(N-=P.NZ)-1;for(B=0;B<N;B++)r[B]=F[B];1!=P.NZ&&(t[U+1]=P.lzr,i[U+1]=P.lzi);break}for(B=0;B<C;B++)T[B]=I[B]}if(x>20){e.Degree-=C;break}}}(o,a,l,s);var b=s.length;for(S=0;S<b;S++){var w=g(s[S],i+8),y=g(l[S],i+8),q=w<0?"-":"";0===(y=i-String(y).length>2?y:l[S])&&(y=""),0===w&&(w=""),w=1===Math.abs(w)?q+"i":w?w+"*i":"";var U=y&&w?y+"+"+w:y+w;l[S]=U.replace(/\+\-/g,"-")}return l}},roots:function(t){if(t.isConstant(!0,!0))return e.Utils.nroots(t);var i=x.proots(t).map((function(e){return r.parse(e)}));return e.Vector.fromArray(i)},froot:function(r,t,i){return function(t){for(var n=i||e.Utils.build(e.Calculus.diff(r.clone())),a=r instanceof Function?r:e.Utils.build(r),s=!1,o=0;!s;){var l=t-a(t)/n(t),u=Math.abs(l)-Math.abs(t);t=l,Math.abs(u)<1e-12?s=!0:o>1e4&&(t=null,s=!0),o++}return t}(Number(t))},quad:function(e,t,i){var n=function(e,t,i,n){return r.parse("-("+t+"+"+n+"*sqrt(("+t+")^2-4*("+e+")*("+i+")))/(2*"+e+")")};return[n(e,t,i,1),n(e,t,i,-1)]},sumProd:function(e,r){return x.quad(-r,e,-1).map((function(e){return e.invert()}))},coeffs:function(e,t,i){t=String(t),e=r.expand(e),i=i||[new d(0)],e.group===s&&e.contains(t,!0)&&r.error("Unable to get coefficients using expression "+e.toString());var n=f(e);if(n.length<=1&&n[0]===t)for(var a=new S(e).coeffs.map((function(e){return new d(e)})),o=0,l=a.length;o<l;o++){var p=a[o];(g=i[o])&&(p=r.add(g,p)),i[o]=p}else if(t||r.error("Polynomial contains more than one variable. Please specify which variable is to be used!"),-1===n.indexOf(t))i[0]=r.add(e,i[0]);else if(i=i||[new d(0)],e.group===c){var m=e.symbols[t];m||r.error("Expression is not a polynomial!");var g,v=Number(m.power);((p=r.divide(e.clone(),m.clone())).contains(t,!0)||v<0||!h(v))&&r.error("Expression is not a polynomial!"),(g=i[v])&&(p=r.add(g,p)),i[v]=p}else e.group===u&&e.each((function(e){x.coeffs(e.clone(),t,i)}),!0);for(o=0,l=i.length;o<l;o++)void 0===i[o]&&(i[o]=new d(0));return i},polyPowers:function(r,i,n){if(n=n||[],(f=f=r.group)===l&&i===r.value)n=n.concat(p(r.symbols));else if(f===u)for(var s in r.symbols){var o=r.symbols[s],f=o.group,m=o.value;if(f===a&&i===m)n.push(o.power);else if(f===l||f===u)n=x.polyPowers(o,i,n);else if(f===c&&o.contains(i)){var g=o.symbols[i];g&&n.push(g.power)}else f!==t&&i===m||n.push(0)}else f===c&&r.contains(i)&&n.push(e.Utils.decompose_fn(r,i,!0).x.power);return e.Utils.arrayUnique(n).sort()},Factor:{split:function(e){var t=new d(1),i=new d(1);return x.Factor.factor(e,new q).each((function(e){var n=r.parse(e);e.isConstant(!0)?t=r.multiply(t,n):i=r.multiply(i,n)})),[t,i]},mix:function(e,r){for(var t=p(e),i=t.length,n=[],a=0;a<i;a++){for(var s=t[a],o=e[s],l=n.length,u=0;u<l;u++){var c=n[u]*s;n.push(c),r&&n.push(-c)}for(u=1;u<=o;u++)n.push(Math.pow(s,u))}return n},common:function(t,i){try{if(t.group===u){for(var n=r.expand(t.clone(),!0).collectSymbols(null,null,(function(e,r){return(r.length||1)-(e.length||1)})),a={},s=[],o=0;o<n.length;o++){var l=n[o];s.push(l.multiplier.clone()),l.each((function(e){var r=Number(e.power);if(isNaN(r))throw new Error("exiting");e.value in a?(r<a[e.value][0]&&(a[e.value][0]=r),a[e.value][1].push(e)):a[e.value]=[r,[e]]}))}var c=new d(1);for(var p in a)a[p][1].length===n.length&&(c=r.multiply(c,r.pow(new d(p),new d(a[p][0]))));var f=e.Math2.QGCD.apply(null,s);if(!f.equals(1)){i.add(new d(f));for(o=0;o<n.length;o++)n[o].multiplier=n[o].multiplier.divide(f)}if(!c.equals(1)){i.add(c),t=new d(0);for(o=0;o<n.length;o++)t=r.add(t,r.divide(n[o],c.clone()))}}}catch(m){}return t},zeroes:function(t,i){var n=function(){throw new e.exceptions.ValueLimitExceededError("Exiting")};try{var a,s,o,l,c;c=(t=r.expand(t.clone())).toString(),a=f(t),o=new d(0);for(var p=[],m=[],g=0,b=a.length;g<a.length;g++){for(var w={},y=0;y<b;y++)g!==y&&(w[a[y]]=0);var S=(s=r.parse(c,w)).power;h(S)||n(),p.push(s),m.push(s.power)}if(e.Utils.allSame(m)){var q=t.length,U=p.length;2===U&&(l=new v(m[0]/(q-1))),3===U&&(l=new v(m[0]/Math.round((Math.sqrt(8*q-1)-3)/2)))}else l=e.Math2.QGCD.apply(null,m);h(l)||n();for(g=0;g<p.length;g++){var M=p[g],L=M.power.clone().divide(l);M.multiplier=new v(Math.pow(M.multiplier,1/L)),M.power=l.clone(),o=r.add(o,M)}if(o.group!==u)return t;for(;;){var N=x.div(t.clone(),o.clone());if(!N[1].equals(0))break;if(t=N[0],i.add(o.clone()),t.equals(1))break}}catch(c){}return t},factor:function(e,t){var i=r.parse(e),n=x.Factor._factor(i,t);if(n.equals(e))return n;if(n.group===c){var a=new d(1);n.multiplier.lessThan(0)&&(a.negate(),n.negate()),n.each((function(e){var t=x.Factor._factor(e);t.group===c?t.each((function(e){var t=x.Factor._factor(e);a=r.multiply(a,t)})):a=r.multiply(a,t)})),n=a}return n},quadFactor:function(t,i){if(t.isPoly()&&x.degree(t.equals(2))){var n=e.Utils.variables(t)[0],a=x.coeffs(t,n),s=x.Factor._factor(a[2].clone());if(s.group===c){var o=s.collectSymbols();if(o.length>2)return t;var l=r.multiply(r.parse(a[0]),r.parse(o[0])),u=r.parse(a[1]).negate(),p=r.parse(o[1]),f=x.quad(p,u,l).filter((function(r){if(e.Utils.isInt(r))return r}));if(1===f.length){var g=f[0],v=r.divide(a[0],r.parse(g));e.Utils.isInt(v)&&(i.add(r.parse(m("({0})*({1})+({2})",o[1],n,v))),i.add(r.parse(m("({0})*({1})+({2})",o[0],n,g))),t=new d(1))}}}return t},_factor:function(t,i){if(t.group===o){var n=t.args[0];if(n.group===a&&n.isSimple())return t}else if(t.group===a&&t.isSimple())return t;if(t.group===u){t.distributeMultiplier();var s=new d(0);t.each((function(e){(e.group===u&&e.power.greaterThan(1)||e.group===c)&&(e=r.expand(e)),s=r.add(s,e)})),s.power=t.power,t=s}t.group===o&&"sqrt"!==t.fname&&(t=e.Utils.evaluate(t));var l=t.clone();try{if(t.group===c){var m,g,v,b,w,y;if(m=x.Simplify.strip(t.getDenom()),g=x.Simplify.strip(t.getNum()),v=m.pop(),(b=g.pop()).equals(t))return t;y=x.Factor.factor(b),w=x.Factor.factor(v);var S=x.Simplify.unstrip(g,y),U=x.Simplify.unstrip(m,w);return r.divide(S,U)}if(t.group===a)return t;if(t.isConstant())return t.equals(1)?t.clone():e.Math2.factor(t);var M=t.power.clone();if(h(M)&&(!M.lessThan(0)||t.group!==o)){var L=M.sign();t.toLinear(),i=i||new q;var N={};t=r.parse(e.Utils.subFunctions(t,N)),p(N).length>0&&(i.preAdd=function(t){return r.parse(t,e.Utils.getFunctionsSubs(N))}),t.isLinear()||(i.pFactor=t.power.toString(),t.toLinear());var _=f(t);t.isImaginary()&&_.push(e.Settings.IMAGINARY);var C=_.length>1;if(C){var E=!0,A=!0;if(t.each((function(e){e.group!==a&&(E=!1),e.multiplier.equals(1)||(A=!1)})),E&&A)return r.pow(r.parse(t,e.Utils.getFunctionsSubs(N)),r.parse(M))}var T=new q;t=x.Factor.coeffFactor(t,T),T.each((function(e){L<0&&e.invert(),i.add(e)}));var k=new q;if(t=x.Factor.powerFactor(t,k),k.each((function(e){L<0&&e.invert(),i.add(e)})),C)t=x.Factor.mfactor(t,i),i.each((function(e){L<0&&e.power.negate()}));else{var F=_[0];t=x.Factor.squareFree(t,i,F);var I=new q;t=x.Factor.trialAndError(t,I,F);var R=I.toSymbol();if(R.equals(l))return R;for(var P in I.factors){var O=I.factors[P];i.add(r.pow(O,r.parse(M)))}t.equals(l)&&(t=x.Factor.quadFactor(t,i))}return t=r.parse(t,e.Utils.getFunctionsSubs(N)),i.add(r.pow(t,r.parse(M))),i.toSymbol()}return t}catch(D){return l}},reduce:function(e,t){if(e.group===u&&2===e.length){var i=e.collectSymbols().sort((function(e,r){return r.multiplier-e.multiplier}));if(i[0].power.equals(i[1].power)){var n=r.parse(i[0].power),a=i[0].clone().toLinear(),s=i[1].clone().toLinear();t.add(r.add(a.clone(),s.clone())),s.negate();for(var o=Number(n),l=new d(0),c=1;c<=o;c++){var p=r.pow(a.clone(),r.subtract(n.clone(),new d(c))),f=r.pow(s.clone(),r.subtract(new d(c),new d(1)));l=r.add(l,r.multiply(p,f))}return l}}return e},squareFree:function(e,r,t){if(e.isConstant()||e.group===a)return e;var i=new S(e,t).squareFree(),n=i[2];if(1!==n){var s=i[1].toSymbol();return s.power=s.power.multiply(new v(n)),r.add(x.Factor.factor(s)),x.Factor.squareFree(i[0].toSymbol(),r)}return e},powerFactor:function(t,i){if(t.group!==l||t.previousGroup===s)return t;var n=p(t.symbols);if(!e.Utils.allNumeric(n))return t;var a=e.Utils.arrayMin(n),o=new d(0),u=r.parse(t.value+"^"+a);return t.each((function(e){e=r.divide(e,u.clone()),o=r.add(o,e)})),i.add(u),o},coeffFactor:function(r,t){if(r.isComposite()){var i=e.Math2.QGCD.apply(null,r.coeffs());i.equals(1)||r.each((function(e){e.isComposite()?e.each((function(e){e.multiplier=e.multiplier.divide(i)})):e.multiplier=e.multiplier.divide(i)})),r.updateHash(),t&&t.add(new d(i))}return r},trialAndError:function(r,t,i){if(r.isConstant()||r.group===a)return r;for(var n=new S(r,i),s=n.coeffs[0],o=e.Math2.ifactor(s),l=x.proots(r),u=0;u<l.length;u++){var c=l[u],p=1;if(!isNaN(c)){for(var f in o){var m=e.Utils.round(Math.log(f)/Math.log(Math.abs(c)),8);if(h(m)){c=f,p=m;break}}var g=new v(c),d=[new v(g.num).negate()];d[p]=new v(g.den);var b=S.fromArray(d,n.variable).fill(),w=n.divide(b);w[1].equalsNumber(0)&&(n=w[0],t.add(b.toSymbol()))}}return n.equalsNumber(1)||(n=x.Factor.search(n,t)),n.toSymbol()},search:function(r,t,i){i=i||10;var n=r.variable,a=function(e,a,s,o){var l=S.fit(e,a,s,i,o,n);if(l&&l.coeffs.length>1){var u=r.divide(l);if(u[1].equalsNumber(0))return t.add(l.toSymbol()),[u[0],l]}return null},s=r.coeffs[0],o=e.Math2.ifactor(s),l=r.lc(),u=e.Math2.ifactor(l),c=r.sub(i),p=x.Factor.mix(e.Math2.ifactor(c),c<0),f=Math.ceil(r.coeffs.length/2),m=l.lessThan(0),g=s.lessThan(0);for(u[1]=1,o[1]=1;f--;)for(var v in u)for(var h in o)for(var d=0;d<p.length;d++){var b=a(v,h,p[d],f);if(b)return r=b[0],e.Utils.isPrime(r.sub(i))||(r=x.Factor.search(r,t)),r;b||(m&&g?b=a(-v,-h,p[d],f):m?b=a(-v,h,p[d],f):g&&(b=a(v,-h,p[d],f)))}return r},mSqfrFactor:function(r,t){if(r.group!==o)for(var i=f(r).reverse(),n=0;n<i.length;n++)do{if(i[n]!==r.value){var a=e.Calculus.diff(r,i[n]),s=x.Factor.coeffFactor(a);if(s.equals(0))break;var l=!0;if(s.isConstant()&&r.isComposite()&&r.each((function(e){e.multiplier%s!=0&&(l=!1)}),!0),l){var u=x.div(r,s.clone()),c=u[1].equals(0);if(u[0].isConstant()){t.add(u[0]);break}}else c=!1;c&&(t.add(u[0]),r=s)}else t.add(r),r=new d(1)}while(c);return r},sqdiff:function(t,i){try{var n,s,o=function(r){return e.Utils.block("POSITIVE_MULTIPLIERS",(function(){return d.unwrapPARENS(w.sqrt(w.abs(r)))}),!0)},l=e.Utils.separate(t.clone()),u=[];for(var c in l)"constants"!==c&&u.push(l[c]);if(u.sort((function(e,r){return r.power-e.power})),2===u.length)if(n=u.pop(),s=u.pop(),n.isComposite()&&s.power.equals(2)){s=o(s);var p=x.Factor.factor(r.add(n,l.constants));p.power.equals(2)&&(p.toLinear(),i.add(r.subtract(p.clone(),s.clone())),i.add(r.add(p,s)),t=new d(1))}else if(n=n.powSimp(),s=s.powSimp(),(n.group===a||""===n.fname)&&n.power.equals(2)&&(s.group===a||""===s.fname)&&s.power.equals(2)){if(n.multiplier.lessThan(0)){var f=s;s=n,n=f}n.multiplier.greaterThan(0)&&(n=o(n),s=o(s)),i.add(r.subtract(n.clone(),s.clone())),i.add(r.add(n,s)),t=new d(1)}}catch(m){}return t},mfactor:function(t,i){if(t.group===o)if("sqrt"===t.fname){var n=new q,a=x.Factor.common(t.args[0].clone(),n);a=x.Factor.coeffFactor(a,n),t=r.multiply(r.symfunction("sqrt",[a]),r.parse(t.multiplier)),n.each((function(i){t=r.multiply(t,r.parse(e.Utils.format("sqrt({0})",i)))}))}else i.add(t);else{t=x.Factor.mSqfrFactor(t,i);for(var s=f(t),l=t.collectSymbols().map((function(e){return d.unwrapSQRT(e)})),u={},c={},p=s.length,m=l.length,g=0;g<p;g++){var v=s[g];u[v]=new d(0);for(var b=0;b<m;b++){var w=l[b];if(w.contains(v)){var y=w.value===v?w.power.toDecimal():w.symbols[v].power.toDecimal();(!c[v]||y<c[v])&&(c[v]=y),u[v]=r.add(u[v],w.clone())}}}for(var S in u){var U=r.parse(S+"^"+c[S]),M=r.divide(u[S],U),L=r.expand(M);if(L.equals(1))break;var N=x.div(t.clone(),L);if(N[0].equals(0))break;var _=h(L)&&L.lessThan(0);if(N[1].equals(0)&&!_){var C=x.div(t.clone(),N[0].clone());U=C[0];if(t=C[1],U.equals(-1)&&!t.equals(0))return t;var E=N[0];if(t.equals(E)){var A=x.Factor.reduce(E,i);if(!t.equals(A))return x.Factor.mfactor(A,i)}else if(i.add(E),t.equals(0))return U;return U.isConstant("all")?(i.add(U),U):x.Factor.mfactor(U,i)}}}return t=x.Factor.sqdiff(t,i),t=x.Factor.zeroes(t,i)}},allLinear:function(e){for(var r=e.length,t=0;t<r;t++)if(!x.isLinear(e[t]))return!1;return!0},isLinear:function(e){var r=!1,i=e.group;if(i===l||i===u)for(var n in r=!0,e.symbols){var p=e.symbols[n],m=p.group;if(m!==o&&m!==s||(r=!1),m===c)r=1===f(p).length;else if(m===l||m===u)r=x.isLinear(p);else if(p.group!==t&&"1"!==p.power.toString()){r=!1;break}}else i===a&&1===e.power&&(r=!0);return r},gcd:function(){var t;if(0===(t=1===arguments.length&&arguments[0]instanceof e.Vector?arguments[0].elements:e.Utils.arguments2Array(arguments)).length)return new d(1);if(1===t.length)return t[0];for(var i=[],n=!1,a=0;a<t.length;a++)if(t[a].group===o&&"gcd"===t[a].fname)(t=t.concat(arguments[a].args)).splice(a,1);else{var s=f(t[a]);if(e.Utils.haveIntersection(s,i)){n=!0;break}i=i.concat(s)}if(n||0===i.length){if(t.every((function(e){return e.getDenom().equals(1)}))){var l=t[0];for(a=1;a<t.length;a++)l=x.gcd_(t[a],l);return l}return r.divide(x.gcd.apply(null,t.map((function(e){return e.getNum()}))),x.lcm.apply(null,t.map((function(e){return e.getDenom()}))))}return r.symfunction("gcd",t)},gcd_:function(t,i){if(t.group!==o&&t.group!==n||(t=e.Utils.block("PARSE2NUMBER",(function(){return r.parse(t)}))),i.group===o&&(i=e.Utils.block("PARSE2NUMBER",(function(){return r.parse(i)}))),t.isConstant()&&i.isConstant())return new d(e.Math2.QGCD(new v(+t),new v(+i)));var a=r.multiply(t.getDenom()||new d(1),i.getDenom()||new d(1)).invert();if(t=r.multiply(t.clone(),a.clone()),i=r.multiply(i.clone(),a.clone()),t=r.expand(t),i=r.expand(i),t.group===c||i.group===c){var l=r.divide(t.clone(),i.clone());if(!(g=r.multiply(i.clone(),l.getDenom().invert())).equals(1))return g}if(t.group===s||i.group===s){var u=new d(e.Math2.GCD(t.multiplier,i.multiplier)),p=x.gcd_(t.value===b?new d(1):r.parse(t.value),i.value===b?new d(1):r.parse(i.value)),m=x.gcd_(r.parse(t.power),r.parse(i.power));return r.multiply(u,r.pow(p,m))}if(t.length<i.length){var g=t;t=i,i=g}var h=f(t),w=f(i);if(h.length===w.length&&1===h.length&&h[0]===w[0]||1===h.length&&0===w.length||0===h.length&&1===w.length)return t=new S(t),i=new S(i),r.divide(t.gcd(i).toSymbol(),a);var y,q=[];for(t.each((function(e){q.push(e.multiplier)})),i.each((function(e){q.push(e.multiplier)}));!i.equals(0);){g=i.clone();if(t=t.clone(),y=x.div(t,g),i=y[1],y[0].equals(0))return r.divide(new d(e.Math2.QGCD(t.multiplier,i.multiplier)),a);t=g}var U=e.Math2.QGCD.apply(void 0,q);return U.equals(1)||t.each((function(e){e.multiplier=e.multiplier.divide(U)})),!t.equals(1)||t.isConstant()||i.isConstant()?r.divide(t,a):r.divide(r.symfunction("gcd",arguments),a)},lcm:function(){var t;1===arguments.length?arguments[0]instanceof e.Vector?t=arguments[0].elements:r.error("lcm expects either 1 vector or 2 or more arguments"):t=e.Utils.arguments2Array(arguments);var i=t.reduce((function(e,t){return r.multiply(e,t.clone())}),new d(1)),n=function(e,r){var t,i,n,a=[],s=Math.pow(2,e.length);for(i=r;i<s;i++){t=[],n=e.length-1;do{0!=(i&1<<n)&&t.push(e[n])}while(n--);t.length==r&&a.push(t)}return a}(arguments,arguments.length-1).map((function(e){return e.reduce((function(e,t){return r.multiply(e,t.clone())}),new d(1))}));if(t.every((function(r){return e.Utils.isVariableSymbol(r)})))var a=r.symfunction("gcd",e.Utils.arrayUnique(n));else a=x.gcd.apply(null,n);return r.divide(i,a)},divide:function(t,i){var n,a,s,o;return(o=(s=e.Algebra.Factor.factor(t.clone())).getDenom()).isConstant("all")?o=new d(1):t=r.expand(d.unwrapPARENS(r.multiply(s,o.clone()))),n=x.div(t,i),a=r.divide(n[1],i),r.divide(r.add(n[0],a),o)},div:function(t,i){if(i.isConstant())return t.each((function(e){e.multiplier=e.multiplier.divide(i.multiplier)})),[t,new d(0)];if(t=r.expand(t),i=r.expand(i),t.group===a&&i.group===u){var n=t.value,s=e.Utils.decompose_fn(i.clone(),n,!0);if(t.isLinear()&&s.x&&s.x.isLinear()&&i.isLinear()){var o=d.create(t.multiplier);return[r.divide(o.clone(),s.a.clone()),r.divide(r.multiply(o,s.b),s.a).negate()]}}if(t.group===a&&i.group===a){var l=r.divide(t.clone(),i.clone());return l.isConstant()?[l,new d(0)]:[new d(0),t.clone()]}var c=t.hasFunc(),p=i.hasFunc(),m=!1;if(c||p){m=!0;var g={},h=(t=r.parse(e.Utils.subFunctions(t,g)),i=r.parse(e.Utils.subFunctions(i,g)),e.Utils.getFunctionsSubs(g))}var w,y,q,x,M=e.Utils.arrayUnique(f(t).concat(f(i)));if((t.isImaginary()||i.isImaginary())&&M.push(e.Settings.IMAGINARY),1===M.length){w=(Q=new S(t).divide(new S(i)))[0].toSymbol(),y=Q[1].toSymbol()}else{M.push(b);var L=function(e){for(var t=new d(0),i=0;i<e.length;i++){var n=e[i].toSymbol();t=r.add(t,n)}return t},N=function(e,r){var t,i=Math.max.apply(null,e.terms),n=0;if(!r)for(var a=0;a<e.terms.length;a++)if(e.terms[a].equals(i)&&(t=a,n++),n>1)return;if(r)for(a=0;a<e.terms.length;a++)if(e.terms[a].equals(i)){t=a;break}return[i,t,e]},_=e.Utils.toMapObj(M),C=function(e,r){return r.sum.subtract(e.sum)},E=function(e,r){if(!e||!r)return!1;for(var t=0;t<e.terms.length;t++)if(e.terms[t].lessThan(r.terms[t]))return!1;return!0},A=t.tBase(_).sort(C),T=i.tBase(_).sort(C),k=function e(r,t){var i=r[t=t||0],n=r.length;if(i){for(var a,s,o=N(i),l=t+1;l<n;l++){var u=r[l],c=i.sum.equals(u.sum);if(!c&&o)break;if(c){for(var p,f,m,g,v=i.terms.length,h=0;h<v;h++){var d=i.terms[h],b=u.terms[h];(void 0===p||d.greaterThan(p))&&(p=d,m=h),(void 0===f||b.greaterThan(f))&&(f=b,g=h)}var w=p.subtract(u.terms[m]),y=f.subtract(i.terms[g]);if(y>w){o=[f,g,u];break}if(w>y){o=[p,m,i];break}}else if(o=N(u))break;o=N(u)}if(!o)return N(r[0],!0);for(l=0;l<T.length;l++){var S=T[l].terms;if((s=o[1])===S.length-1)return;if(!(a=S[s]).equals(0))break}return a.equals(0)?e(r,++t):o}}(E(A[0],T[0])&&A[0].count>T[0].count?T:A),F=[];if(k){var I=k[1],R=function(e,r){var t=e.len(),i=r.len(),n=r.terms[I],a=e.terms[I];return i>t&&n.greaterThan(a)?i-t:n.subtract(a)};I=function(e,r,t){for(var i=[],n=0;n<e.length;n++)for(var a=e[n],s=0;s<a.terms.length;s++){var o=i[s],l=a.terms[s];0===n?i[s]=l:o&&!o.equals(l)&&(i[s]=void 0)}for(n=0;n<i.length;n++){if((a=i[n])&&!a.equals(0))return n}return t}(A,0,I),A.sort(R),T.sort(R);var P=T[0],O=A[0],D=new U(new v(1),[],O.map);if(P.sum.greaterThan(O.sum)&&O.len()>1)for(var H=0;H<O.terms.length;H++){var V=P.terms[H].subtract(O.terms[H]);if(V.equals(0))D.terms[H]=new v(0);else{var G=V.add(new v(1));D.terms[H]=V;for(var B=0;B<A.length;B++)A[B].terms[H]=A[B].terms[H].add(G)}}for(var z=E(A[0],T[0]);z&&(x=T,!(q=A)[0].sum.equals(x[0].sum)||q.length>=x.length);){var Q=A[0].divide(T[0]);F.push(Q),A.shift();for(H=1;H<T.length;H++){var Z=T[H].multiply(Q).generateImage(),j=A.length;0===j&&(Z.coeff=Z.coeff.neg(),A.push(Z),A.sort(R));for(B=0;B<j;B++){var Y=A[B];if(Y.getImg()===Z.getImg()){Y.coeff=Y.coeff.subtract(Z.coeff),Y.coeff.equals(0)&&(e.Utils.remove(A,B),B--);break}B===j-1&&(Z.coeff=Z.coeff.neg(),A.push(Z),A.sort(R))}}if(!(z=E(A[0],T[0]))&&A.length>=T.length)for(H=1;H<A.length;H++)if(z=E(A[H],T[0])){A.unshift(e.Utils.remove(A,H));break}}}w=L(F),y=L(A),void 0!==D&&(D=D.toSymbol(),w=r.divide(w,D.clone()),y=r.divide(y,D))}return m&&(w=r.parse(w.text(),h),y=r.parse(y.text(),h)),[w,y]},line:function(t,i,n){e.Utils.isArray(t)&&(t=e.Utils.convertToVector(t)),e.Utils.isArray(i)&&(i=e.Utils.convertToVector(i)),n=r.parse(n||"x"),e.Utils.isVector(t)&&e.Utils.isVector(i)||r.error('Line expects a vector! Received "'+t+'" & "'+i+'"');var a=r.subtract(i.e(1).clone(),t.e(1).clone()),s=r.subtract(i.e(2).clone(),t.e(2).clone()),o=r.divide(s,a),l=r.multiply(n,o.clone()),u=r.multiply(t.e(1).clone(),o);return r.add(r.subtract(l,u),t.e(2).clone())},PartFrac:{createTemplate:function(e,t,i,n){var s,l,u,c,p,f,m;(e=x.Factor.factor(e)).each((function(r,t){if(r.group===o&&""===r.fname&&r.args[0].group===a){var i=r.args[0];this.symbols?(delete this.symbols[t],this.symbols[i.value]=i):e=r.args[0]}})),s=t.collectFactors(),l=[],f=[],m=new d(1);for(var g=0;g<s.length;g++){var v=d.unwrapPARENS(s[g]);if(v.power.greaterThan(1)){c=Number(v.power),u=v.clone().toLinear(),p=Number(x.degree(u,n));for(var h=0;h<c;h++){var b=r.pow(u.clone(),new d(h+1));i.push(b.clone());var w=r.divide(e.clone(),b.clone());f.push(p),l.push(w)}}else{p=Number(x.degree(v,n)),i.push(v);w=r.divide(e.clone(),v.clone());w=r.expand(d.unwrapPARENS(w)),f.push(p),l.push(w)}}return[i=i.map((function(e){return r.multiply(e,m.clone())})),l,f]},partfrac:function(t,i,n){var a=f(t);i=i||r.parse(a[0]);try{var s,o,l,u,c,p,m,g,v,h,b,w,y,S,q,U,M,L,N;if(s=r.expand(t.getNum()),o=r.expand(t.getDenom().toUnitMultiplier()),s.multiplier=t.multiplier,c=s.groupTerms(i),Number(x.degree(s,i))>=Number(x.degree(o,i))?(y=(w=x.div(s.clone(),r.expand(o.clone())))[0],c=(s=w[1]).groupTerms(i)):y=new d(0),1===Number(x.degree(o,i))){var _=r.divide(s,o);return n?[y,_]:r.add(y,_)}u=x.Factor.factor(o),U=x.PartFrac.createTemplate(o.clone(),u,[],i),M=U[0],S=U[1],p=U[2],b=[c.length],m=[],l=[],q=[],S.map((function(e,t){L=M[t],N=p[t];for(var n=0;n<N;n++){l.push(L.clone());var a=d.create(i,n),s=r.expand(r.multiply(e,a.clone())).groupTerms(i),o=s.length;b.push(o),m.push(s),q.push(a.clone())}})),g=e.Utils.arrayMax(b),h=new e.Matrix(e.Utils.fillHoles(c,g)).transpose(),v=new e.Matrix;for(var C=0;C<m.length;C++)v.elements.push(e.Utils.fillHoles(m[C],g));var E=r.multiply(v.transpose().invert(),h),A=n?[y]:y;return E.each((function(e,t){var i=r.multiply(q[t],r.divide(e,l[t]));n?A.push(i):A=r.add(A,i)})),A}catch(T){}return t}},degree:function(t,i,n){if(n=n||{nd:[],sd:[],depth:0},!i){var o=f(t);if(o.length>1)throw new Error("You must specify the variable for multivariate polynomials!");if(0===o.length)return new d(0);i=r.parse(o[0])}var l=t.group;t.isComposite()?((t=t.clone()).distributeExponent(),t.each((function(e){n.depth++,x.degree(e,i,n),n.depth--}))):t.group===c?t.each((function(e){n.depth++,x.degree(e,i,n),n.depth++})):l===s&&t.value===i.value?n.sd.push(t.power.clone()):l===a&&t.value===i.value?n.nd.push(r.parse(t.power)):n.nd.push(new d(0));var u=n.nd.length>0?e.Utils.arrayMax(n.nd):void 0;return 0===n.depth&&n.sd.length>0?(void 0!==u&&n.sd.unshift(u),r.symfunction("max",n.sd)):(e.Utils.isSymbol(u)||(u=r.parse(u)),u)},sqComplete:function(t,i,n){e.Utils.isSymbol(i)||(i=r.parse(i));var a,s,o,l,u,c,p,f,m,g,v,h=function(r){throw r=r||"Stopping",new e.exceptions.ValueLimitExceededError(r)};return t.isPoly()||h("Must be a polynomial!"),m=e.Utils.inBrackets,t=t.clone(),(a=e.Algebra.degree(t,i)).equals(2)||h("Cannot complete square for degree "+a),s=(p=e.Algebra.coeffs(t,i))[2],f=p[1].sign(),o=r.divide(p[1],new d(2)),l=r.pow(o.clone(),new d(2)),n?[s,o,u]:(v=w.sqrt(s),c=r.divide(w.sqrt(l),v.clone()),u=r.subtract(p[0],r.pow(c.clone(),new d(2))),{a:g=r.parse(m(v.clone()+"*"+i+(f<0?"-":"+")+c)),c:u,f:r.add(r.pow(g.clone(),new d(2)),u.clone())})},Simplify:{strip:function(e){var t=r.parse(e.multiplier);e.toUnitMultiplier();var i=r.parse(e.power);return e.toLinear(),[t,i,e]},unstrip:function(e,t){var i=e[0],n=e[1];return r.multiply(i,r.pow(t,n))},complexSimp:function(e,t){var i,n,a,s,o,l,u,c,p;return l=e.realpart(),c=e.imagpart(),u=t.realpart(),p=t.imagpart(),i=r.multiply(l.clone(),u.clone()),n=r.multiply(c.clone(),p.clone()),a=r.multiply(u.clone(),c),s=r.multiply(l,p.clone()),o=r.add(r.pow(u,new d(2)),r.pow(p,new d(2))),r.divide(r.add(r.add(i,n),r.multiply(r.subtract(a,s),d.imaginary())),o)},trigSimp:function(t){if(t.containsFunction(["cos","sin","tan"])){t=t.clone();var i=x.Simplify.strip(t),n=(t=i.pop()).clone();if(t.group===u){var a=new d(0);t.each((function(e){var t=x.Simplify.trigSimp(e.fnTransform());a=r.add(a,t)}),!0),n=r.pow(r.multiply(new d(t.multiplier),a),new d(t.power))}else if(t.group===c){var s=t.getNum(),o=t.getDenom();if("sin"===s.fname&&"cos"===o.fname&&s.args[0].equals(o.args[0])&&s.power.equals(o.power)&&(n=r.parse(e.Utils.format("({0})*({1})*tan({2})^({3})",o.multiplier,s.multiplier,s.args[0],s.power))),n.group===c){var l=new d(1);n.each((function(t){"tan"===t.fname&&(t=r.parse(e.Utils.format("({0})*sin({1})^({2})/cos({1})^({2})",t.multiplier,x.Simplify.simplify(t.args[0]),t.power))),l=r.multiply(l,t)})),n=l}}t=n=x.Simplify.unstrip(i,n).distributeMultiplier()}return t},fracSimp:function(e){var t=e.getDenom();if((m=e.getNum()).isImaginary()&&t.isImaginary()&&(e=x.Simplify.complexSimp(m,t)),e.isComposite()){e.power>1&&(e=r.expand(e));var i,n,a,s,o,l,u,c,p,f,m,g=e.collectSymbols();for(n=g.pop();g.length;)a=g.pop(),s=r.parse(n.getDenom()),o=r.parse(a.getDenom()),l=n.getNum(),u=a.getNum(),f=r.multiply(s.clone(),o.clone()),c=r.multiply(l,o),p=r.multiply(u,s),n=r.divide(r.add(c,p),f);return t=r.expand(n.getDenom()),(i=(m=r.expand(n.getNum())).isImaginary()&&t.isImaginary()?x.Simplify.complexSimp(m,t):r.divide(m,t)).equals(e)?e:x.Simplify.simplify(i)}return e},ratSimp:function(e){if(e.group===c){var t=x.Simplify.fracSimp(e.getDenom()),i=x.Simplify.fracSimp(e.getNum());e=r.divide(i,t)}return e},simplify:function(t){var i,n=x.Simplify.strip(t);if(t=n.pop(),(t=x.Simplify.fracSimp(t)).isConstant()||t.group===e.groups.S)return n.push(t),x.Simplify.unstrip(n,t);if(t=t.clone(),i=x.Simplify.trigSimp(t),i=x.Simplify.ratSimp(i),(i=x.Factor.factor(i)).group===e.groups.CP&&i.isLinear()){var a=i.multiplier.clone();i.toUnitMultiplier();var s=new d(0);i.each((function(e){var t=x.Simplify.simplify(e);s=r.add(s,t)})),i=s,s.multiplier=s.multiplier.multiply(a)}return x.Simplify.unstrip(n,y(i))}},Classes:{Polynomial:S,Factors:q,MVTerm:U}};i.useAlgebraDiv=function(){var t=x.divideFn=r.divide,i=0;r.divide=function(r,n){var a;return a=1===++i?e.Algebra.divide(r,n):t(r,n),i=0,a}},i.useParserDiv=function(){x.divideFn&&(r.divide=x.divideFn),delete x.divideFn},i.register([{name:"factor",visible:!0,numargs:1,build:function(){return x.Factor.factor}},{name:"simplify",visible:!0,numargs:1,build:function(){return x.Simplify.simplify}},{name:"gcd",visible:!0,numargs:[1],build:function(){return x.gcd}},{name:"lcm",visible:!0,numargs:[1],build:function(){return x.lcm}},{name:"roots",visible:!0,numargs:-1,build:function(){return x.roots}},{name:"divide",visible:!0,numargs:2,build:function(){return x.divide}},{name:"div",visible:!0,numargs:2,build:function(){return x.div}},{name:"partfrac",visible:!0,numargs:[1,2],build:function(){return x.PartFrac.partfrac}},{name:"deg",visible:!0,numargs:[1,2],build:function(){return x.degree}},{name:"coeffs",visible:!0,numargs:[1,2],build:function(){return function(){var r=x.coeffs.apply(x,arguments);return new e.Vector(r)}}},{name:"line",visible:!0,numargs:[2,3],build:function(){return x.line}},{name:"sqcomp",visible:!0,numargs:[1,2],build:function(){return function(e,r){try{return r=r||f(e)[0],x.sqComplete(e.clone(),r).f}catch(t){return e}}}}]),i.api()}()},vBTj:function(e,r,t){var i=t("Ffb8");t("rsGY"),t("QBbR"),t("YGv4"),t("PKOl"),e.exports=i}}]);
//# sourceMappingURL=nerdamer~app-499f0d101f5ee95501f6.js.map