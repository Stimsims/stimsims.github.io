(window.webpackJsonp=window.webpackJsonp||[]).push([[38],{"3vKF":function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return s})),n.d(t,"d",(function(){return u})),n.d(t,"e",(function(){return l})),n.d(t,"a",(function(){return d}));var r=n("OQUD"),a=n("iqUP");n("iTTW");var o=n("Uhxb"),i=function(e){return function(t){if(Object(r.f)("firestore inline then e",t),t)if(t.exists){var n=t.data();e(n)}else{if(!t.data||!t.data.success)throw t.error?new Error(t.error.message):new Error("No such record found");e(t.data.success)}else e(null)}},c=function(e){if(Object(r.f)("firestore inline catch e",e),e.exists)return e.data();if(e.data&&e.data.success)return e.data.success;throw e.error?new Error(e.error.message):new Error("No such record found")},s=function(e){return"string"==typeof e?e:e.error?e.error.message:"No such record found"},u=function(e){return a.firestore().collection(o.COLLECTION_PLAYERS).doc(e).get().then(c)},l=function(e,t,n){return a.firestore().collection(o.COLLECTION_PLAYERS).doc(e).collection(o.COLLECTION_EXAMS).doc(t).update({save:n})},d=function(e,t){return a.firestore().collection(o.COLLECTION_PLAYERS).doc(e).collection(o.COLLECTION_EXAMS).doc(t).delete().then((function(n){var r;return a.firestore().collection(o.COLLECTION_PLAYERS).doc(e).update(((r={})["exams."+t]=a.firestore.FieldValue.delete(),r))}))}},"4tu4":function(e,t,n){"use strict";n("pJf4"),n("q8oJ"),n("8npG"),n("YbXK"),n("cFtU"),n("rzGZ"),n("m210"),n("4DPX"),n("E5k/");var r=n("q1tI"),a=n.n(r),o=n("vOnD"),i=n("Wcq6"),c=n.n(i),s=(n("6nsN"),n("iTTW"),n("qhky")),u=n("OQUD"),l=n("YwZP"),d=n("Zrqu"),m=n("tkF3"),p=n("Db+8"),f={clientId:"392303660392-if4osc2chaurcd8a5o6btcuud6r3rj91.apps.googleusercontent.com",scope:"https://www.googleapis.com/auth/drive.file",discoveryDocs:["https://www.googleapis.com/discovery/v1/apis/drive/v3/rest","https://www.googleapis.com/discovery/v1/apis/classroom/v1/rest"]},h=Object(p.a)((function(e){return a.a.createElement(m.a,{apiKey:"cli",script:"https://apis.google.com/js/api.js",onLoad:function(t){gapi.load("client",(function(){e.doSubscribe("getGapi",(function(){return gapi.client.init(f)}),(function(t){e.onApiInit("gapi")}),(function(e){Object(u.h)("gapi client init rejected")}),(function(e){Object(u.h)("gapi client onError called")}))}))}})})),b=n("Wbzz"),g=(n("Xjse"),n("kjjs")),E=n("+HCB"),y=n("9h/v");n("ETiJ");function v(e){return function(e){if(Array.isArray(e))return w(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return w(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return w(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function w(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var I=[{provider:c.a.auth.TwitterAuthProvider.PROVIDER_ID},{provider:c.a.auth.FacebookAuthProvider.PROVIDER_ID}],O={signInFlow:"redirect",callbacks:{}},k=(t.a=function(e,t,n){return function(o){if(!o.doSubscribe)throw Error("SignInHoc must be wrapped by subscribable");var i=Object(r.useState)(null),u=i[0],p=i[1],f=Object(r.useState)(!1),w=f[0],A=f[1],_=Object(r.useState)(!1),x=_[0],C=_[1],T=Object(r.useState)(null),L=T[0],D=T[1],N=function(e){C(X(e))};Object(r.useEffect)((function(){return function(){W(L||M())}}),[L]),Object(r.useEffect)((function(){G()&&window.firebaseui&&Y()}),[w,x]),Object(r.useEffect)((function(){window.firebase=c.a,0===c.a.apps.length&&(c.a.initializeApp(y.a),l.globalHistory.location.hostname),window&&window.gapi&&!w&&A(!0),c.a.auth().onAuthStateChanged(N),R()}),[]);var R=function(e){window.firebase=c.a},U=function(){return o.doSubscribe("signInOut",(function(){return c.a.auth().signOut()}),(function(e){return W(M()),Object(b.navigate)(Object(g.getUrl)()),{success:"logged out"}}),(function(e){return{error:"failed to sign out."}}),p)},Y=function e(n,r){void 0===r&&(r=0),console.log("SignIn  showSignInUi",o);var a=M();if(a)Object(b.navigate)(Object(g.getUrl)()+"#signing-in");else try{c.a.auth().setPersistence(c.a.auth.Auth.Persistence.NONE),q(a),O.signInSuccessUrl=t+"#signed-in",window.location=Object(g.getUrl)()+"#signing-in",O.callbacks.signInSuccessWithAuthResult=V,F(n)}catch(i){r<1&&e(n,r+1)}},M=function(){var e;return firebaseui&&(e=firebaseui.auth.AuthUI.getInstance(z())),e||(e=L),e},W=function(e){D(null),e&&e.delete()},q=function(e){D(null),e&&e.reset()},F=function(e){var t=M();if(!t){c.a.auth();t=new firebaseui.auth.AuthUI(c.a.auth(),z())}var r=function(e){return{provider:c.a.auth.GoogleAuthProvider.PROVIDER_ID,scopes:e,customParameters:{include_granted_scopes:!0}}}(e);t.start("#"+z(),Object.assign({},O,{signInOptions:[r].concat(v(n?[]:I))}))},V=function(e){return window&&window.gapi&&window.gapi.client&&e&&e.credential&&gapi.client.setToken({access_token:e.credential.accessToken}),!0},G=function(){return"#signing-in"===Object(g.getUrlHash)()},B=function(){return!!x},X=function(e){return e?{uid:e.uid,email:e.email,displayName:e.displayName,photoURL:e.photoURL,phoneNumber:e.phoneNumber,createTime:e.metadata.creationTime,lastTime:e.metadata.lastSignInTime,provider:e.providerData.reduce((function(e,t,n){return e+(n>0?", ":"")+t.providerId}),"")}:null},z=function(){return"firebaseui-auth-container"};return a.a.createElement(P,null,a.a.createElement(s.a,null,a.a.createElement("link",{type:"text/css",rel:"stylesheet",href:"https://www.gstatic.com/firebasejs/ui/4.3.0/firebase-ui-auth.css"})),a.a.createElement(h,{onApiInit:function(){A(!0)}}),a.a.createElement(m.a,{onLoad:R,script:"https://www.gstatic.com/firebasejs/ui/4.3.0/firebase-ui-auth.js"}),a.a.createElement(S,{signingIn:G()},a.a.createElement(j,{signingIn:G(),className:"bg-grad-pp"},a.a.createElement(E.a,{className:"sign-in-close",icon:"icon-cross",onInput:function(){Object(b.navigate)(Object(g.getUrl)())},color:"primary",bgColor:"black"}),G()&&a.a.createElement("div",null,a.a.createElement(d.a,{key:"auth-message",id:"auth-message",fontSize:"remS",className:"inline"},"By signing in, some of your personal information will be used for authentication."),a.a.createElement("a",{href:"/privacy",trget:"_blank"},"Read more here")),u&&a.a.createElement(d.a,{key:"sign-error",id:"sign-error",className:"text-center"},"error"),a.a.createElement("div",{id:z(),className:"sign-in-wrapper"}))),B()&&a.a.createElement(k,null,a.a.createElement(d.a,{key:"sign-out",id:"sign-out",className:"text-underline",onInput:U},"sign out")),w&&a.a.createElement("div",{className:"actionView "+(B()?"signedIn":"notSignedIn")},a.a.createElement(e,Object.assign({},o,{isSignedIn:B(),user:x,doSignOut:U,deleteUser:function(){var e=c.a.auth().currentUser;if(e)return function(){return e.delete()}},isGapiReady:w,doSignIn:Y}))))}},o.b.div.withConfig({displayName:"SignIn__SignOutWrapper",componentId:"sc-1kqop7t-0"})(["position:fixed;top:0px;right:0px;color:orange;"])),P=o.b.div.withConfig({displayName:"SignIn__SignInWrapper",componentId:"sc-1kqop7t-1"})(["text-align:center !important;"]),S=o.b.div.withConfig({displayName:"SignIn__StateBackground",componentId:"sc-1kqop7t-2"})(["position:absolute;top:0px;bottom:0px;left:0px;right:0px;background-color:rgba(0,0,0,0.8);transform:translateY(",");transition:transform 1s ease-out;z-index:",";"],(function(e){return e.signingIn?"0%":"-100%"}),(function(e){return e.theme.zUi})),j=o.b.div.withConfig({displayName:"SignIn__StateView",componentId:"sc-1kqop7t-3"})(["width:95%;margin:auto;margin-top:100px;z-index:",";position:relative;.sign-in-close{position:absolute;top:-25px;left:0px;}"],(function(e){return e.theme.zTop}))},"6wSL":function(e,t,n){"use strict";n("E5k/");var r=n("q1tI"),a=n.n(r),o=n("MB7R"),i=n("Db+8"),c=(n("Zrqu"),n("CF71")),s=n("+HCB"),u=n("vOnD"),l=u.b.section.withConfig({displayName:"classroomcss__List",componentId:"sc-1h8degm-0"})(["padding-left:0px;margin-left:0px;text-align:left;position:relative;.nextPage{position:absolute;top:0px;right:0px;}ul{margin:0px auto 30px auto;}"]),d=(u.b.div.withConfig({displayName:"classroomcss__ListItem",componentId:"sc-1h8degm-1"})(["border-bottom:2px solid white;position:relative;.item-text{display:inline-block;width:70%;position:relative;top:10px;}"]),n("Xjse")),m=n("gUxS"),p=(n("OQUD"),n("ZMKu")),f=n("Laee");t.a=Object(i.a)((function(e){var t=Object(r.useState)(null),n=t[0],i=t[1],u=Object(r.useState)(null),h=u[0],b=u[1];Object(r.useEffect)((function(){g()}),[]);var g=function(){e.doSubscribe("selectCourseWorkGetCoursework",(function(){return Object(o.c)(e.courseId,e.pageSize||10,h)}),(function(t){if((t.nextPageToken||h&&!t.nextPageToken)&&b(t.nextPageToken),!t.courseWork)throw new Error("no coursework found for course "+e.courseId);var n=t.courseWork.filter((function(e){return e.associatedWithDeveloper}));e.filterByTitle&&(n=n.filter((function(t){return t.title.indexOf(e.filterByTitle)>-1}))),i(n.map((function(e){var t=e.dueTime.hours>0&&e.dueTime.hours<14?0:1;return new Date(e.creationTime),{label:"Title: "+e.title+", Due date: "+new Date(e.dueDate.year,e.dueDate.month-1,t+e.dueDate.day,e.dueTime.hours).toLocaleDateString(),value:e.id}})))}),d.c,e.onError)};return a.a.createElement(p.a,null,n&&a.a.createElement(p.b.div,Object.assign({key:"courswork"},f.a),a.a.createElement(l,null,a.a.createElement("div",{style:{height:"50px"}},h&&a.a.createElement(s.a,{className:"nextPage",icon:"icon-circle-down",fontSize:"remL",rotate:"-90",onInput:g,text:"Next Page"})),a.a.createElement(m.a,{id:"selectcourseWork",options:n,className:"block",placeholder:"Select coursework",onInput:function(t,n){e.onSelect(e.id,{courseId:e.courseId,courseWorkId:n})}}))),!n&&a.a.createElement(p.b.div,Object.assign({key:"loading"},f.a),a.a.createElement(c.a,{key:"loading",delay:0,text:"Retrieving Courses"})))}))},"9h/v":function(e,t,n){"use strict";n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return a})),n.d(t,"d",(function(){return o})),n.d(t,"e",(function(){return i}));t.a={apiKey:"AIzaSyDAHDS9Ia7fjc7MRYyD6zyKdRGZeRSrwrI",authDomain:"auth.stimsims.com",databaseURL:"https://mathstims-7d4bb.firebaseio.com",projectId:"mathstims-7d4bb",storageBucket:"mathstims-7d4bb.appspot.com",clientId:"392303660392-if4osc2chaurcd8a5o6btcuud6r3rj91.apps.googleusercontent.com",discoveryDocs:["https://www.googleapis.com/discovery/v1/apis/drive/v3/rest","https://www.googleapis.com/discovery/v1/apis/classroom/v1/rest"]};var r=["https://www.googleapis.com/auth/classroom.courses.readonly","https://www.googleapis.com/auth/classroom.coursework.me","https://www.googleapis.com/auth/drive.file"],a=["https://www.googleapis.com/auth/drive.file"],o=["https://www.googleapis.com/auth/classroom.coursework.students","https://www.googleapis.com/auth/classroom.courses.readonly","https://www.googleapis.com/auth/classroom.rosters.readonly"],i=["https://www.googleapis.com/auth/drive.metadata.readonly","https://www.googleapis.com/auth/classroom.coursework.students","https://www.googleapis.com/auth/classroom.courses.readonly"]},Ab66:function(e,t,n){"use strict";var r=n("q1tI"),a=n.n(r),o=n("zy1p"),i=(n("6kNP"),n("8npG"),n("o0o1")),c=n.n(i),s=(n("ls82"),n("vOnD")),u=n("Mdna"),l=n("Zrqu"),d=n("OQUD");function m(e,t,n,r,a,o,i){try{var c=e[o](i),s=c.value}catch(u){return void n(u)}c.done?t(s):Promise.resolve(s).then(r,a)}var p={style:{base:{fontSize:"18px",color:"#424770",letterSpacing:"0.025em","::placeholder":{color:"#aab7c4"}},invalid:{color:"#9e2146"}}},f=Object(o.injectStripe)((function(e){var t=function(){var t,n=(t=c.a.mark((function t(n){var r;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.stripe.createToken({type:"card",name:"stimsims"});case 2:r=t.sent,e.handlePayment(r.token);case 4:case"end":return t.stop()}}),t)})),function(){var e=this,n=arguments;return new Promise((function(r,a){var o=t.apply(e,n);function i(e){m(o,r,a,i,c,"next",e)}function c(e){m(o,r,a,i,c,"throw",e)}i(void 0)}))});return function(e){return n.apply(this,arguments)}}();return a.a.createElement(h,{onSubmit:t},e.stripe?a.a.createElement(o.CardElement,p):a.a.createElement("div",{className:"StripeElement loading"}),a.a.createElement(u.a,{disabled:!e.stripe,onInput:t,bgColor:"g3"},"Pay with Card"))})),h=s.b.form.withConfig({displayName:"CardForm__CardStyles",componentId:"sc-1mlb7e2-0"})(["border-top:2px solid grey;border-bottom:2px solid grey;"]),b=(n("rzGZ"),n("Dq+y"),n("Ggvi"),n("Db+8")),g=n("Uhxb"),E=n("Xjse");Object(b.a)(Object(o.injectStripe)((function(e){var t=Object(r.useState)(!0),n=t[0],i=t[1],c=Object(r.useState)(!1),s=c[0],u=c[1],m=Object(r.useState)(!1),p=m[0],f=m[1];Object(r.useEffect)((function(){if(e.stripe&&!s){var t=e.stripe.paymentRequest({country:"AU",currency:g.PAY_CURRENCY,total:{label:"Stripe "+e.type+" payment",amount:e.value}});t.on("token",(function(t){var n=t.complete,r=t.token;!function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n])}(t,["complete","token"]);n("success"),e.handlePayment(r)})),e.doSubscribe("stripeButtonPayment",t.canMakePayment,(function(e){i(!!e)}),(function(e){Object(d.h)("PayementButton canMakePayment error "+e)}),E.c,h),u(t)}}),[e.stripe]);var h=function(e){console.error("stripe button error",e),Object(d.h)(e),f("There was a problem loading the stripe button")};return a.a.createElement("div",null,p&&a.a.createElement(l.a,{color:"error"},p),n&&s&&a.a.createElement(o.PaymentRequestButtonElement,{paymentRequest:s,className:"PaymentRequestButton",style:{paymentRequestButton:{theme:"dark",height:"48px"}}}))})));var y=n("CF71"),v=n("hhzR"),w=n("7sVn"),I=g.STRIPE_API_KEY,O={paddingTop:"20px"};t.a=Object(b.a)((function(e){var t=Object(r.useState)(null),n=t[0],i=t[1],c=Object(r.useState)("nostripe"),s=c[0],u=c[1],m=Object(r.useState)(Object(v.a)())[0],p=Object(r.useState)(null),h=p[0],b=p[1],g=Object(r.useState)({}),k=g[0],P=g[1];Object(r.useEffect)((function(){window.Stripe?(i(window.Stripe(I)),j()):document.querySelector("#stripe-js").addEventListener("load",(function(){i(window.Stripe(I)),j()}))}),[]);var S=function(e){Object(d.h)("stripe error: "+e),b(e)},j=function(){u("wfs"),Object(d.i)(new w.Event("stripe","payment-create")),e.doSubscribe("stripeCreatePaymentIntent",(function(){return Object(E.f)(m,e.paymentType)}),(function(e){if(!e||!e.paymentIntentId)throw Error("There was a problem with that payment");u("coll"),P(e)}),E.c,S)},A=function(e,t){S("Payment failed: "+t)},_=function(t){t&&(u("loading"),e.doSubscribe("stripeHandlePayment",(function(){return n.confirmCardPayment(k.paymentIntentSecret,{payment_method:{card:{token:t.id},billing_details:{name:"Stimsims "+e.paymentType}}})}),(function(t){t.paymentIntent&&"succeeded"===t.paymentIntent.status?(u("success"),Object(d.i)(new w.Event("stripe","payment-success")),e.onAccess(!0,!0)):t.error?A(t.error.decline_code,t.error.message):A()}),E.c,S))};return a.a.createElement("div",{id:"stripe-wrapper",style:O},h&&a.a.createElement(l.a,{tag:"p",className:"text-center"},h),!h&&function(){switch(s){case"cancelled":return a.a.createElement(l.a,{tag:"p",className:"text-center"},"Payment cancelled");case"cancelling":return a.a.createElement(y.a,{delay:0,text:"Cancelling Payment"});case"success":return null;case"wfs":case"loading":return a.a.createElement("div",null,a.a.createElement(y.a,{delay:0,text:"Talking to Stripe Payments"}));case"coll":return a.a.createElement("div",{className:"text-center"},a.a.createElement(o.StripeProvider,{stripe:n},a.a.createElement("div",null,a.a.createElement(o.Elements,null,a.a.createElement(f,{handlePayment:_,stripe:window.stripe,type:e.paymentType,value:e.paymentValue})))));case"nostripe":default:return a.a.createElement(y.a,{delay:0,text:"Waiting for Stripe Payments"})}}())}))},ETiJ:function(e,t,n){},JXLw:function(e,t,n){"use strict";var r=n("q1tI"),a=n.n(r),o=(n("qhky"),n("Db+8")),i=n("Zrqu"),c=n("Xjse"),s=n("OQUD"),u=n("Uhxb"),l=n("tkF3"),d=(n("Hhtr"),n("CF71")),m={borderBox:"border-box",padding:"20px 0px",maxHeight:"400px",overflow:"auto"};t.a=Object(o.a)((function(e){console.log("Paypal props",e);var t=Object(r.useState)(null),n=t[0],o=t[1],p=Object(r.useState)(!1),f=p[0],h=p[1];Object(r.useEffect)((function(){window.paypal&&y()}),[]);var b,g=function(e){console.log("paypal onError",e),Object(s.h)("paypal error: "+e),o("There was a problem processing that payment.")},E=function(){if(e.paymentValue===u.PAY_EXAM_VALUE_PAYPAL)return[{name:"exam",quantity:"1",unit_amount:{currency_code:u.PAY_CURRENCY,value:u.PAY_EXAM_VALUE_PAYPAL},sku:"e2",category:"DIGITAL_GOODS"}];if(e.paymentValue===u.PAY_REPORT_VALUE_PAYPAL)return[{name:"report",quantity:"1",unit_amount:{currency_code:u.PAY_CURRENCY,value:u.PAY_REPORT_VALUE_PAYPAL},sku:"r1",category:"DIGITAL_GOODS"}];throw Error("Paypal invalid item error")},y=function(){paypal.Buttons({createOrder:function(t,n){console.log("paypal createOrder data",t),h(!0);var r={payer:{payment_method:"paypal"},application_context:{shipping_preference:"NO_SHIPPING"},purchase_units:[{custom_id:e.user.uid,description:"report description",soft_descriptor:"report soft_descriptor",amount:{value:e.paymentValue,currency_code:u.PAY_CURRENCY,breakdown:{item_total:{value:e.paymentValue,currency_code:u.PAY_CURRENCY}}},items:E()}]};return console.log("paypal createOrder pp",r),n.order.create(r)},onApprove:function(t,n){return console.log("paypal onApprove data",t),Object(c.a)(t.orderID).then((function(t){if(console.log("paypal onApprove then",t),h(!1),t.error)throw Error("Unable to complete payment");e.onAccess(!0,!0)})).catch((function(e){h(!1),g(e)}))},onError:function(e){g(e)}}).render("#paypal-button")};return a.a.createElement("div",{style:m},a.a.createElement(l.a,{script:"https://www.paypal.com/sdk/js?client-id="+(b=u.PAYPAL_LIVE_API_KEY,"sandbox"===u.PAYPAL_MODE&&(b=u.PAYPAL_SANDBOX_API_KEY),console.log("paypal mode "+u.PAYPAL_MODE+" client id "+b),b+"&currency=AUD"),onLoad:y}),n&&a.a.createElement(i.a,{color:"error"},n),a.a.createElement("div",{id:"paypal-button"}),f&&a.a.createElement(d.a,{delay:0,text:"Talking to Paypal payments"}))}))},MB7R:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"g",(function(){return o})),n.d(t,"h",(function(){return i})),n.d(t,"j",(function(){return c})),n.d(t,"i",(function(){return s})),n.d(t,"a",(function(){return u})),n.d(t,"d",(function(){return l})),n.d(t,"c",(function(){return d})),n.d(t,"e",(function(){return m})),n.d(t,"f",(function(){return p}));n("E5k/"),n("6kNP"),n("rzGZ"),n("Dq+y"),n("8npG"),n("YbXK"),n("OQUD");var r=function(e){if(e&&e.result)return e.result;if(Array.isArray(e))return e.map((function(e){return e.result}));throw new Error("malformed classroomThen result")};var a=function(e,t,n){void 0===n&&(n={});var a={reportId:null,reportLink:null};return function(e,t,n,a,o){void 0===a&&(a=""),void 0===o&&(o={});var i="id, name"+(a?", "+a:""),c=Object.assign({},o),s={name:n,mimeType:t};return gapi.client.drive.files.create({media:s,fields:i,name:n,mimeType:e,contentType:t,appProperties:c}).then(r)}("application/vnd.google-apps.document","text/html",e,"webViewLink, webContentLink",n).then((function(e){return a.reportId=e.id,a.reportLink=e.webViewLink,gapi.client.request({path:"/upload/drive/v3/files/"+e.id,method:"PATCH",params:{uploadType:"media",appProperties:n,published:!0},appProperties:n,published:!0,body:t})})).then((function(e){return a}))},o=function(e,t){var n=null,r=0;return gapi.client.classroom.courses.courseWork.studentSubmissions.list({courseId:e,courseWorkId:t}).then((function(e){r=e.result.studentSubmissions.length;var t=e.result.studentSubmissions.filter((function(e){return"TURNED_IN"===e.state}));n=t.map((function(e){return{courseId:e.courseId,courseWorkId:e.courseWorkId,userId:e.userId,id:e.id,link:e.alternateLink}}));var a=null;if(t&&t.length>0)return Promise.all(t.map((function(e,t){return a=e.assignmentSubmission.attachments[e.assignmentSubmission.attachments.length-1],n[t].fileId=a.driveFile.id,gapi.client.drive.files.get({fileId:a.driveFile.id,fields:"appProperties, webViewLink"})})));throw new Error("no assignments have been turned in")})).then((function(e){if(e){return e.map((function(e,t){n[t].gameGrade=e.result.appProperties.gameGrade})),{results:n,totalAssignments:r}}}))},i=function(e,t,n){var a=null,o=e.map((function(e,r){return a=t.hasOwnProperty(e.id)?t[e.id]:e.gameGrade,{courseId:e.courseId,courseWorkId:e.courseWorkId,id:e.id,updateMask:n?"draftGrade,assignedGrade":"draftGrade",draftGrade:a,assignedGrade:a}}));return Promise.all(o.map((function(e,t){return gapi.client.classroom.courses.courseWork.studentSubmissions.patch(e)}))).then((function(t){return n?Promise.all(e.map((function(e,t){return gapi.client.classroom.courses.courseWork.studentSubmissions.return({courseId:e.courseId,courseWorkId:e.courseWorkId,id:e.id})}))):t})).then(r)},c=function(e,t,n,r,o,i){if(!o)throw new Error("turnin submission must have a document to submit");var c={};return a(r,o,{gameGrade:i,courseId:e,courseWorkId:t,submissionId:n}).then((function(r){return c.id=r.reportId,gapi.client.classroom.courses.courseWork.studentSubmissions.modifyAttachments({courseId:e,courseWorkId:t,id:n,addAttachments:[{driveFile:c}]})})).then((function(r){return gapi.client.classroom.courses.courseWork.studentSubmissions.turnIn({courseId:e,courseWorkId:t,id:n})}))},s=function(e,t,n,r,a,o){if(!a)throw new Error("recalaim submission must have a document to submit");return gapi.client.classroom.courses.courseWork.studentSubmissions.reclaim({courseId:e,courseWorkId:t,id:n}).then((function(i){return c(e,t,n,r,a,o)}))},u=function(e){return gapi.client.classroom.courses.courseWork.create(Object.assign({},e)).then(r)},l=function(){return gapi.client.classroom.courses.list().then(r)},d=function(e,t,n){return gapi.client.classroom.courses.courseWork.list({courseId:e,pageSize:t||10,pageToken:n}).then(r)},m=function(e,t){return gapi.client.classroom.courses.courseWork.studentSubmissions.list({courseId:e,courseWorkId:t}).then(r)},p=function(e){return gapi.client.classroom.courses.students.list({courseId:e}).then(r)}},QMGA:function(e,t,n){"use strict";n("E5k/"),n("y7hu");var r=n("q1tI"),a=n.n(r),o=n("vOnD"),i=n("Mdna"),c=n("Zrqu"),s=n("pzn1"),u=n("6wSL"),l=(n("6kNP"),n("8npG"),n("o0o1")),d=n.n(l),m=(n("ls82"),n("MB7R")),p=n("Db+8"),f=n("CF71"),h=n("Xjse"),b=(n("OQUD"),n("ZMKu")),g=n("Laee");function E(e,t,n,r,a,o,i){try{var c=e[o](i),s=c.value}catch(u){return void n(u)}c.done?t(s):Promise.resolve(s).then(r,a)}var y=Object(p.a)((function(e){var t=Object(r.useState)(null),n=t[0],o=t[1];Object(r.useEffect)((function(){s()}),[]);var s=function(){var t,n=(t=d.a.mark((function t(n){return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.doSubscribe("selectSubmissionGetSubmissionsForCoursework",(function(){return Object(m.e)(e.courseId,e.courseWorkId)}),(function(t){if(!(t.studentSubmissions&&t.studentSubmissions.length>0))throw new Error("no coursework found for course "+e.courseId);o(t.studentSubmissions.filter((function(e){return e.associatedWithDeveloper})))}),h.c,e.onError);case 1:case"end":return t.stop()}}),t)})),function(){var e=this,n=arguments;return new Promise((function(r,a){var o=t.apply(e,n);function i(e){E(o,r,a,i,c,"next",e)}function c(e){E(o,r,a,i,c,"throw",e)}i(void 0)}))});return function(e){return n.apply(this,arguments)}}(),u=function(t){var r=n[t];e.onSelect(e.id,{submissionId:r.id,link:r.alternateLink})},l=function(t){var r=n[t];e.onSelect(e.id,{submissionId:r.id,link:r.alternateLink,reclaim:!0})};return a.a.createElement(b.a,null,n&&a.a.createElement(b.b.div,Object.assign({key:"submissions"},g.a),n.map((function(e,t){return a.a.createElement("div",{key:e.id,className:"text-center"},function(e,t){return"CREATED"===e.state||"NEW"===e.state?a.a.createElement(a.a.Fragment,null,a.a.createElement(c.a,{className:"block text-center"},"You can turn in this games performance report to complete this assignment."),a.a.createElement("div",null,a.a.createElement(i.a,{id:t,onInput:u,compact:!0},"Turn in"))):"RECLAIMED_BY_STUDENT"===e.state?a.a.createElement(a.a.Fragment,null,a.a.createElement(c.a,{className:"block text-center"},"You have reclaimed this assignment, you can turn in this games performance report to complete this assignment"),a.a.createElement("div",null,a.a.createElement(i.a,{id:t,onInput:u,compact:!0},"Turn in"))):"TURNED_IN"===e.state?a.a.createElement(a.a.Fragment,null,a.a.createElement(c.a,{className:"block text-center"},"You have turned in this assignment, you can reclaim and turn in this games performance report in it's place"),a.a.createElement("div",null,a.a.createElement(i.a,{id:t,onInput:l,compact:!0},"Reclaim and turn in"))):"RETURNED"===e.state?a.a.createElement(a.a.Fragment,null,a.a.createElement(c.a,{className:"block text-center"},"Your teacher has returned this assignment to you, you can turn in this games performance report in it's place"),a.a.createElement("div",null,a.a.createElement(i.a,{id:t,onInput:u,compact:!0},"Turn in"))):void 0}(e,t))}))),!n&&a.a.createElement(b.b.div,Object.assign({key:"loading"},g.a),a.a.createElement(f.a,{delay:0,text:"Retrieving coursework submissions"})))})),v=n("9h/v"),w=n("vsyE"),I=n("YwZP"),O=n("kjjs");t.a=Object(o.c)(Object(p.a)((function(e){var t=Object(r.useState)(null),n=t[0],o=t[1],i=Object(r.useState)("course"),l=i[0],d=i[1],p=Object(r.useState)(null),E=p[0],k=p[1],P=Object(r.useState)(null),S=P[0],j=P[1],A=Object(r.useState)(null),_=A[0],x=A[1],C=function(e,t){"def"===l?d("course"):"course"===l?(k(t.courseId),d("coursework")):"coursework"===l?(j(t.courseWorkId),d("submissions")):"submissions"===l&&(x(t),d("processing"),T(E,S,t.submissionId,t.reclaim))},T=function(t,n,r,a){var i=a?m.i:m.j;d("processing");var c=Object(w.a)(e.game,e.data,e.theme,e.meta.title+" Report",!1,!1,I.globalHistory.location.href);e.doSubscribe("submitCourseWorkSubmitAssignment",(function(a){return i(t,n,r,e.meta.title,c,Object(O.roundTo)(100*e.data.finalMark,2))}),(function(e){d("success")}),(function(e){return 400===e.status?a?"Failed a precondition: You might be trying to reclaim a submission that is either not turned in, or has been returned.":"Failed a precondition: You might be trying to turn in an assignment that has already been turned in.":e.error&&"The caller does not have permission"===e.error.message?"Failed a precondition: You are not allowed to edit that item. If you're logged in as a teacher, \n                    please use the teacher section on the game menu to edit student reports.":Object(h.c)(e)}),o)};return a.a.createElement(b.a,null,n&&a.a.createElement(b.b.div,Object.assign({key:"error"},g.a),a.a.createElement(c.a,{color:"secondary"},"Error: ",n)),!n&&a.a.createElement(b.b.div,Object.assign({key:l},g.a),function(){switch(l){case"success":return a.a.createElement("div",null,a.a.createElement("div",null,a.a.createElement(c.a,{color:"primary",className:"block text-center"},"success")),a.a.createElement("div",null,a.a.createElement(c.a,{className:"block text-center"},a.a.createElement("a",{href:_.link,target:"_blank"},"link to submission"))));case"processing":return a.a.createElement(f.a,{text:"Submitting your course work"});case"submissions":return a.a.createElement(y,{key:"submissions",id:"submissions",courseId:E,courseWorkId:S,error:n,subscribe:e.subscribe,onSelect:C,permissions:v.c,onError:o});case"coursework":return a.a.createElement(u.a,{key:"coursework",id:"coursework",courseId:E,onSelect:C,error:n,filterByTitle:e.meta.title,pageSize:100,subscribe:e.subscribe,permissions:v.c,onError:o});case"course":default:return a.a.createElement(s.a,{key:"course",id:"course",onSelect:C,permissions:v.c,subscribe:e.subscribe,onError:o,error:n})}}()))})))},Uhxb:function(e,t){t.COLLECTION_PLAYERS="players",t.COLLECTION_EXAMS="exams",t.COLLECTION_PAYMENTS="payments",t.PAY_EXAM_VALUE="5.00",t.PAY_EXAM_VALUE_STRIPE=500,t.PAY_REPORT_VALUE="10.00",t.PAY_REPORT_VALUE_STRIPE=1e3,t.PAY_CURRENCY="AUD",t.PRODUCT_EXAM="exam",t.PRODUCT_REPORT="report",t.PAYPAL_ID="paypalId",t.STRIPE_ID="stripeId",t.FREE_EXAM=3,t.FREE_REPORT=3,t.INITIAL_PLAYER_STATE={reportcount:0,examcount:0},t.getUnlockedKey=function(e){return"unlocked"+e},t.getCounterKey=function(e){return e+"count"},t.getFreeAmount=function(e){return 3},t.getRefundAmount=function(e){return 5},t.getPaymentAmount=function(e,t){if("stripe"===e){if("exam"===t)return 500;if("report"===t)return 1e3}else if("paypal"===e){if("exam"===t)return"5.00";if("report"===t)return"10.00"}throw Error("invalid vendor "+e+" or product "+t)},t.validateProduct=function(e){return"report"===e||"exam"===e},t.STRIPE_API_KEY="pk_live_NNcJevNYmVuwnZSVEPjCWdYv00Dri8SnWf",t.PAYPAL_LIVE_API_KEY="ASk_D1qAbh_gjj7sOvXUUc1XadpS0sgykHgppBCe3mjYxA7PlayZxJhXJ0rjvxBK3k2fi_E1MpLd8Jjj",t.PAYPAL_SANDBOX_API_KEY="Aera3gBeOoXF6uFm2HwLeOeV90vnwc1VufL9bj1cTXyq05ArwaLUhPGg9VM8shjnw1w5yo7tQXLBdUMc",t.PAYPAL_MODE="live",t.PAY_REPORT_VALUE_PAYPAL="10.00",t.PAY_EXAM_VALUE_PAYPAL="5.00",t.VENDOR_PAYPAL="paypal",t.VENDOR_STRIPE="stripe"},UpPj:function(e,t,n){"use strict";n.r(t),n.d(t,"pageQuery",(function(){return h}));var r=n("q1tI"),a=n.n(r),o=n("vOnD"),i=n("qhky"),c=n("/gC5"),s=n("Wbzz"),u=(n("OQUD"),n("mSAW")),l=n("aetF"),d=(n("FAZD"),n("7sVn"),n("Zrqu")),m=n("6sDy"),p=n("kjjs"),f=function(e){var t=Object(r.useState)(null),n=t[0],o=t[1];Object(r.useEffect)((function(){e.addMenuItem({title:e.meta.title,onBack:f,menuItems:null}),Object(m.registerQuestions)(m.SCORE_TYPE_GAME,"meta",e.meta.document,e.meta.title+" Questions","");try{var t=Object(u.d)(Object(l.b)(e.meta.import),Object(u.c)(e.meta.import));o(t||!1)}catch(n){o(!1)}}),[]);var f=function(){Object(s.navigate)(Object(p.getParentUrl)(Object(p.getUrl)(),1))};return a.a.createElement(c.a,{key:"report-"+e.meta.import,id:"report-"+e.meta.import},a.a.createElement(i.a,null,a.a.createElement("link",{rel:"stylesheet",href:"https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/katex.min.css",async:!0,defer:!0})),!1===n?a.a.createElement(a.a.Fragment,null,a.a.createElement(d.a,{tag:"h4",className:"text-center block"},"No data was found for the game ",e.meta.title),a.a.createElement(d.a,{className:"text-center block"},"Please complete the game to see your ",e.meta.title," performance report")):n?a.a.createElement(l.a,{meta:e.meta,data:n,real:e.meta.documentreal,mcq:e.meta.documentmcq}):a.a.createElement("p",{style:{color:"orange"}},"Retrieving data"))};t.default=function(e){return a.a.createElement(f,{meta:e.data.game,site:e.data.site.siteMetadata,addMenuItem:e.addMenuItem})};o.b.div.withConfig({displayName:"report__NoData",componentId:"uh91w3-0"})(["text-align:center;"]);var h="758608736"},WvvM:function(e,t){e.exports={DELETED:"DELETED",aMath:"math",aErr:"error",acMath:"math",acGameMCQ:"gamemcq",acFeature:"feature",acGame:"game",acSim:"sim",acModal:"modal",acMenu:"menu",acDia:"dialogue",acSimCom:"gamecomplete",acSimFinalScore:"finalScore",acLoc:"location",aclocData:"data",aclocStory:"story",actModBuild:"modelBuild",actModAccept:"modelAccept",actModFinal:"modelFinal",actPredBuild:"predBuild",actPredAccept:"predAccept",actPredFinal:"predFinal",aclocChar:"character",acAct:"act",acChoice:"choice",c:"c",act:"act",lab:"lab",ev:"ev",aMathTool:"mathtool",aMove:"move",mMeas:"measure",prim:"primary",secon:"secondary",cdSound:"dimension1",cdDiff:"dimension2",cdDiffSes:"dimension3",setDiff:"difficulty",setSound:"sound",setAni:"animation",setExam:"exam",setFont:"fontsize",scoreRange:.5,dp:2,modelValue:"modelValue",userValue:"userValue"}},Xjse:function(e,t,n){"use strict";n.d(t,"d",(function(){return o})),n.d(t,"c",(function(){return c})),n.d(t,"i",(function(){return s})),n.d(t,"e",(function(){return u})),n.d(t,"g",(function(){return l})),n.d(t,"k",(function(){return d})),n.d(t,"h",(function(){return m})),n.d(t,"f",(function(){return p})),n.d(t,"b",(function(){return f})),n.d(t,"j",(function(){return h})),n.d(t,"l",(function(){return b})),n.d(t,"a",(function(){return g}));var r=n("OQUD"),a=n("iqUP");n("iTTW");var o=function(e){return function(t){if(!t.data||t.data.hasOwnProperty("fail"))throw t.data.hasOwnProperty("fail")?"string"==typeof t.data.fail?new Error(t.data.fail):new Error("cloud function failed"):new Error("No such record found");e(t.data)}},i=function(e){if(e.data&&!e.data.hasOwnProperty("fail"))return e.data;throw e.data.hasOwnProperty("fail")?"string"==typeof e.data.fail?new Error(e.data.fail):new Error("cloud function failed"):new Error("No such record found")},c=function(e){return e.result&&e.result.error?(Object(r.h)("cloudCatch "+e.result.error.message,!1),e.result.error.message):e.error?(Object(r.h)("cloudCatch "+e.error,!1),e.error):e.message?(Object(r.h)("cloudCatch "+e.message,!1),e.message):"string"==typeof e?(Object(r.h)("cloudCatch "+e,!1),e):(Object(r.h)("cloudCatch Incorrectly formatted cloudCatch error",!1),"Incorrectly formatted cloudCatch error")},s=function(e){return a.functions().httpsCallable("loadExam")({examId:e}).then(i)},u=function(e,t){return a.functions().httpsCallable("createExam")({game:e,settings:t}).then(i)},l=function(e){return a.functions().httpsCallable("deletePlayer")({uid:e})},d=function(e,t,n,r){return a.functions().httpsCallable("updateExam")({examId:e,game:t,node:n,local:r}).then(i)},m=function(e,t,n){return a.functions().httpsCallable("endGame")({examId:e,game:t,local:n}).then(i)},p=function(e,t){return a.functions().httpsCallable("createPaymentIntent")({eventId:e,paymentType:t}).then(i)},f=function(e,t){return a.functions().httpsCallable("checkCustomerStatus")({eventId:e,paymentType:t}).then(i)},h=function(e){return a.functions().httpsCallable("refundPayment")({paymentType:e}).then(i)},b=function(e,t){return a.functions().httpsCallable("validateCaptcha")({token:e,v2:t}).then(i)},g=function(e,t){return a.functions().httpsCallable("capturePaypalPayment")({orderID:e,authorizationID:t}).then(i)}},pzn1:function(e,t,n){"use strict";n("6kNP"),n("8npG"),n("E5k/");var r=n("o0o1"),a=n.n(r),o=(n("pJf4"),n("ls82"),n("q1tI")),i=n.n(o),c=n("MB7R"),s=n("gUxS"),u=n("CF71"),l=n("Db+8"),d=n("Xjse"),m=(n("OQUD"),n("ZMKu")),p=n("Laee");function f(e,t,n,r,a,o,i){try{var c=e[o](i),s=c.value}catch(u){return void n(u)}c.done?t(s):Promise.resolve(s).then(r,a)}t.a=Object(l.a)((function(e){var t=Object(o.useState)(null),n=t[0],r=t[1];Object(o.useEffect)((function(){l()}),[]);var l=function(){var t,n=(t=a.a.mark((function t(){return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.doSubscribe("selectCourseWork",c.d,(function(t){if(t.courses&&t.courses.map){var n=t.courses.map((function(e){return{label:e.name,value:e.id}}));r(n)}else e.onError("No courses found for user")}),d.c,e.onError);case 1:case"end":return t.stop()}}),t)})),function(){var e=this,n=arguments;return new Promise((function(r,a){var o=t.apply(e,n);function i(e){f(o,r,a,i,c,"next",e)}function c(e){f(o,r,a,i,c,"throw",e)}i(void 0)}))});return function(){return n.apply(this,arguments)}}();return i.a.createElement(m.a,null,n&&i.a.createElement(m.b.div,Object.assign({key:"selectCourse"},p.a),i.a.createElement(s.a,{id:"selectCourse",options:n,className:"block",placeholder:"Select a Course",onInput:function(t,n){e.onSelect(e.id,{courseId:n})}})),!n&&i.a.createElement(m.b.div,Object.assign({key:"loading"},p.a),i.a.createElement(u.a,{delay:0,text:"Retrieving Courses"})))}))},tkF3:function(e,t,n){"use strict";var r=n("q1tI"),a=n("17x9"),o=n.n(a),i=(n("OQUD"),function(e){Object(r.useEffect)((function(){t()}),[]);var t=function(){var t=document.createElement("script");t.type="text/javascript",t.src=e.script,t.onload=function(t){e.onLoad&&e.onLoad(t)},document.body.appendChild(t)};return null});i.propTypes={onLoad:o.a.func,script:o.a.string},t.a=i}}]);
//# sourceMappingURL=component---src-templates-report-js-76ae7bd5415d6f08feba.js.map